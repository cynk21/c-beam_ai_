{"version":3,"file":"_layout.svelte.js","sources":["../../../../../../src/lib/apis/folders/index.ts","../../../../../../src/lib/components/layout/ChatsModal.svelte","../../../../../../src/lib/components/layout/ArchivedChatsModal.svelte","../../../../../../src/lib/components/icons/Bookmark.svelte","../../../../../../src/lib/components/icons/BookmarkSlash.svelte","../../../../../../src/lib/components/layout/Sidebar/ChatMenu.svelte","../../../../../../src/lib/components/layout/Sidebar/ChatItem.svelte","../../../../../../src/lib/components/common/Folder.svelte","../../../../../../src/lib/components/layout/Sidebar/Folders/FolderMenu.svelte","../../../../../../src/lib/components/layout/Sidebar/RecursiveFolder.svelte","../../../../../../src/lib/components/layout/Sidebar/Folders.svelte","../../../../../../src/lib/components/layout/Sidebar/ChannelModal.svelte","../../../../../../src/lib/components/layout/Sidebar/ChannelItem.svelte","../../../../../../src/lib/components/layout/Sidebar/SearchInput.svelte","../../../../../../src/lib/components/layout/SearchModal.svelte","../../../../../../src/lib/components/layout/Sidebar.svelte","../../../../../../src/lib/components/chat/Settings/General.svelte","../../../../../../src/lib/components/icons/User.svelte","../../../../../../src/lib/components/chat/SettingsModal.svelte","../../../../../../node_modules/svelte-confetti/dist/Confetti.svelte","../../../../../../src/lib/components/ChangelogModal.svelte","../../../../../../src/lib/components/layout/Overlay/AccountPending.svelte","../../../../../../src/routes/(app)/+layout.svelte"],"sourcesContent":["import { WEBUI_API_BASE_URL } from '$lib/constants';\n\nexport const createNewFolder = async (token: string, name: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/folders/`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tname: name\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getFolders = async (token: string = '') => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/folders/`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getFolderById = async (token: string, id: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/folders/${id}`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const updateFolderNameById = async (token: string, id: string, name: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/folders/${id}/update`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tname: name\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const updateFolderIsExpandedById = async (\n\ttoken: string,\n\tid: string,\n\tisExpanded: boolean\n) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/folders/${id}/update/expanded`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tis_expanded: isExpanded\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const updateFolderParentIdById = async (token: string, id: string, parentId?: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/folders/${id}/update/parent`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tparent_id: parentId\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\ntype FolderItems = {\n\tchat_ids: string[];\n\tfile_ids: string[];\n};\n\nexport const updateFolderItemsById = async (token: string, id: string, items: FolderItems) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/folders/${id}/update/items`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\titems: items\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const deleteFolderById = async (token: string, id: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/folders/${id}`, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { getContext } from 'svelte';\n\n\timport dayjs from 'dayjs';\n\timport localizedFormat from 'dayjs/plugin/localizedFormat';\n\n\tdayjs.extend(localizedFormat);\n\n\timport { deleteChatById } from '$lib/apis/chats';\n\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport ConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\n\timport Spinner from '../common/Spinner.svelte';\n\timport Loader from '../common/Loader.svelte';\n\timport XMark from '../icons/XMark.svelte';\n\timport ChevronUp from '../icons/ChevronUp.svelte';\n\timport ChevronDown from '../icons/ChevronDown.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n\n\texport let title = 'Chats';\n\texport let emptyPlaceholder = '';\n\texport let shareUrl = false;\n\n\texport let query = '';\n\n\texport let orderBy = 'updated_at';\n\texport let direction = 'desc'; // 'asc' or 'desc'\n\n\texport let chatList = null;\n\texport let allChatsLoaded = false;\n\texport let chatListLoading = false;\n\n\tlet selectedChatId = null;\n\tlet selectedIdx = 0;\n\tlet showDeleteConfirmDialog = false;\n\n\texport let onUpdate = () => {};\n\n\texport let loadHandler: null | Function = null;\n\texport let unarchiveHandler: null | Function = null;\n\n\tconst setSortKey = (key) => {\n\t\tif (orderBy === key) {\n\t\t\tdirection = direction === 'asc' ? 'desc' : 'asc';\n\t\t} else {\n\t\t\torderBy = key;\n\t\t\tdirection = 'asc';\n\t\t}\n\t};\n\n\tconst deleteHandler = async (chatId) => {\n\t\tconst res = await deleteChatById(localStorage.token, chatId).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t});\n\n\t\tonUpdate();\n\t};\n</script>\n\n<ConfirmDialog\n\tbind:show={showDeleteConfirmDialog}\n\ton:confirm={() => {\n\t\tif (selectedChatId) {\n\t\t\tdeleteHandler(selectedChatId);\n\t\t\tselectedChatId = null;\n\t\t}\n\t}}\n/>\n\n<Modal size=\"lg\" bind:show>\n\t<div>\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5 pt-4 pb-1\">\n\t\t\t<div class=\" text-lg font-medium self-center\">{title}</div>\n\t\t\t<button\n\t\t\t\tclass=\"self-center\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col w-full px-5 pb-4 dark:text-gray-200\">\n\t\t\t<div class=\" flex w-full space-x-2 mb-0.5\">\n\t\t\t\t<div class=\"flex flex-1\">\n\t\t\t\t\t<div class=\" self-center ml-1 mr-3\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\td=\"M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z\"\n\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclass=\" w-full text-sm pr-4 py-1 rounded-r-xl outline-hidden bg-transparent\"\n\t\t\t\t\t\tbind:value={query}\n\t\t\t\t\t\tplaceholder={$i18n.t('Search Chats')}\n\t\t\t\t\t/>\n\n\t\t\t\t\t{#if query}\n\t\t\t\t\t\t<div class=\"self-center pl-1.5 pr-1 translate-y-[0.5px] rounded-l-xl bg-transparent\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"p-0.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tquery = '';\n\t\t\t\t\t\t\t\t\tselectedIdx = 0;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<XMark className=\"size-3\" strokeWidth=\"2\" />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t{#if chatList}\n\t\t\t\t\t<div class=\"w-full\">\n\t\t\t\t\t\t{#if chatList.length > 0}\n\t\t\t\t\t\t\t<div class=\"flex text-xs font-medium mb-1.5\">\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"px-1.5 py-1 cursor-pointer select-none basis-3/5\"\n\t\t\t\t\t\t\t\t\ton:click={() => setSortKey('title')}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\"flex gap-1.5 items-center\">\n\t\t\t\t\t\t\t\t\t\t{$i18n.t('Title')}\n\n\t\t\t\t\t\t\t\t\t\t{#if orderBy === 'title'}\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"font-normal\"\n\t\t\t\t\t\t\t\t\t\t\t\t>{#if direction === 'asc'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronUp className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronDown className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"invisible\">\n\t\t\t\t\t\t\t\t\t\t\t\t<ChevronUp className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"px-1.5 py-1 cursor-pointer select-none hidden sm:flex sm:basis-2/5 justify-end\"\n\t\t\t\t\t\t\t\t\ton:click={() => setSortKey('updated_at')}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\"flex gap-1.5 items-center\">\n\t\t\t\t\t\t\t\t\t\t{$i18n.t('Updated at')}\n\n\t\t\t\t\t\t\t\t\t\t{#if orderBy === 'updated_at'}\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"font-normal\"\n\t\t\t\t\t\t\t\t\t\t\t\t>{#if direction === 'asc'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronUp className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronDown className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"invisible\">\n\t\t\t\t\t\t\t\t\t\t\t\t<ChevronUp className=\"size-2\" />\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t<div class=\"text-left text-sm w-full mb-3 max-h-[22rem] overflow-y-scroll\">\n\t\t\t\t\t\t\t{#if chatList.length === 0}\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"text-xs text-gray-500 dark:text-gray-400 text-center px-5 min-h-20 w-full h-full flex justify-center items-center\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{$i18n.t('No results found')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t{#each chatList as chat, idx (chat.id)}\n\t\t\t\t\t\t\t\t{#if (idx === 0 || (idx > 0 && chat.time_range !== chatList[idx - 1].time_range)) && chat?.time_range}\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"w-full text-xs text-gray-500 dark:text-gray-500 font-medium {idx === 0\n\t\t\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t\t\t: 'pt-5'} pb-2 px-2\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{$i18n.t(chat.time_range)}\n\t\t\t\t\t\t\t\t\t\t<!-- localisation keys for time_range to be recognized from the i18next parser (so they don't get automatically removed):\n\t\t\t\t\t\t\t{$i18n.t('Today')}\n\t\t\t\t\t\t\t{$i18n.t('Yesterday')}\n\t\t\t\t\t\t\t{$i18n.t('Previous 7 days')}\n\t\t\t\t\t\t\t{$i18n.t('Previous 30 days')}\n\t\t\t\t\t\t\t{$i18n.t('January')}\n\t\t\t\t\t\t\t{$i18n.t('February')}\n\t\t\t\t\t\t\t{$i18n.t('March')}\n\t\t\t\t\t\t\t{$i18n.t('April')}\n\t\t\t\t\t\t\t{$i18n.t('May')}\n\t\t\t\t\t\t\t{$i18n.t('June')}\n\t\t\t\t\t\t\t{$i18n.t('July')}\n\t\t\t\t\t\t\t{$i18n.t('August')}\n\t\t\t\t\t\t\t{$i18n.t('September')}\n\t\t\t\t\t\t\t{$i18n.t('October')}\n\t\t\t\t\t\t\t{$i18n.t('November')}\n\t\t\t\t\t\t\t{$i18n.t('December')}\n\t\t\t\t\t\t\t-->\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\" w-full flex justify-between items-center rounded-lg text-sm py-2 px-3 hover:bg-gray-50 dark:hover:bg-gray-850\"\n\t\t\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\tclass=\" basis-3/5\"\n\t\t\t\t\t\t\t\t\t\thref={shareUrl ? `/s/${chat.id}` : `/c/${chat.id}`}\n\t\t\t\t\t\t\t\t\t\ton:click={() => (show = false)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div class=\"text-ellipsis line-clamp-1 w-full\">\n\t\t\t\t\t\t\t\t\t\t\t{chat?.title}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t\t\t\t<div class=\"basis-2/5 flex items-center justify-end\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"hidden sm:flex text-gray-500 dark:text-gray-400 text-xs\">\n\t\t\t\t\t\t\t\t\t\t\t{dayjs(chat?.updated_at * 1000).calendar()}\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex justify-end pl-2.5 text-gray-600 dark:text-gray-300\">\n\t\t\t\t\t\t\t\t\t\t\t{#if unarchiveHandler}\n\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Unarchive Chat')}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center w-fit px-1 text-sm rounded-xl\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={async (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunarchiveHandler(chat.id);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15m0-3-3-3m0 0-3 3m3-3V15\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Delete Chat')}>\n\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center w-fit px-1 text-sm rounded-xl\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={async (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedChatId = chat.id;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowDeleteConfirmDialog = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/each}\n\n\t\t\t\t\t\t\t{#if !allChatsLoaded && loadHandler}\n\t\t\t\t\t\t\t\t<Loader\n\t\t\t\t\t\t\t\t\ton:visible={(e) => {\n\t\t\t\t\t\t\t\t\t\tif (!chatListLoading) {\n\t\t\t\t\t\t\t\t\t\t\tloadHandler();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Spinner className=\" size-4\" />\n\t\t\t\t\t\t\t\t\t\t<div class=\" \">Loading...</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</Loader>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if query === ''}\n\t\t\t\t\t\t\t<slot name=\"footer\"></slot>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"w-full h-full flex justify-center items-center min-h-20\">\n\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t<!-- {#if chats !== null}\n\t\t\t\t\t{#if chats.length > 0}\n\t\t\t\t\t\t<div class=\"w-full\">\n\t\t\t\t\t\t\t<div class=\"text-left text-sm w-full mb-3 max-h-[22rem] overflow-y-scroll\">\n\t\t\t\t\t\t\t\t<div class=\"relative overflow-x-auto\">\n\t\t\t\t\t\t\t\t\t<table\n\t\t\t\t\t\t\t\t\t\tclass=\"w-full text-sm text-left text-gray-600 dark:text-gray-400 table-auto\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<thead\n\t\t\t\t\t\t\t\t\t\t\tclass=\"text-xs text-gray-700 uppercase bg-transparent dark:text-gray-200 border-b-1 border-gray-50 dark:border-gray-850\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<th scope=\"col\" class=\"px-3 py-2\"> {$i18n.t('Name')} </th>\n\t\t\t\t\t\t\t\t\t\t\t\t<th scope=\"col\" class=\"px-3 py-2 hidden md:flex\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Created At')}\n\t\t\t\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t\t\t\t<th scope=\"col\" class=\"px-3 py-2 text-right\" />\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t\t\t{#each chats as chat, idx}\n\t\t\t\t\t\t\t\t\t\t\t\t<tr\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-transparent {idx !== chats.length - 1 &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'border-b'} dark:bg-gray-900 border-gray-50 dark:border-gray-850 text-xs\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"px-3 py-1 w-2/3\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"/c/{chat.id}\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" hover:underline line-clamp-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.title}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\" px-3 py-1 hidden md:flex h-[2.5rem]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"my-auto\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{dayjs(chat.created_at * 1000).format('LLL')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"px-3 py-1 text-right\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex justify-end w-full\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{#if unarchiveHandler}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Unarchive Chat')}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center w-fit text-sm px-2 py-2 hover:bg-black/5 dark:hover:bg-white/5 rounded-xl\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunarchiveHandler(chat.id);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15m0-3-3-3m0 0-3 3m3-3V15\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Delete Chat')}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center w-fit text-sm px-2 py-2 hover:bg-black/5 dark:hover:bg-white/5 rounded-xl\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeleteHandler(chat.id);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<slot name=\"footer\"></slot>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<div class=\"text-left text-sm w-full mb-8\">\n\t\t\t\t\t\t\t{emptyPlaceholder || $i18n.t('No chats found.')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"w-full h-full\">\n\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t</div>\n\t\t\t\t{/if} -->\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n","<script>\n\timport fileSaver from 'file-saver';\n\tconst { saveAs } = fileSaver;\n\n\timport { toast } from 'svelte-sonner';\n\timport { getContext } from 'svelte';\n\timport { archiveChatById, getAllArchivedChats, getArchivedChatList } from '$lib/apis/chats';\n\n\timport ChatsModal from './ChatsModal.svelte';\n\timport UnarchiveAllConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n\texport let onUpdate = () => {};\n\n\tlet chatList = null;\n\tlet page = 1;\n\n\tlet query = '';\n\tlet orderBy = 'updated_at';\n\tlet direction = 'desc';\n\n\tlet allChatsLoaded = false;\n\tlet chatListLoading = false;\n\tlet searchDebounceTimeout;\n\n\tlet showUnarchiveAllConfirmDialog = false;\n\n\tlet filter = {};\n\t$: filter = {\n\t\t...(query ? { query } : {}),\n\t\t...(orderBy ? { order_by: orderBy } : {}),\n\t\t...(direction ? { direction } : {})\n\t};\n\n\t$: if (filter !== null) {\n\t\tsearchHandler();\n\t}\n\n\tconst searchHandler = async () => {\n\t\tif (searchDebounceTimeout) {\n\t\t\tclearTimeout(searchDebounceTimeout);\n\t\t}\n\n\t\tpage = 1;\n\t\tchatList = null;\n\n\t\tif (query === '') {\n\t\t\tchatList = await getArchivedChatList(localStorage.token, page, filter);\n\t\t} else {\n\t\t\tsearchDebounceTimeout = setTimeout(async () => {\n\t\t\t\tchatList = await getArchivedChatList(localStorage.token, page, filter);\n\t\t\t}, 500);\n\t\t}\n\n\t\tif ((chatList ?? []).length === 0) {\n\t\t\tallChatsLoaded = true;\n\t\t} else {\n\t\t\tallChatsLoaded = false;\n\t\t}\n\t};\n\n\tconst loadMoreChats = async () => {\n\t\tchatListLoading = true;\n\t\tpage += 1;\n\n\t\tlet newChatList = [];\n\n\t\tif (query) {\n\t\t\tnewChatList = await getArchivedChatList(localStorage.token, page, filter);\n\t\t} else {\n\t\t\tnewChatList = await getArchivedChatList(localStorage.token, page, filter);\n\t\t}\n\n\t\t// once the bottom of the list has been reached (no results) there is no need to continue querying\n\t\tallChatsLoaded = newChatList.length === 0;\n\n\t\tif (newChatList.length > 0) {\n\t\t\tchatList = [...chatList, ...newChatList];\n\t\t}\n\n\t\tchatListLoading = false;\n\t};\n\n\tconst exportChatsHandler = async () => {\n\t\tconst chats = await getAllArchivedChats(localStorage.token);\n\t\tlet blob = new Blob([JSON.stringify(chats)], {\n\t\t\ttype: 'application/json'\n\t\t});\n\t\tsaveAs(blob, `${$i18n.t('archived-chat-export')}-${Date.now()}.json`);\n\t};\n\n\tconst unarchiveHandler = async (chatId) => {\n\t\tconst res = await archiveChatById(localStorage.token, chatId).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t});\n\n\t\tonUpdate();\n\t\tinit();\n\t};\n\n\tconst unarchiveAllHandler = async () => {\n\t\tconst chats = await getAllArchivedChats(localStorage.token);\n\t\tfor (const chat of chats) {\n\t\t\tawait archiveChatById(localStorage.token, chat.id);\n\t\t}\n\n\t\tonUpdate();\n\t\tinit();\n\t};\n\n\tconst init = async () => {\n\t\tchatList = await getArchivedChatList(localStorage.token);\n\t};\n\n\t$: if (show) {\n\t\tinit();\n\t}\n</script>\n\n<UnarchiveAllConfirmDialog\n\tbind:show={showUnarchiveAllConfirmDialog}\n\tmessage={$i18n.t('Are you sure you want to unarchive all archived chats?')}\n\tconfirmLabel={$i18n.t('Unarchive All')}\n\ton:confirm={() => {\n\t\tunarchiveAllHandler();\n\t}}\n/>\n\n<ChatsModal\n\tbind:show\n\tbind:query\n\tbind:orderBy\n\tbind:direction\n\ttitle={$i18n.t('Archived Chats')}\n\temptyPlaceholder={$i18n.t('You have no archived conversations.')}\n\t{chatList}\n\t{allChatsLoaded}\n\t{chatListLoading}\n\tonUpdate={() => {\n\t\tinit();\n\t}}\n\tloadHandler={loadMoreChats}\n\t{unarchiveHandler}\n>\n\t<div slot=\"footer\">\n\t\t<div class=\"flex flex-wrap text-sm font-medium gap-1.5 mt-2 m-1 justify-end w-full\">\n\t\t\t<button\n\t\t\t\tclass=\" px-3.5 py-1.5 font-medium hover:bg-black/5 dark:hover:bg-white/5 outline outline-1 outline-gray-100 dark:outline-gray-800 rounded-3xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshowUnarchiveAllConfirmDialog = true;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{$i18n.t('Unarchive All Archived Chats')}\n\t\t\t</button>\n\n\t\t\t<button\n\t\t\t\tclass=\"px-3.5 py-1.5 font-medium hover:bg-black/5 dark:hover:bg-white/5 outline outline-1 outline-gray-100 dark:outline-gray-800 rounded-3xl\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\texportChatsHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{$i18n.t('Export All Archived Chats')}\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</ChatsModal>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n\tstroke-width={strokeWidth}\n\tstroke=\"currentColor\"\n\tclass={className}\n>\n\t<path\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\td=\"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n\tstroke-width={strokeWidth}\n\tstroke=\"currentColor\"\n\tclass={className}\n>\n\t<path\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\td=\"m3 3 1.664 1.664M21 21l-1.5-1.5m-5.485-1.242L12 17.25 4.5 21V8.742m.164-4.078a2.15 2.15 0 0 1 1.743-1.342 48.507 48.507 0 0 1 11.186 0c1.1.128 1.907 1.077 1.907 2.185V19.5M4.664 4.664 19.5 19.5\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\timport { DropdownMenu } from 'bits-ui';\n\timport { flyAndScale } from '$lib/utils/transitions';\n\timport { getContext, createEventDispatcher } from 'svelte';\n\n\timport fileSaver from 'file-saver';\n\tconst { saveAs } = fileSaver;\n\n\timport jsPDF from 'jspdf';\n\timport html2canvas from 'html2canvas-pro';\n\n\tconst dispatch = createEventDispatcher();\n\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\n\timport GarbageBin from '$lib/components/icons/GarbageBin.svelte';\n\timport Pencil from '$lib/components/icons/Pencil.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Tags from '$lib/components/chat/Tags.svelte';\n\timport Share from '$lib/components/icons/Share.svelte';\n\timport ArchiveBox from '$lib/components/icons/ArchiveBox.svelte';\n\timport DocumentDuplicate from '$lib/components/icons/DocumentDuplicate.svelte';\n\timport Bookmark from '$lib/components/icons/Bookmark.svelte';\n\timport BookmarkSlash from '$lib/components/icons/BookmarkSlash.svelte';\n\timport {\n\t\tgetChatById,\n\t\tgetChatPinnedStatusById,\n\t\ttoggleChatPinnedStatusById\n\t} from '$lib/apis/chats';\n\timport { chats, settings, theme, user } from '$lib/stores';\n\timport { createMessagesList } from '$lib/utils';\n\timport { downloadChatAsPDF } from '$lib/apis/utils';\n\timport Download from '$lib/components/icons/Download.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let shareHandler: Function;\n\texport let cloneChatHandler: Function;\n\texport let archiveChatHandler: Function;\n\texport let renameHandler: Function;\n\texport let deleteHandler: Function;\n\texport let onClose: Function;\n\n\texport let chatId = '';\n\n\tlet show = false;\n\tlet pinned = false;\n\n\tconst pinHandler = async () => {\n\t\tawait toggleChatPinnedStatusById(localStorage.token, chatId);\n\t\tdispatch('change');\n\t};\n\n\tconst checkPinned = async () => {\n\t\tpinned = await getChatPinnedStatusById(localStorage.token, chatId);\n\t};\n\n\tconst getChatAsText = async (chat) => {\n\t\tconst history = chat.chat.history;\n\t\tconst messages = createMessagesList(history, history.currentId);\n\t\tconst chatText = messages.reduce((a, message, i, arr) => {\n\t\t\treturn `${a}### ${message.role.toUpperCase()}\\n${message.content}\\n\\n`;\n\t\t}, '');\n\n\t\treturn chatText.trim();\n\t};\n\n\tconst downloadTxt = async () => {\n\t\tconst chat = await getChatById(localStorage.token, chatId);\n\t\tif (!chat) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst chatText = await getChatAsText(chat);\n\t\tlet blob = new Blob([chatText], {\n\t\t\ttype: 'text/plain'\n\t\t});\n\n\t\tsaveAs(blob, `chat-${chat.chat.title}.txt`);\n\t};\n\n\tconst downloadPdf = async () => {\n\t\tconst chat = await getChatById(localStorage.token, chatId);\n\n\t\tif ($settings?.stylizedPdfExport ?? true) {\n\t\t\tconst containerElement = document.getElementById('messages-container');\n\n\t\t\tif (containerElement) {\n\t\t\t\ttry {\n\t\t\t\t\tconst isDarkMode = document.documentElement.classList.contains('dark');\n\t\t\t\t\tconst virtualWidth = 800; // Fixed width in px\n\t\t\t\t\tconst pagePixelHeight = 1200; // Each slice height (adjust to avoid canvas bugs; generally 2â€“4k is safe)\n\n\t\t\t\t\t// Clone & style once\n\t\t\t\t\tconst clonedElement = containerElement.cloneNode(true);\n\t\t\t\t\tclonedElement.classList.add('text-black');\n\t\t\t\t\tclonedElement.classList.add('dark:text-white');\n\t\t\t\t\tclonedElement.style.width = `${virtualWidth}px`;\n\t\t\t\t\tclonedElement.style.position = 'absolute';\n\t\t\t\t\tclonedElement.style.left = '-9999px'; // Offscreen\n\t\t\t\t\tclonedElement.style.height = 'auto';\n\t\t\t\t\tdocument.body.appendChild(clonedElement);\n\n\t\t\t\t\t// Get total height after attached to DOM\n\t\t\t\t\tconst totalHeight = clonedElement.scrollHeight;\n\t\t\t\t\tlet offsetY = 0;\n\t\t\t\t\tlet page = 0;\n\n\t\t\t\t\t// Prepare PDF\n\t\t\t\t\tconst pdf = new jsPDF('p', 'mm', 'a4');\n\t\t\t\t\tconst imgWidth = 210; // A4 mm\n\t\t\t\t\tconst pageHeight = 297; // A4 mm\n\n\t\t\t\t\twhile (offsetY < totalHeight) {\n\t\t\t\t\t\t// For each slice, adjust scrollTop to show desired part\n\t\t\t\t\t\tclonedElement.scrollTop = offsetY;\n\n\t\t\t\t\t\t// Optionally: mask/hide overflowing content via CSS if needed\n\t\t\t\t\t\tclonedElement.style.maxHeight = `${pagePixelHeight}px`;\n\t\t\t\t\t\t// Only render the visible part\n\t\t\t\t\t\tconst canvas = await html2canvas(clonedElement, {\n\t\t\t\t\t\t\tbackgroundColor: isDarkMode ? '#000' : '#fff',\n\t\t\t\t\t\t\tuseCORS: true,\n\t\t\t\t\t\t\tscale: 2,\n\t\t\t\t\t\t\twidth: virtualWidth,\n\t\t\t\t\t\t\theight: Math.min(pagePixelHeight, totalHeight - offsetY),\n\t\t\t\t\t\t\t// Optionally: y offset for correct region?\n\t\t\t\t\t\t\twindowWidth: virtualWidth\n\t\t\t\t\t\t\t//windowHeight: pagePixelHeight,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst imgData = canvas.toDataURL('image/png');\n\t\t\t\t\t\t// Maintain aspect ratio\n\t\t\t\t\t\tconst imgHeight = (canvas.height * imgWidth) / canvas.width;\n\t\t\t\t\t\tconst position = 0; // Always first line, since we've clipped vertically\n\n\t\t\t\t\t\tif (page > 0) pdf.addPage();\n\n\t\t\t\t\t\t// Set page background for dark mode\n\t\t\t\t\t\tif (isDarkMode) {\n\t\t\t\t\t\t\tpdf.setFillColor(0, 0, 0);\n\t\t\t\t\t\t\tpdf.rect(0, 0, imgWidth, pageHeight, 'F'); // black bg\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tpdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);\n\n\t\t\t\t\t\toffsetY += pagePixelHeight;\n\t\t\t\t\t\tpage++;\n\t\t\t\t\t}\n\n\t\t\t\t\tdocument.body.removeChild(clonedElement);\n\n\t\t\t\t\tpdf.save(`chat-${chat.chat.title}.pdf`);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error('Error generating PDF', error);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.log('Downloading PDF');\n\n\t\t\tconst chatText = await getChatAsText(chat);\n\n\t\t\tconst doc = new jsPDF();\n\n\t\t\t// Margins\n\t\t\tconst left = 15;\n\t\t\tconst top = 20;\n\t\t\tconst right = 15;\n\t\t\tconst bottom = 20;\n\n\t\t\tconst pageWidth = doc.internal.pageSize.getWidth();\n\t\t\tconst pageHeight = doc.internal.pageSize.getHeight();\n\t\t\tconst usableWidth = pageWidth - left - right;\n\t\t\tconst usableHeight = pageHeight - top - bottom;\n\n\t\t\t// Font size and line height\n\t\t\tconst fontSize = 8;\n\t\t\tdoc.setFontSize(fontSize);\n\t\t\tconst lineHeight = fontSize * 1; // adjust if needed\n\n\t\t\t// Split the markdown into lines (handles \\n)\n\t\t\tconst paragraphs = chatText.split('\\n');\n\n\t\t\tlet y = top;\n\n\t\t\tfor (let paragraph of paragraphs) {\n\t\t\t\t// Wrap each paragraph to fit the width\n\t\t\t\tconst lines = doc.splitTextToSize(paragraph, usableWidth);\n\n\t\t\t\tfor (let line of lines) {\n\t\t\t\t\t// If the line would overflow the bottom, add a new page\n\t\t\t\t\tif (y + lineHeight > pageHeight - bottom) {\n\t\t\t\t\t\tdoc.addPage();\n\t\t\t\t\t\ty = top;\n\t\t\t\t\t}\n\t\t\t\t\tdoc.text(line, left, y);\n\t\t\t\t\ty += lineHeight;\n\t\t\t\t}\n\t\t\t\t// Add empty line at paragraph breaks\n\t\t\t\ty += lineHeight * 0.5;\n\t\t\t}\n\n\t\t\tdoc.save(`chat-${chat.chat.title}.pdf`);\n\t\t}\n\t};\n\n\tconst downloadJSONExport = async () => {\n\t\tconst chat = await getChatById(localStorage.token, chatId);\n\n\t\tif (chat) {\n\t\t\tlet blob = new Blob([JSON.stringify([chat])], {\n\t\t\t\ttype: 'application/json'\n\t\t\t});\n\t\t\tsaveAs(blob, `chat-export-${Date.now()}.json`);\n\t\t}\n\t};\n\n\t$: if (show) {\n\t\tcheckPinned();\n\t}\n</script>\n\n<Dropdown\n\tbind:show\n\ton:change={(e) => {\n\t\tif (e.detail === false) {\n\t\t\tonClose();\n\t\t}\n\t}}\n>\n\t<Tooltip content={$i18n.t('More')}>\n\t\t<slot />\n\t</Tooltip>\n\n\t<div slot=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full max-w-[200px] rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\n\t\t\tsideOffset={-2}\n\t\t\tside=\"bottom\"\n\t\t\talign=\"start\"\n\t\t\ttransition={flyAndScale}\n\t\t>\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tpinHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{#if pinned}\n\t\t\t\t\t<BookmarkSlash strokeWidth=\"2\" />\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Unpin')}</div>\n\t\t\t\t{:else}\n\t\t\t\t\t<Bookmark strokeWidth=\"2\" />\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Pin')}</div>\n\t\t\t\t{/if}\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\trenameHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Pencil strokeWidth=\"2\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Rename')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tcloneChatHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<DocumentDuplicate strokeWidth=\"2\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Clone')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tarchiveChatHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<ArchiveBox strokeWidth=\"2\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Archive')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t{#if $user?.role === 'admin' || ($user.permissions?.chat?.share ?? true)}\n\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-md\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tshareHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Share />\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Share')}</div>\n\t\t\t\t</DropdownMenu.Item>\n\t\t\t{/if}\n\n\t\t\t<DropdownMenu.Sub>\n\t\t\t\t<DropdownMenu.SubTrigger\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t>\n\t\t\t\t\t<Download strokeWidth=\"2\" />\n\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Download')}</div>\n\t\t\t\t</DropdownMenu.SubTrigger>\n\t\t\t\t<DropdownMenu.SubContent\n\t\t\t\t\tclass=\"w-full rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\n\t\t\t\t\ttransition={flyAndScale}\n\t\t\t\t\tsideOffset={8}\n\t\t\t\t>\n\t\t\t\t\t{#if $user?.role === 'admin' || ($user.permissions?.chat?.export ?? true)}\n\t\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tdownloadJSONExport();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('Export chat (.json)')}</div>\n\t\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdownloadTxt();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('Plain text (.txt)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdownloadPdf();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('PDF document (.pdf)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t</DropdownMenu.SubContent>\n\t\t\t</DropdownMenu.Sub>\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tdeleteHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<GarbageBin strokeWidth=\"2\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Delete')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<hr class=\"border-gray-100 dark:border-gray-850 my-0.5\" />\n\n\t\t\t<div class=\"flex p-1\">\n\t\t\t\t<Tags\n\t\t\t\t\t{chatId}\n\t\t\t\t\ton:add={(e) => {\n\t\t\t\t\t\tdispatch('tag', {\n\t\t\t\t\t\t\ttype: 'add',\n\t\t\t\t\t\t\tname: e.detail.name\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tshow = false;\n\t\t\t\t\t}}\n\t\t\t\t\ton:delete={(e) => {\n\t\t\t\t\t\tdispatch('tag', {\n\t\t\t\t\t\t\ttype: 'delete',\n\t\t\t\t\t\t\tname: e.detail.name\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tshow = false;\n\t\t\t\t\t}}\n\t\t\t\t\ton:close={() => {\n\t\t\t\t\t\tshow = false;\n\t\t\t\t\t\tonClose();\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</DropdownMenu.Content>\n\t</div>\n</Dropdown>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { goto, invalidate, invalidateAll } from '$app/navigation';\n\timport { onMount, getContext, createEventDispatcher, tick, onDestroy } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\tconst dispatch = createEventDispatcher();\n\n\timport {\n\t\tarchiveChatById,\n\t\tcloneChatById,\n\t\tdeleteChatById,\n\t\tgetAllTags,\n\t\tgetChatById,\n\t\tgetChatList,\n\t\tgetChatListByTagName,\n\t\tgetPinnedChatList,\n\t\tupdateChatById\n\t} from '$lib/apis/chats';\n\timport {\n\t\tchatId,\n\t\tchatTitle as _chatTitle,\n\t\tchats,\n\t\tmobile,\n\t\tpinnedChats,\n\t\tshowSidebar,\n\t\tcurrentChatPage,\n\t\ttags\n\t} from '$lib/stores';\n\n\timport ChatMenu from './ChatMenu.svelte';\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\timport ShareChatModal from '$lib/components/chat/ShareChatModal.svelte';\n\timport GarbageBin from '$lib/components/icons/GarbageBin.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport ArchiveBox from '$lib/components/icons/ArchiveBox.svelte';\n\timport DragGhost from '$lib/components/common/DragGhost.svelte';\n\timport Check from '$lib/components/icons/Check.svelte';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport Document from '$lib/components/icons/Document.svelte';\n\timport Sparkles from '$lib/components/icons/Sparkles.svelte';\n\timport { generateTitle } from '$lib/apis';\n\n\texport let className = '';\n\n\texport let id;\n\texport let title;\n\n\texport let selected = false;\n\texport let shiftKey = false;\n\n\tlet chat = null;\n\n\tlet mouseOver = false;\n\tlet draggable = false;\n\t$: if (mouseOver) {\n\t\tloadChat();\n\t}\n\n\tconst loadChat = async () => {\n\t\tif (!chat) {\n\t\t\tdraggable = false;\n\t\t\tchat = await getChatById(localStorage.token, id);\n\t\t\tdraggable = true;\n\t\t}\n\t};\n\n\tlet showShareChatModal = false;\n\tlet confirmEdit = false;\n\n\tlet chatTitle = title;\n\n\tconst editChatTitle = async (id, title) => {\n\t\tif (title === '') {\n\t\t\ttoast.error($i18n.t('Title cannot be an empty string.'));\n\t\t} else {\n\t\t\tawait updateChatById(localStorage.token, id, {\n\t\t\t\ttitle: title\n\t\t\t});\n\n\t\t\tif (id === $chatId) {\n\t\t\t\t_chatTitle.set(title);\n\t\t\t}\n\n\t\t\tcurrentChatPage.set(1);\n\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\t\tawait pinnedChats.set(await getPinnedChatList(localStorage.token));\n\n\t\t\tdispatch('change');\n\t\t}\n\t};\n\n\tconst cloneChatHandler = async (id) => {\n\t\tconst res = await cloneChatById(\n\t\t\tlocalStorage.token,\n\t\t\tid,\n\t\t\t$i18n.t('Clone of {{TITLE}}', {\n\t\t\t\tTITLE: title\n\t\t\t})\n\t\t).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tgoto(`/c/${res.id}`);\n\n\t\t\tcurrentChatPage.set(1);\n\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\t\tawait pinnedChats.set(await getPinnedChatList(localStorage.token));\n\t\t}\n\t};\n\n\tconst deleteChatHandler = async (id) => {\n\t\tconst res = await deleteChatById(localStorage.token, id).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\ttags.set(await getAllTags(localStorage.token));\n\t\t\tif ($chatId === id) {\n\t\t\t\tawait goto('/');\n\n\t\t\t\tawait chatId.set('');\n\t\t\t\tawait tick();\n\t\t\t}\n\n\t\t\tdispatch('change');\n\t\t}\n\t};\n\n\tconst archiveChatHandler = async (id) => {\n\t\tawait archiveChatById(localStorage.token, id);\n\t\tdispatch('change');\n\t};\n\n\tlet itemElement;\n\n\tlet generating = false;\n\tlet doubleClicked = false;\n\tlet dragged = false;\n\tlet x = 0;\n\tlet y = 0;\n\n\tconst dragImage = new Image();\n\tdragImage.src =\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=';\n\n\tconst onDragStart = (event) => {\n\t\tevent.stopPropagation();\n\n\t\tevent.dataTransfer.setDragImage(dragImage, 0, 0);\n\n\t\t// Set the data to be transferred\n\t\tevent.dataTransfer.setData(\n\t\t\t'text/plain',\n\t\t\tJSON.stringify({\n\t\t\t\ttype: 'chat',\n\t\t\t\tid: id,\n\t\t\t\titem: chat\n\t\t\t})\n\t\t);\n\n\t\tdragged = true;\n\t\titemElement.style.opacity = '0.5'; // Optional: Visual cue to show it's being dragged\n\t};\n\n\tconst onDrag = (event) => {\n\t\tevent.stopPropagation();\n\n\t\tx = event.clientX;\n\t\ty = event.clientY;\n\t};\n\n\tconst onDragEnd = (event) => {\n\t\tevent.stopPropagation();\n\n\t\titemElement.style.opacity = '1'; // Reset visual cue after drag\n\t\tdragged = false;\n\t};\n\n\tonMount(() => {\n\t\tif (itemElement) {\n\t\t\t// Event listener for when dragging starts\n\t\t\titemElement.addEventListener('dragstart', onDragStart);\n\t\t\t// Event listener for when dragging occurs (optional)\n\t\t\titemElement.addEventListener('drag', onDrag);\n\t\t\t// Event listener for when dragging ends\n\t\t\titemElement.addEventListener('dragend', onDragEnd);\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\tif (itemElement) {\n\t\t\titemElement.removeEventListener('dragstart', onDragStart);\n\t\t\titemElement.removeEventListener('drag', onDrag);\n\t\t\titemElement.removeEventListener('dragend', onDragEnd);\n\t\t}\n\t});\n\n\tlet showDeleteConfirm = false;\n\n\tconst chatTitleInputKeydownHandler = (e) => {\n\t\tif (e.key === 'Enter') {\n\t\t\te.preventDefault();\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst input = document.getElementById(`chat-title-input-${id}`);\n\t\t\t\tif (input) input.blur();\n\t\t\t}, 0);\n\t\t} else if (e.key === 'Escape') {\n\t\t\te.preventDefault();\n\t\t\tconfirmEdit = false;\n\t\t\tchatTitle = '';\n\t\t}\n\t};\n\n\tconst renameHandler = async () => {\n\t\tchatTitle = title;\n\t\tconfirmEdit = true;\n\n\t\tawait tick();\n\n\t\tsetTimeout(() => {\n\t\t\tconst input = document.getElementById(`chat-title-input-${id}`);\n\t\t\tif (input) input.focus();\n\t\t}, 0);\n\t};\n\n\tconst generateTitleHandler = async () => {\n\t\tgenerating = true;\n\t\tif (!chat) {\n\t\t\tchat = await getChatById(localStorage.token, id);\n\t\t}\n\n\t\tconst messages = (chat.chat?.messages ?? []).map((message) => {\n\t\t\treturn {\n\t\t\t\trole: message.role,\n\t\t\t\tcontent: message.content\n\t\t\t};\n\t\t});\n\n\t\tconst model = chat.chat.models.at(0) ?? chat.models.at(0) ?? '';\n\n\t\tchatTitle = '';\n\n\t\tconst generatedTitle = await generateTitle(localStorage.token, model, messages).catch(\n\t\t\t(error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t);\n\n\t\tif (generatedTitle) {\n\t\t\tif (generatedTitle !== title) {\n\t\t\t\teditChatTitle(id, generatedTitle);\n\t\t\t}\n\n\t\t\tconfirmEdit = false;\n\t\t} else {\n\t\t\tchatTitle = title;\n\t\t}\n\n\t\tgenerating = false;\n\t};\n</script>\n\n<ShareChatModal bind:show={showShareChatModal} chatId={id} />\n\n<DeleteConfirmDialog\n\tbind:show={showDeleteConfirm}\n\ttitle={$i18n.t('Delete chat?')}\n\ton:confirm={() => {\n\t\tdeleteChatHandler(id);\n\t}}\n>\n\t<div class=\" text-sm text-gray-500 flex-1 line-clamp-3\">\n\t\t{$i18n.t('This will delete')} <span class=\"  font-semibold\">{title}</span>.\n\t</div>\n</DeleteConfirmDialog>\n\n{#if dragged && x && y}\n\t<DragGhost {x} {y}>\n\t\t<div class=\" bg-black/80 backdrop-blur-2xl px-2 py-1 rounded-lg w-fit max-w-40\">\n\t\t\t<div class=\"flex items-center gap-1\">\n\t\t\t\t<Document className=\" size-[18px]\" strokeWidth=\"2\" />\n\t\t\t\t<div class=\" text-xs text-white line-clamp-1\">\n\t\t\t\t\t{title}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</DragGhost>\n{/if}\n\n<div\n\tbind:this={itemElement}\n\tclass=\" w-full {className} relative group\"\n\tdraggable={draggable && !confirmEdit}\n>\n\t{#if confirmEdit}\n\t\t<div\n\t\t\tclass=\" w-full flex justify-between rounded-lg px-[11px] py-[6px] {id === $chatId ||\n\t\t\tconfirmEdit\n\t\t\t\t? 'bg-gray-200 dark:bg-gray-900'\n\t\t\t\t: selected\n\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-950'\n\t\t\t\t\t: 'group-hover:bg-gray-100 dark:group-hover:bg-gray-950'}  whitespace-nowrap text-ellipsis relative {generating\n\t\t\t\t? 'cursor-not-allowed'\n\t\t\t\t: ''}\"\n\t\t>\n\t\t\t<input\n\t\t\t\tid=\"chat-title-input-{id}\"\n\t\t\t\tbind:value={chatTitle}\n\t\t\t\tclass=\" bg-transparent w-full outline-hidden mr-10\"\n\t\t\t\tplaceholder={generating ? $i18n.t('Generating...') : ''}\n\t\t\t\ton:keydown={chatTitleInputKeydownHandler}\n\t\t\t\ton:blur={async (e) => {\n\t\t\t\t\t// check if target is generate button\n\t\t\t\t\tif (e.relatedTarget?.id === 'generate-title-button') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (doubleClicked) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tconst input = document.getElementById(`chat-title-input-${id}`);\n\t\t\t\t\t\t\tif (input) input.focus();\n\t\t\t\t\t\t}, 0);\n\n\t\t\t\t\t\tdoubleClicked = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chatTitle !== title) {\n\t\t\t\t\t\teditChatTitle(id, chatTitle);\n\t\t\t\t\t}\n\n\t\t\t\t\tconfirmEdit = false;\n\t\t\t\t\tchatTitle = '';\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\t{:else}\n\t\t<a\n\t\t\tclass=\" w-full flex justify-between rounded-lg px-[11px] py-[6px] {id === $chatId ||\n\t\t\tconfirmEdit\n\t\t\t\t? 'bg-gray-200 dark:bg-gray-900'\n\t\t\t\t: selected\n\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-950'\n\t\t\t\t\t: ' group-hover:bg-gray-100 dark:group-hover:bg-gray-950'}  whitespace-nowrap text-ellipsis\"\n\t\t\thref=\"/c/{id}\"\n\t\t\ton:click={() => {\n\t\t\t\tdispatch('select');\n\n\t\t\t\tif ($mobile) {\n\t\t\t\t\tshowSidebar.set(false);\n\t\t\t\t}\n\t\t\t}}\n\t\t\ton:dblclick={async (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\n\t\t\t\tdoubleClicked = true;\n\t\t\t\trenameHandler();\n\t\t\t}}\n\t\t\ton:mouseenter={(e) => {\n\t\t\t\tmouseOver = true;\n\t\t\t}}\n\t\t\ton:mouseleave={(e) => {\n\t\t\t\tmouseOver = false;\n\t\t\t}}\n\t\t\ton:focus={(e) => {}}\n\t\t\tdraggable=\"false\"\n\t\t>\n\t\t\t<div class=\" flex self-center flex-1 w-full\">\n\t\t\t\t<div dir=\"auto\" class=\"text-left self-center overflow-hidden w-full h-[20px]\">\n\t\t\t\t\t{title}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</a>\n\t{/if}\n\n\t<!-- svelte-ignore a11y-no-static-element-interactions -->\n\t<div\n\t\tclass=\"\n        {id === $chatId || confirmEdit\n\t\t\t? 'from-gray-200 dark:from-gray-900'\n\t\t\t: selected\n\t\t\t\t? 'from-gray-100 dark:from-gray-950'\n\t\t\t\t: 'invisible group-hover:visible from-gray-100 dark:from-gray-950'}\n            absolute {className === 'pr-2'\n\t\t\t? 'right-[8px]'\n\t\t\t: 'right-1'} top-[4px] py-1 pr-0.5 mr-1.5 pl-5 bg-linear-to-l from-80%\n\n              to-transparent\"\n\t\ton:mouseenter={(e) => {\n\t\t\tmouseOver = true;\n\t\t}}\n\t\ton:mouseleave={(e) => {\n\t\t\tmouseOver = false;\n\t\t}}\n\t>\n\t\t{#if confirmEdit}\n\t\t\t<div\n\t\t\t\tclass=\"flex self-center items-center space-x-1.5 z-10 translate-y-[0.5px] -translate-x-[0.5px]\"\n\t\t\t>\n\t\t\t\t<Tooltip content={$i18n.t('Generate')}>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" self-center dark:hover:text-white transition\"\n\t\t\t\t\t\tid=\"generate-title-button\"\n\t\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\t\tgenerateTitleHandler();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Sparkles strokeWidth=\"2\" />\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\t\t{:else if shiftKey && mouseOver}\n\t\t\t<div class=\" flex items-center self-center space-x-1.5\">\n\t\t\t\t<Tooltip content={$i18n.t('Archive')} className=\"flex items-center\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" self-center dark:hover:text-white transition\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tarchiveChatHandler(id);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ArchiveBox className=\"size-4  translate-y-[0.5px]\" strokeWidth=\"2\" />\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>\n\n\t\t\t\t<Tooltip content={$i18n.t('Delete')}>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" self-center dark:hover:text-white transition\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdeleteChatHandler(id);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<GarbageBin strokeWidth=\"2\" />\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"flex self-center z-10 items-end\">\n\t\t\t\t<ChatMenu\n\t\t\t\t\tchatId={id}\n\t\t\t\t\tcloneChatHandler={() => {\n\t\t\t\t\t\tcloneChatHandler(id);\n\t\t\t\t\t}}\n\t\t\t\t\tshareHandler={() => {\n\t\t\t\t\t\tshowShareChatModal = true;\n\t\t\t\t\t}}\n\t\t\t\t\tarchiveChatHandler={() => {\n\t\t\t\t\t\tarchiveChatHandler(id);\n\t\t\t\t\t}}\n\t\t\t\t\t{renameHandler}\n\t\t\t\t\tdeleteHandler={() => {\n\t\t\t\t\t\tshowDeleteConfirm = true;\n\t\t\t\t\t}}\n\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\tdispatch('unselect');\n\t\t\t\t\t}}\n\t\t\t\t\ton:change={async () => {\n\t\t\t\t\t\tdispatch('change');\n\t\t\t\t\t}}\n\t\t\t\t\ton:tag={(e) => {\n\t\t\t\t\t\tdispatch('tag', e.detail);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<button\n\t\t\t\t\t\taria-label=\"Chat Menu\"\n\t\t\t\t\t\tclass=\" self-center dark:hover:text-white transition m-0\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdispatch('select');\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M2 8a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM6.5 8a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM12.5 6.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Z\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</ChatMenu>\n\n\t\t\t\t{#if id === $chatId}\n\t\t\t\t\t<!-- Shortcut support using \"delete-chat-button\" id -->\n\t\t\t\t\t<button\n\t\t\t\t\t\tid=\"delete-chat-button\"\n\t\t\t\t\t\tclass=\"hidden\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tshowDeleteConfirm = true;\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M2 8a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM6.5 8a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM12.5 6.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Z\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport { getContext, createEventDispatcher, onMount, onDestroy } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\tconst dispatch = createEventDispatcher();\n\n\timport ChevronDown from '../icons/ChevronDown.svelte';\n\timport ChevronRight from '../icons/ChevronRight.svelte';\n\timport Collapsible from './Collapsible.svelte';\n\timport Tooltip from './Tooltip.svelte';\n\timport Plus from '../icons/Plus.svelte';\n\n\texport let open = true;\n\n\texport let id = '';\n\texport let name = '';\n\texport let collapsible = true;\n\n\texport let onAddLabel: string = '';\n\texport let onAdd: null | Function = null;\n\n\texport let dragAndDrop = true;\n\n\texport let className = '';\n\n\tlet folderElement;\n\n\tlet draggedOver = false;\n\n\tconst onDragOver = (e) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tdraggedOver = true;\n\t};\n\n\tconst onDrop = (e) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tif (folderElement.contains(e.target)) {\n\t\t\tconsole.log('Dropped on the Button');\n\n\t\t\tif (e.dataTransfer.items && e.dataTransfer.items.length > 0) {\n\t\t\t\t// Iterate over all items in the DataTransferItemList use functional programming\n\t\t\t\tfor (const item of Array.from(e.dataTransfer.items)) {\n\t\t\t\t\t// If dropped items aren't files, reject them\n\t\t\t\t\tif (item.kind === 'file') {\n\t\t\t\t\t\tconst file = item.getAsFile();\n\t\t\t\t\t\tif (file && file.type === 'application/json') {\n\t\t\t\t\t\t\tconsole.log('Dropped file is a JSON file!');\n\n\t\t\t\t\t\t\t// Read the JSON file with FileReader\n\t\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\t\treader.onload = async function (event) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tconst fileContent = JSON.parse(event.target.result);\n\t\t\t\t\t\t\t\t\tconsole.log('Parsed JSON Content: ', fileContent);\n\t\t\t\t\t\t\t\t\topen = true;\n\t\t\t\t\t\t\t\t\tdispatch('import', fileContent);\n\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\tconsole.error('Error parsing JSON file:', error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t// Start reading the file\n\t\t\t\t\t\t\treader.readAsText(file);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.error('Only JSON file types are supported.');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\topen = true;\n\n\t\t\t\t\t\tconst dataTransfer = e.dataTransfer.getData('text/plain');\n\t\t\t\t\t\tconst data = JSON.parse(dataTransfer);\n\n\t\t\t\t\t\tconsole.log(data);\n\t\t\t\t\t\tdispatch('drop', data);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdraggedOver = false;\n\t\t}\n\t};\n\n\tconst onDragLeave = (e) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tdraggedOver = false;\n\t};\n\n\tonMount(() => {\n\t\tif (!dragAndDrop) {\n\t\t\treturn;\n\t\t}\n\t\tfolderElement.addEventListener('dragover', onDragOver);\n\t\tfolderElement.addEventListener('drop', onDrop);\n\t\tfolderElement.addEventListener('dragleave', onDragLeave);\n\t});\n\n\tonDestroy(() => {\n\t\tif (!dragAndDrop) {\n\t\t\treturn;\n\t\t}\n\t\tfolderElement.addEventListener('dragover', onDragOver);\n\t\tfolderElement.removeEventListener('drop', onDrop);\n\t\tfolderElement.removeEventListener('dragleave', onDragLeave);\n\t});\n</script>\n\n<div bind:this={folderElement} class=\"relative {className}\">\n\t{#if draggedOver}\n\t\t<div\n\t\t\tclass=\"absolute top-0 left-0 w-full h-full rounded-xs bg-gray-100/50 dark:bg-gray-700/20 bg-opacity-50 dark:bg-opacity-10 z-50 pointer-events-none touch-none\"\n\t\t></div>\n\t{/if}\n\n\t{#if collapsible}\n\t\t<Collapsible\n\t\t\tbind:open\n\t\t\tclassName=\"w-full \"\n\t\t\tbuttonClassName=\"w-full\"\n\t\t\tonChange={(state) => {\n\t\t\t\tdispatch('change', state);\n\t\t\t}}\n\t\t>\n\t\t\t<!-- svelte-ignore a11y-no-static-element-interactions -->\n\t\t\t<div\n\t\t\t\tclass=\"w-full group rounded-md relative flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-900 text-gray-500 dark:text-gray-500 transition\"\n\t\t\t>\n\t\t\t\t<button class=\"w-full py-1.5 pl-2 flex items-center gap-1.5 text-xs font-medium\">\n\t\t\t\t\t<div class=\"text-gray-300 dark:text-gray-600\">\n\t\t\t\t\t\t{#if open}\n\t\t\t\t\t\t\t<ChevronDown className=\" size-3\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<ChevronRight className=\" size-3\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"translate-y-[0.5px]\">\n\t\t\t\t\t\t{name}\n\t\t\t\t\t</div>\n\t\t\t\t</button>\n\n\t\t\t\t{#if onAdd}\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"absolute z-10 right-2 invisible group-hover:visible self-center flex items-center dark:text-gray-300\"\n\t\t\t\t\t\ton:pointerup={(e) => {\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tonAdd();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Tooltip content={onAddLabel}>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"p-0.5 dark:hover:bg-gray-850 rounded-lg touch-auto\"\n\t\t\t\t\t\t\t\ton:click={(e) => {}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Plus className=\" size-3\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t</button>\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t<div slot=\"content\" class=\"w-full\">\n\t\t\t\t<slot></slot>\n\t\t\t</div>\n\t\t</Collapsible>\n\t{:else}\n\t\t<slot></slot>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { DropdownMenu } from 'bits-ui';\n\timport { flyAndScale } from '$lib/utils/transitions';\n\timport { getContext, createEventDispatcher } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\tconst dispatch = createEventDispatcher();\n\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\n\timport GarbageBin from '$lib/components/icons/GarbageBin.svelte';\n\timport Pencil from '$lib/components/icons/Pencil.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Download from '$lib/components/icons/Download.svelte';\n\n\tlet show = false;\n</script>\n\n<Dropdown\n\tbind:show\n\ton:change={(e) => {\n\t\tif (e.detail === false) {\n\t\t\tdispatch('close');\n\t\t}\n\t}}\n>\n\t<Tooltip content={$i18n.t('More')}>\n\t\t<slot />\n\t</Tooltip>\n\n\t<div slot=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full max-w-[170px] rounded-lg px-1 py-1.5  z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\n\t\t\tsideOffset={-2}\n\t\t\tside=\"bottom\"\n\t\t\talign=\"start\"\n\t\t\ttransition={flyAndScale}\n\t\t>\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tdispatch('rename');\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Pencil strokeWidth=\"2\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Rename')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tdispatch('export');\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Download strokeWidth=\"2\" />\n\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Export')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tdispatch('delete');\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<GarbageBin strokeWidth=\"2\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Delete')}</div>\n\t\t\t</DropdownMenu.Item>\n\t\t</DropdownMenu.Content>\n\t</div>\n</Dropdown>\n","<script>\n\timport { getContext, createEventDispatcher, onMount, onDestroy, tick } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\tconst dispatch = createEventDispatcher();\n\n\timport DOMPurify from 'dompurify';\n\timport fileSaver from 'file-saver';\n\tconst { saveAs } = fileSaver;\n\n\timport ChevronDown from '../../icons/ChevronDown.svelte';\n\timport ChevronRight from '../../icons/ChevronRight.svelte';\n\timport Collapsible from '../../common/Collapsible.svelte';\n\timport DragGhost from '$lib/components/common/DragGhost.svelte';\n\n\timport FolderOpen from '$lib/components/icons/FolderOpen.svelte';\n\timport EllipsisHorizontal from '$lib/components/icons/EllipsisHorizontal.svelte';\n\timport {\n\t\tdeleteFolderById,\n\t\tupdateFolderIsExpandedById,\n\t\tupdateFolderNameById,\n\t\tupdateFolderParentIdById\n\t} from '$lib/apis/folders';\n\timport { toast } from 'svelte-sonner';\n\timport {\n\t\tgetChatById,\n\t\tgetChatsByFolderId,\n\t\timportChat,\n\t\tupdateChatFolderIdById\n\t} from '$lib/apis/chats';\n\timport ChatItem from './ChatItem.svelte';\n\timport FolderMenu from './Folders/FolderMenu.svelte';\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\n\texport let open = false;\n\n\texport let folders;\n\texport let folderId;\n\n\texport let className = '';\n\n\texport let parentDragged = false;\n\n\tlet folderElement;\n\n\tlet edit = false;\n\n\tlet draggedOver = false;\n\tlet dragged = false;\n\n\tlet name = '';\n\n\tconst onDragOver = (e) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tif (dragged || parentDragged) {\n\t\t\treturn;\n\t\t}\n\t\tdraggedOver = true;\n\t};\n\n\tconst onDrop = async (e) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tif (dragged || parentDragged) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (folderElement.contains(e.target)) {\n\t\t\tconsole.log('Dropped on the Button');\n\n\t\t\tif (e.dataTransfer.items && e.dataTransfer.items.length > 0) {\n\t\t\t\t// Iterate over all items in the DataTransferItemList use functional programming\n\t\t\t\tfor (const item of Array.from(e.dataTransfer.items)) {\n\t\t\t\t\t// If dropped items aren't files, reject them\n\t\t\t\t\tif (item.kind === 'file') {\n\t\t\t\t\t\tconst file = item.getAsFile();\n\t\t\t\t\t\tif (file && file.type === 'application/json') {\n\t\t\t\t\t\t\tconsole.log('Dropped file is a JSON file!');\n\n\t\t\t\t\t\t\t// Read the JSON file with FileReader\n\t\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\t\treader.onload = async function (event) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tconst fileContent = JSON.parse(event.target.result);\n\t\t\t\t\t\t\t\t\topen = true;\n\t\t\t\t\t\t\t\t\tdispatch('import', {\n\t\t\t\t\t\t\t\t\t\tfolderId: folderId,\n\t\t\t\t\t\t\t\t\t\titems: fileContent\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\tconsole.error('Error parsing JSON file:', error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t// Start reading the file\n\t\t\t\t\t\t\treader.readAsText(file);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.error('Only JSON file types are supported.');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconsole.log(file);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Handle the drag-and-drop data for folders or chats (same as before)\n\t\t\t\t\t\tconst dataTransfer = e.dataTransfer.getData('text/plain');\n\t\t\t\t\t\tconst data = JSON.parse(dataTransfer);\n\t\t\t\t\t\tconsole.log(data);\n\n\t\t\t\t\t\tconst { type, id, item } = data;\n\n\t\t\t\t\t\tif (type === 'folder') {\n\t\t\t\t\t\t\topen = true;\n\t\t\t\t\t\t\tif (id === folderId) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Move the folder\n\t\t\t\t\t\t\tconst res = await updateFolderParentIdById(localStorage.token, id, folderId).catch(\n\t\t\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\t\tdispatch('update');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (type === 'chat') {\n\t\t\t\t\t\t\topen = true;\n\n\t\t\t\t\t\t\tlet chat = await getChatById(localStorage.token, id).catch((error) => {\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (!chat && item) {\n\t\t\t\t\t\t\t\tchat = await importChat(localStorage.token, item.chat, item?.meta ?? {});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Move the chat\n\t\t\t\t\t\t\tconst res = await updateChatFolderIdById(localStorage.token, chat.id, folderId).catch(\n\t\t\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\t\tdispatch('update');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdraggedOver = false;\n\t\t}\n\t};\n\n\tconst onDragLeave = (e) => {\n\t\te.preventDefault();\n\t\tif (dragged || parentDragged) {\n\t\t\treturn;\n\t\t}\n\n\t\tdraggedOver = false;\n\t};\n\n\tconst dragImage = new Image();\n\tdragImage.src =\n\t\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=';\n\n\tlet x;\n\tlet y;\n\n\tconst onDragStart = (event) => {\n\t\tevent.stopPropagation();\n\t\tevent.dataTransfer.setDragImage(dragImage, 0, 0);\n\n\t\t// Set the data to be transferred\n\t\tevent.dataTransfer.setData(\n\t\t\t'text/plain',\n\t\t\tJSON.stringify({\n\t\t\t\ttype: 'folder',\n\t\t\t\tid: folderId\n\t\t\t})\n\t\t);\n\n\t\tdragged = true;\n\t\tfolderElement.style.opacity = '0.5'; // Optional: Visual cue to show it's being dragged\n\t};\n\n\tconst onDrag = (event) => {\n\t\tevent.stopPropagation();\n\n\t\tx = event.clientX;\n\t\ty = event.clientY;\n\t};\n\n\tconst onDragEnd = (event) => {\n\t\tevent.stopPropagation();\n\n\t\tfolderElement.style.opacity = '1'; // Reset visual cue after drag\n\t\tdragged = false;\n\t};\n\n\tonMount(async () => {\n\t\topen = folders[folderId].is_expanded;\n\t\tif (folderElement) {\n\t\t\tfolderElement.addEventListener('dragover', onDragOver);\n\t\t\tfolderElement.addEventListener('drop', onDrop);\n\t\t\tfolderElement.addEventListener('dragleave', onDragLeave);\n\n\t\t\t// Event listener for when dragging starts\n\t\t\tfolderElement.addEventListener('dragstart', onDragStart);\n\t\t\t// Event listener for when dragging occurs (optional)\n\t\t\tfolderElement.addEventListener('drag', onDrag);\n\t\t\t// Event listener for when dragging ends\n\t\t\tfolderElement.addEventListener('dragend', onDragEnd);\n\t\t}\n\n\t\tif (folders[folderId]?.new) {\n\t\t\tdelete folders[folderId].new;\n\n\t\t\tawait tick();\n\t\t\teditHandler();\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\tif (folderElement) {\n\t\t\tfolderElement.addEventListener('dragover', onDragOver);\n\t\t\tfolderElement.removeEventListener('drop', onDrop);\n\t\t\tfolderElement.removeEventListener('dragleave', onDragLeave);\n\n\t\t\tfolderElement.removeEventListener('dragstart', onDragStart);\n\t\t\tfolderElement.removeEventListener('drag', onDrag);\n\t\t\tfolderElement.removeEventListener('dragend', onDragEnd);\n\t\t}\n\t});\n\n\tlet showDeleteConfirm = false;\n\n\tconst deleteHandler = async () => {\n\t\tconst res = await deleteFolderById(localStorage.token, folderId).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\ttoast.success($i18n.t('Folder deleted successfully'));\n\t\t\tdispatch('update');\n\t\t}\n\t};\n\n\tconst nameUpdateHandler = async () => {\n\t\tif (name === '') {\n\t\t\ttoast.error($i18n.t('Folder name cannot be empty.'));\n\t\t\treturn;\n\t\t}\n\n\t\tif (name === folders[folderId].name) {\n\t\t\tedit = false;\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentName = folders[folderId].name;\n\n\t\tname = name.trim();\n\t\tfolders[folderId].name = name;\n\n\t\tconst res = await updateFolderNameById(localStorage.token, folderId, name).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\n\t\t\tfolders[folderId].name = currentName;\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tfolders[folderId].name = name;\n\t\t\ttoast.success($i18n.t('Folder name updated successfully'));\n\t\t\tdispatch('update');\n\t\t}\n\t};\n\n\tconst isExpandedUpdateHandler = async () => {\n\t\tconst res = await updateFolderIsExpandedById(localStorage.token, folderId, open).catch(\n\t\t\t(error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t);\n\t};\n\n\tlet isExpandedUpdateTimeout;\n\n\tconst isExpandedUpdateDebounceHandler = (open) => {\n\t\tclearTimeout(isExpandedUpdateTimeout);\n\t\tisExpandedUpdateTimeout = setTimeout(() => {\n\t\t\tisExpandedUpdateHandler();\n\t\t}, 500);\n\t};\n\n\t$: isExpandedUpdateDebounceHandler(open);\n\n\tconst editHandler = async () => {\n\t\tconsole.log('Edit');\n\t\tawait tick();\n\t\tname = folders[folderId].name;\n\n\t\tedit = true;\n\t\tawait tick();\n\n\t\tconst input = document.getElementById(`folder-${folderId}-input`);\n\n\t\tif (input) {\n\t\t\tinput.focus();\n\t\t}\n\t};\n\n\tconst exportHandler = async () => {\n\t\tconst chats = await getChatsByFolderId(localStorage.token, folderId).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\t\tif (!chats) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst blob = new Blob([JSON.stringify(chats)], {\n\t\t\ttype: 'application/json'\n\t\t});\n\n\t\tsaveAs(blob, `folder-${folders[folderId].name}-export-${Date.now()}.json`);\n\t};\n</script>\n\n<DeleteConfirmDialog\n\tbind:show={showDeleteConfirm}\n\ttitle={$i18n.t('Delete folder?')}\n\ton:confirm={() => {\n\t\tdeleteHandler();\n\t}}\n>\n\t<div class=\" text-sm text-gray-700 dark:text-gray-300 flex-1 line-clamp-3\">\n\t\t{@html DOMPurify.sanitize(\n\t\t\t$i18n.t('This will delete <strong>{{NAME}}</strong> and <strong>all its contents</strong>.', {\n\t\t\t\tNAME: folders[folderId].name\n\t\t\t})\n\t\t)}\n\t</div>\n</DeleteConfirmDialog>\n\n{#if dragged && x && y}\n\t<DragGhost {x} {y}>\n\t\t<div class=\" bg-black/80 backdrop-blur-2xl px-2 py-1 rounded-lg w-fit max-w-40\">\n\t\t\t<div class=\"flex items-center gap-1\">\n\t\t\t\t<FolderOpen className=\"size-3.5\" strokeWidth=\"2\" />\n\t\t\t\t<div class=\" text-xs text-white line-clamp-1\">\n\t\t\t\t\t{folders[folderId].name}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</DragGhost>\n{/if}\n\n<div bind:this={folderElement} class=\"relative {className}\" draggable=\"true\">\n\t{#if draggedOver}\n\t\t<div\n\t\t\tclass=\"absolute top-0 left-0 w-full h-full rounded-xs bg-gray-100/50 dark:bg-gray-700/20 bg-opacity-50 dark:bg-opacity-10 z-50 pointer-events-none touch-none\"\n\t\t></div>\n\t{/if}\n\n\t<Collapsible\n\t\tbind:open\n\t\tclassName=\"w-full\"\n\t\tbuttonClassName=\"w-full\"\n\t\thide={(folders[folderId]?.childrenIds ?? []).length === 0 &&\n\t\t\t(folders[folderId].items?.chats ?? []).length === 0}\n\t\tonChange={(state) => {\n\t\t\tdispatch('open', state);\n\t\t}}\n\t>\n\t\t<!-- svelte-ignore a11y-no-static-element-interactions -->\n\t\t<div class=\"w-full group\">\n\t\t\t<button\n\t\t\t\tid=\"folder-{folderId}-button\"\n\t\t\t\tclass=\"relative w-full py-1.5 px-2 rounded-md flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-500 font-medium hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\ton:dblclick={() => {\n\t\t\t\t\teditHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div class=\"text-gray-300 dark:text-gray-600\">\n\t\t\t\t\t{#if open}\n\t\t\t\t\t\t<ChevronDown className=\" size-3\" strokeWidth=\"2.5\" />\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<ChevronRight className=\" size-3\" strokeWidth=\"2.5\" />\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"translate-y-[0.5px] flex-1 justify-start text-start line-clamp-1\">\n\t\t\t\t\t{#if edit}\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid=\"folder-{folderId}-input\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tbind:value={name}\n\t\t\t\t\t\t\ton:focus={(e) => {\n\t\t\t\t\t\t\t\te.target.select();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:blur={() => {\n\t\t\t\t\t\t\t\tnameUpdateHandler();\n\t\t\t\t\t\t\t\tedit = false;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\t\t\t// Prevent accidental collapse toggling when clicking inside input\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:mousedown={(e) => {\n\t\t\t\t\t\t\t\t// Prevent accidental collapse toggling when clicking inside input\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:keydown={(e) => {\n\t\t\t\t\t\t\t\tif (e.key === 'Enter') {\n\t\t\t\t\t\t\t\t\tnameUpdateHandler();\n\t\t\t\t\t\t\t\t\tedit = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tclass=\"w-full h-full bg-transparent text-gray-500 dark:text-gray-500 outline-hidden\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t{folders[folderId].name}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t<button\n\t\t\t\t\tclass=\"absolute z-10 right-2 invisible group-hover:visible self-center flex items-center dark:text-gray-300\"\n\t\t\t\t\ton:pointerup={(e) => {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<FolderMenu\n\t\t\t\t\t\ton:rename={() => {\n\t\t\t\t\t\t\t// Requires a timeout to prevent the click event from closing the dropdown\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\teditHandler();\n\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ton:delete={() => {\n\t\t\t\t\t\t\tshowDeleteConfirm = true;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ton:export={() => {\n\t\t\t\t\t\t\texportHandler();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<button class=\"p-0.5 dark:hover:bg-gray-850 rounded-lg touch-auto\" on:click={(e) => {}}>\n\t\t\t\t\t\t\t<EllipsisHorizontal className=\"size-4\" strokeWidth=\"2.5\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</FolderMenu>\n\t\t\t\t</button>\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div slot=\"content\" class=\"w-full\">\n\t\t\t{#if (folders[folderId]?.childrenIds ?? []).length > 0 || (folders[folderId].items?.chats ?? []).length > 0}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ml-3 pl-1 mt-[1px] flex flex-col overflow-y-auto scrollbar-hidden border-s border-gray-100 dark:border-gray-900\"\n\t\t\t\t>\n\t\t\t\t\t{#if folders[folderId]?.childrenIds}\n\t\t\t\t\t\t{@const children = folders[folderId]?.childrenIds\n\t\t\t\t\t\t\t.map((id) => folders[id])\n\t\t\t\t\t\t\t.sort((a, b) =>\n\t\t\t\t\t\t\t\ta.name.localeCompare(b.name, undefined, {\n\t\t\t\t\t\t\t\t\tnumeric: true,\n\t\t\t\t\t\t\t\t\tsensitivity: 'base'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{#each children as childFolder (`${folderId}-${childFolder.id}`)}\n\t\t\t\t\t\t\t<svelte:self\n\t\t\t\t\t\t\t\t{folders}\n\t\t\t\t\t\t\t\tfolderId={childFolder.id}\n\t\t\t\t\t\t\t\tparentDragged={dragged}\n\t\t\t\t\t\t\t\ton:import={(e) => {\n\t\t\t\t\t\t\t\t\tdispatch('import', e.detail);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ton:update={(e) => {\n\t\t\t\t\t\t\t\t\tdispatch('update', e.detail);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\t\t\t\tdispatch('change', e.detail);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#if folders[folderId].items?.chats}\n\t\t\t\t\t\t{#each folders[folderId].items.chats as chat (chat.id)}\n\t\t\t\t\t\t\t<ChatItem\n\t\t\t\t\t\t\t\tid={chat.id}\n\t\t\t\t\t\t\t\ttitle={chat.title}\n\t\t\t\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\t\t\t\tdispatch('change', e.detail);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</Collapsible>\n</div>\n","<script lang=\"ts\">\n\timport { createEventDispatcher } from 'svelte';\n\n\tconst dispatch = createEventDispatcher();\n\timport RecursiveFolder from './RecursiveFolder.svelte';\n\texport let folders = {};\n\n\tlet folderList = [];\n\t// Get the list of folders that have no parent, sorted by name alphabetically\n\t$: folderList = Object.keys(folders)\n\t\t.filter((key) => folders[key].parent_id === null)\n\t\t.sort((a, b) =>\n\t\t\tfolders[a].name.localeCompare(folders[b].name, undefined, {\n\t\t\t\tnumeric: true,\n\t\t\t\tsensitivity: 'base'\n\t\t\t})\n\t\t);\n</script>\n\n{#each folderList as folderId (folderId)}\n\t<RecursiveFolder\n\t\tclassName=\"\"\n\t\t{folders}\n\t\t{folderId}\n\t\ton:import={(e) => {\n\t\t\tdispatch('import', e.detail);\n\t\t}}\n\t\ton:update={(e) => {\n\t\t\tdispatch('update', e.detail);\n\t\t}}\n\t\ton:change={(e) => {\n\t\t\tdispatch('change', e.detail);\n\t\t}}\n\t/>\n{/each}\n","<script lang=\"ts\">\n\timport { getContext, createEventDispatcher, onMount } from 'svelte';\n\timport { createNewChannel, deleteChannelById } from '$lib/apis/channels';\n\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport AccessControl from '$lib/components/workspace/common/AccessControl.svelte';\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\n\timport { toast } from 'svelte-sonner';\n\timport { page } from '$app/stores';\n\timport { goto } from '$app/navigation';\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n\texport let onSubmit: Function = () => {};\n\texport let onUpdate: Function = () => {};\n\n\texport let channel = null;\n\texport let edit = false;\n\n\tlet name = '';\n\tlet accessControl = {};\n\n\tlet loading = false;\n\n\t$: if (name) {\n\t\tname = name.replace(/\\s/g, '-').toLocaleLowerCase();\n\t}\n\n\tconst submitHandler = async () => {\n\t\tloading = true;\n\t\tawait onSubmit({\n\t\t\tname: name.replace(/\\s/g, '-'),\n\t\t\taccess_control: accessControl\n\t\t});\n\t\tshow = false;\n\t\tloading = false;\n\t};\n\n\tconst init = () => {\n\t\tname = channel.name;\n\t\taccessControl = channel.access_control;\n\t};\n\n\t$: if (channel) {\n\t\tinit();\n\t}\n\n\tlet showDeleteConfirmDialog = false;\n\n\tconst deleteHandler = async () => {\n\t\tshowDeleteConfirmDialog = false;\n\n\t\tconst res = await deleteChannelById(localStorage.token, channel.id).catch((error) => {\n\t\t\ttoast.error(error.message);\n\t\t});\n\n\t\tif (res) {\n\t\t\ttoast.success('Channel deleted successfully');\n\t\t\tonUpdate();\n\n\t\t\tif ($page.url.pathname === `/channels/${channel.id}`) {\n\t\t\t\tgoto('/');\n\t\t\t}\n\t\t}\n\n\t\tshow = false;\n\t};\n</script>\n\n<Modal size=\"sm\" bind:show>\n\t<div>\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5 pt-4 pb-1\">\n\t\t\t<div class=\" text-lg font-medium self-center\">\n\t\t\t\t{#if edit}\n\t\t\t\t\t{$i18n.t('Edit Channel')}\n\t\t\t\t{:else}\n\t\t\t\t\t{$i18n.t('Create Channel')}\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclass=\"self-center\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col md:flex-row w-full px-5 pb-4 md:space-x-4 dark:text-gray-200\">\n\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t<form\n\t\t\t\t\tclass=\"flex flex-col w-full\"\n\t\t\t\t\ton:submit|preventDefault={() => {\n\t\t\t\t\t\tsubmitHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div class=\"flex flex-col w-full mt-2\">\n\t\t\t\t\t\t<div class=\" mb-1 text-xs text-gray-500\">{$i18n.t('Channel Name')}</div>\n\n\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tclass=\"w-full text-sm bg-transparent placeholder:text-gray-300 dark:placeholder:text-gray-700 outline-hidden\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\tbind:value={name}\n\t\t\t\t\t\t\t\tplaceholder={$i18n.t('new-channel')}\n\t\t\t\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<hr class=\" border-gray-100 dark:border-gray-700/10 my-2.5 w-full\" />\n\n\t\t\t\t\t<div class=\"my-2 -mx-2\">\n\t\t\t\t\t\t<div class=\"px-3 py-2 bg-gray-50 dark:bg-gray-950 rounded-lg\">\n\t\t\t\t\t\t\t<AccessControl bind:accessControl />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex justify-end pt-3 text-sm font-medium gap-1.5\">\n\t\t\t\t\t\t{#if edit}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium dark:bg-black dark:hover:bg-black/90 dark:text-white bg-white text-black hover:bg-gray-100 transition rounded-full flex flex-row space-x-1 items-center\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tshowDeleteConfirmDialog = true;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{$i18n.t('Delete')}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-950 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full flex flex-row space-x-1 items-center {loading\n\t\t\t\t\t\t\t\t? ' cursor-not-allowed'\n\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\tdisabled={loading}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{#if edit}\n\t\t\t\t\t\t\t\t{$i18n.t('Update')}\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t{$i18n.t('Create')}\n\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t{#if loading}\n\t\t\t\t\t\t\t\t<div class=\"ml-2 self-center\">\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\tclass=\" w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t><style>\n\t\t\t\t\t\t\t\t\t\t\t.spinner_ajPY {\n\t\t\t\t\t\t\t\t\t\t\t\ttransform-origin: center;\n\t\t\t\t\t\t\t\t\t\t\t\tanimation: spinner_AtaB 0.75s infinite linear;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t@keyframes spinner_AtaB {\n\t\t\t\t\t\t\t\t\t\t\t\t100% {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttransform: rotate(360deg);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t</style><path\n\t\t\t\t\t\t\t\t\t\t\td=\"M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z\"\n\t\t\t\t\t\t\t\t\t\t\topacity=\".25\"\n\t\t\t\t\t\t\t\t\t\t/><path\n\t\t\t\t\t\t\t\t\t\t\td=\"M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"spinner_ajPY\"\n\t\t\t\t\t\t\t\t\t\t/></svg\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n\n<DeleteConfirmDialog\n\tbind:show={showDeleteConfirmDialog}\n\tmessage={$i18n.t('Are you sure you want to delete this channel?')}\n\tconfirmLabel={$i18n.t('Delete')}\n\ton:confirm={() => {\n\t\tdeleteHandler();\n\t}}\n/>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { onMount, getContext, tick, onDestroy } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport { page } from '$app/stores';\n\timport { mobile, showSidebar, user } from '$lib/stores';\n\timport { updateChannelById } from '$lib/apis/channels';\n\n\timport Cog6 from '$lib/components/icons/Cog6.svelte';\n\timport ChannelModal from './ChannelModal.svelte';\n\n\texport let onUpdate: Function = () => {};\n\n\texport let className = '';\n\texport let channel;\n\n\tlet showEditChannelModal = false;\n\n\tlet itemElement;\n</script>\n\n<ChannelModal\n\tbind:show={showEditChannelModal}\n\t{channel}\n\tedit={true}\n\t{onUpdate}\n\tonSubmit={async ({ name, access_control }) => {\n\t\tconst res = await updateChannelById(localStorage.token, channel.id, {\n\t\t\tname,\n\t\t\taccess_control\n\t\t}).catch((error) => {\n\t\t\ttoast.error(error.message);\n\t\t});\n\n\t\tif (res) {\n\t\t\ttoast.success('Channel updated successfully');\n\t\t}\n\n\t\tonUpdate();\n\t}}\n/>\n\n<div\n\tbind:this={itemElement}\n\tclass=\" w-full {className} rounded-lg flex relative group hover:bg-gray-100 dark:hover:bg-gray-900 {$page\n\t\t.url.pathname === `/channels/${channel.id}`\n\t\t? 'bg-gray-100 dark:bg-gray-900'\n\t\t: ''} px-2.5 py-1\"\n>\n\t<a\n\t\tclass=\" w-full flex justify-between\"\n\t\thref=\"/channels/{channel.id}\"\n\t\ton:click={() => {\n\t\t\tif ($mobile) {\n\t\t\t\tshowSidebar.set(false);\n\t\t\t}\n\t\t}}\n\t\tdraggable=\"false\"\n\t>\n\t\t<div class=\"flex items-center gap-1\">\n\t\t\t<svg\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\tfill=\"currentColor\"\n\t\t\t\tclass=\"size-5\"\n\t\t\t>\n\t\t\t\t<path\n\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\td=\"M7.487 2.89a.75.75 0 1 0-1.474-.28l-.455 2.388H3.61a.75.75 0 0 0 0 1.5h1.663l-.571 2.998H2.75a.75.75 0 0 0 0 1.5h1.666l-.403 2.114a.75.75 0 0 0 1.474.28l.456-2.394h2.973l-.403 2.114a.75.75 0 0 0 1.474.28l.456-2.394h1.947a.75.75 0 0 0 0-1.5h-1.661l.57-2.998h1.95a.75.75 0 0 0 0-1.5h-1.664l.402-2.108a.75.75 0 0 0-1.474-.28l-.455 2.388H7.085l.402-2.108ZM6.8 6.498l-.571 2.998h2.973l.57-2.998H6.8Z\"\n\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t/>\n\t\t\t</svg>\n\n\t\t\t<div class=\" text-left self-center overflow-hidden w-full line-clamp-1\">\n\t\t\t\t{channel.name}\n\t\t\t</div>\n\t\t</div>\n\t</a>\n\n\t{#if $user?.role === 'admin'}\n\t\t<button\n\t\t\tclass=\"absolute z-10 right-2 invisible group-hover:visible self-center flex items-center dark:text-gray-300\"\n\t\t\ton:click={(e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tshowEditChannelModal = true;\n\t\t\t}}\n\t\t>\n\t\t\t<button class=\"p-0.5 dark:hover:bg-gray-850 rounded-lg touch-auto\" on:click={(e) => {}}>\n\t\t\t\t<Cog6 className=\"size-3.5\" />\n\t\t\t</button>\n\t\t</button>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { getAllTags } from '$lib/apis/chats';\n\timport { tags } from '$lib/stores';\n\timport { getContext, createEventDispatcher, onMount, onDestroy, tick } from 'svelte';\n\timport { fade } from 'svelte/transition';\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\n\tconst dispatch = createEventDispatcher();\n\tconst i18n = getContext('i18n');\n\n\texport let placeholder = '';\n\texport let value = '';\n\texport let showClearButton = false;\n\texport let onKeydown = (e) => {};\n\n\tlet selectedIdx = 0;\n\n\tlet lastWord = '';\n\t$: lastWord = value ? value.split(' ').at(-1) : value;\n\n\tlet options = [\n\t\t{\n\t\t\tname: 'tag:',\n\t\t\tdescription: $i18n.t('search for tags')\n\t\t}\n\t];\n\tlet focused = false;\n\tlet loading = false;\n\n\tlet filteredOptions = options;\n\t$: filteredOptions = options.filter((option) => {\n\t\treturn option.name.startsWith(lastWord);\n\t});\n\n\tlet filteredTags = [];\n\t$: filteredTags = lastWord.startsWith('tag:')\n\t\t? [\n\t\t\t\t...$tags,\n\t\t\t\t{\n\t\t\t\t\tid: 'none',\n\t\t\t\t\tname: $i18n.t('Untagged')\n\t\t\t\t}\n\t\t\t].filter((tag) => {\n\t\t\t\tconst tagName = lastWord.slice(4);\n\t\t\t\tif (tagName) {\n\t\t\t\t\tconst tagId = tagName.replace(' ', '_').toLowerCase();\n\n\t\t\t\t\tif (tag.id !== tagId) {\n\t\t\t\t\t\treturn tag.id.startsWith(tagId);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t})\n\t\t: [];\n\n\tconst initTags = async () => {\n\t\tloading = true;\n\t\tawait tags.set(await getAllTags(localStorage.token));\n\t\tloading = false;\n\t};\n\n\tconst clearSearchInput = () => {\n\t\tvalue = '';\n\t\tdispatch('input');\n\t};\n\n\tconst documentClickHandler = (e) => {\n\t\tconst searchContainer = document.getElementById('search-container');\n\t\tconst chatSearch = document.getElementById('chat-search');\n\n\t\tif (!searchContainer.contains(e.target) && !chatSearch.contains(e.target)) {\n\t\t\tif (e.target.id.startsWith('search-tag-') || e.target.id.startsWith('search-option-')) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfocused = false;\n\t\t}\n\t};\n\n\tonMount(() => {\n\t\tdocument.addEventListener('click', documentClickHandler);\n\t});\n\n\tonDestroy(() => {\n\t\tdocument.removeEventListener('click', documentClickHandler);\n\t});\n</script>\n\n<div class=\"px-1 mb-1 flex justify-center space-x-2 relative z-10\" id=\"search-container\">\n\t<div class=\"flex w-full rounded-xl\" id=\"chat-search\">\n\t\t<div class=\"self-center py-2 rounded-l-xl bg-transparent dark:text-gray-300\">\n\t\t\t<svg\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\tfill=\"currentColor\"\n\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t>\n\t\t\t\t<path\n\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\td=\"M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z\"\n\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t/>\n\t\t\t</svg>\n\t\t</div>\n\n\t\t<input\n\t\t\tclass=\"w-full rounded-r-xl py-1.5 pl-2.5 text-sm bg-transparent dark:text-gray-300 outline-hidden\"\n\t\t\tplaceholder={placeholder ? placeholder : $i18n.t('Search')}\n\t\t\tbind:value\n\t\t\ton:input={() => {\n\t\t\t\tdispatch('input');\n\t\t\t}}\n\t\t\ton:focus={() => {\n\t\t\t\tfocused = true;\n\t\t\t\tinitTags();\n\t\t\t}}\n\t\t\ton:keydown={(e) => {\n\t\t\t\tif (e.key === 'Enter') {\n\t\t\t\t\tif (filteredTags.length > 0) {\n\t\t\t\t\t\tconst tagElement = document.getElementById(`search-tag-${selectedIdx}`);\n\t\t\t\t\t\ttagElement.click();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (filteredOptions.length > 0) {\n\t\t\t\t\t\tconst optionElement = document.getElementById(`search-option-${selectedIdx}`);\n\t\t\t\t\t\toptionElement.click();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (e.key === 'ArrowUp') {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tselectedIdx = Math.max(0, selectedIdx - 1);\n\t\t\t\t} else if (e.key === 'ArrowDown') {\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tif (filteredTags.length > 0) {\n\t\t\t\t\t\tselectedIdx = Math.min(selectedIdx + 1, filteredTags.length - 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectedIdx = Math.min(selectedIdx + 1, filteredOptions.length - 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// if the user types something, reset to the top selection.\n\t\t\t\t\tselectedIdx = 0;\n\t\t\t\t}\n\n\t\t\t\tif (!document.getElementById('search-options-container')) {\n\t\t\t\t\tonKeydown(e);\n\t\t\t\t}\n\t\t\t}}\n\t\t/>\n\n\t\t{#if showClearButton && value}\n\t\t\t<div class=\"self-center pl-1.5 translate-y-[0.5px] rounded-l-xl bg-transparent\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"p-0.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\ton:click={clearSearchInput}\n\t\t\t\t>\n\t\t\t\t\t<XMark className=\"size-3\" strokeWidth=\"2\" />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n\n\t{#if focused && (filteredOptions.length > 0 || filteredTags.length > 0)}\n\t\t<!-- svelte-ignore a11y-no-static-element-interactions -->\n\t\t<div\n\t\t\tclass=\"absolute top-0 mt-8 left-0 right-1 border border-gray-100 dark:border-gray-900 bg-gray-50 dark:bg-gray-950 rounded-lg z-10 shadow-lg\"\n\t\t\tid=\"search-options-container\"\n\t\t\tin:fade={{ duration: 50 }}\n\t\t\ton:mouseenter={() => {\n\t\t\t\tselectedIdx = null;\n\t\t\t}}\n\t\t\ton:mouseleave={() => {\n\t\t\t\tselectedIdx = 0;\n\t\t\t}}\n\t\t>\n\t\t\t<div class=\"px-2 py-2 text-xs group\">\n\t\t\t\t{#if filteredTags.length > 0}\n\t\t\t\t\t<div class=\"px-1 font-medium dark:text-gray-300 text-gray-700 mb-1\">Tags</div>\n\n\t\t\t\t\t<div class=\"max-h-60 overflow-auto\">\n\t\t\t\t\t\t{#each filteredTags as tag, tagIdx}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\" px-1.5 py-0.5 flex gap-1 hover:bg-gray-100 dark:hover:bg-gray-900 w-full rounded {selectedIdx ===\n\t\t\t\t\t\t\t\ttagIdx\n\t\t\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-900'\n\t\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\t\tid=\"search-tag-{tagIdx}\"\n\t\t\t\t\t\t\t\ton:click|stopPropagation={async () => {\n\t\t\t\t\t\t\t\t\tconst words = value.split(' ');\n\n\t\t\t\t\t\t\t\t\twords.pop();\n\t\t\t\t\t\t\t\t\twords.push(`tag:${tag.id} `);\n\n\t\t\t\t\t\t\t\t\tvalue = words.join(' ');\n\n\t\t\t\t\t\t\t\t\tdispatch('input');\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"dark:text-gray-300 text-gray-700 font-medium line-clamp-1 shrink-0\">\n\t\t\t\t\t\t\t\t\t{tag.name}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\" text-gray-500 line-clamp-1\">\n\t\t\t\t\t\t\t\t\t{tag.id}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t{:else if filteredOptions.length > 0}\n\t\t\t\t\t<div class=\"px-1 font-medium dark:text-gray-300 text-gray-700 mb-1\">\n\t\t\t\t\t\t{$i18n.t('Search options')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\" max-h-60 overflow-auto\">\n\t\t\t\t\t\t{#each filteredOptions as option, optionIdx}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\" px-1.5 py-0.5 flex gap-1 hover:bg-gray-100 dark:hover:bg-gray-900 w-full rounded {selectedIdx ===\n\t\t\t\t\t\t\t\toptionIdx\n\t\t\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-900'\n\t\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\t\tid=\"search-option-{optionIdx}\"\n\t\t\t\t\t\t\t\ton:click|stopPropagation={async () => {\n\t\t\t\t\t\t\t\t\tconst words = value.split(' ');\n\n\t\t\t\t\t\t\t\t\twords.pop();\n\t\t\t\t\t\t\t\t\twords.push('tag:');\n\n\t\t\t\t\t\t\t\t\tvalue = words.join(' ');\n\n\t\t\t\t\t\t\t\t\tdispatch('input');\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"dark:text-gray-300 text-gray-700 font-medium\">{option.name}</div>\n\n\t\t\t\t\t\t\t\t<div class=\" text-gray-500 line-clamp-1\">\n\t\t\t\t\t\t\t\t\t{option.description}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { getContext, onMount } from 'svelte';\n\tconst i18n = getContext('i18n');\n\n\timport Modal from '$lib/components/common/Modal.svelte';\n\timport SearchInput from './Sidebar/SearchInput.svelte';\n\timport { getChatList, getChatListBySearchText } from '$lib/apis/chats';\n\timport Spinner from '../common/Spinner.svelte';\n\n\timport dayjs from '$lib/dayjs';\n\timport calendar from 'dayjs/plugin/calendar';\n\timport Loader from '../common/Loader.svelte';\n\tdayjs.extend(calendar);\n\n\texport let show = false;\n\texport let onClose = () => {};\n\n\tlet query = '';\n\tlet page = 1;\n\n\tlet chatList = null;\n\n\tlet chatListLoading = false;\n\tlet allChatsLoaded = false;\n\n\tlet searchDebounceTimeout;\n\n\tlet selectedIdx = 0;\n\n\tconst searchHandler = async () => {\n\t\tif (searchDebounceTimeout) {\n\t\t\tclearTimeout(searchDebounceTimeout);\n\t\t}\n\n\t\tpage = 1;\n\t\tchatList = null;\n\t\tif (query === '') {\n\t\t\tchatList = await getChatList(localStorage.token, page);\n\t\t} else {\n\t\t\tsearchDebounceTimeout = setTimeout(async () => {\n\t\t\t\tchatList = await getChatListBySearchText(localStorage.token, query, page);\n\t\t\t}, 500);\n\t\t}\n\n\t\tif ((chatList ?? []).length === 0) {\n\t\t\tallChatsLoaded = true;\n\t\t} else {\n\t\t\tallChatsLoaded = false;\n\t\t}\n\t};\n\n\tconst loadMoreChats = async () => {\n\t\tchatListLoading = true;\n\t\tpage += 1;\n\n\t\tlet newChatList = [];\n\n\t\tif (query) {\n\t\t\tnewChatList = await getChatListBySearchText(localStorage.token, query, page);\n\t\t} else {\n\t\t\tnewChatList = await getChatList(localStorage.token, page);\n\t\t}\n\n\t\t// once the bottom of the list has been reached (no results) there is no need to continue querying\n\t\tallChatsLoaded = newChatList.length === 0;\n\n\t\tif (newChatList.length > 0) {\n\t\t\tchatList = [...chatList, ...newChatList];\n\t\t}\n\n\t\tchatListLoading = false;\n\t};\n\n\tconst init = () => {\n\t\tsearchHandler();\n\t};\n\n\tonMount(() => {\n\t\tinit();\n\t});\n</script>\n\n<Modal size=\"md\" bind:show>\n\t<div class=\"py-2.5 dark:text-gray-300 text-gray-700\">\n\t\t<div class=\"px-3.5 pb-1.5\">\n\t\t\t<SearchInput\n\t\t\t\tbind:value={query}\n\t\t\t\ton:input={searchHandler}\n\t\t\t\tplaceholder={$i18n.t('Search')}\n\t\t\t\tshowClearButton={true}\n\t\t\t\tonKeydown={(e) => {\n\t\t\t\t\tconsole.log('e', e);\n\n\t\t\t\t\tif (e.code === 'Enter' && (chatList ?? []).length > 0) {\n\t\t\t\t\t\tconst item = document.querySelector(`[data-arrow-selected=\"true\"]`);\n\t\t\t\t\t\tif (item) {\n\t\t\t\t\t\t\titem?.click();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tshow = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if (e.code === 'ArrowDown') {\n\t\t\t\t\t\tselectedIdx = Math.min(selectedIdx + 1, (chatList ?? []).length - 1);\n\t\t\t\t\t} else if (e.code === 'ArrowUp') {\n\t\t\t\t\t\tselectedIdx = Math.max(selectedIdx - 1, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectedIdx = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst item = document.querySelector(`[data-arrow-selected=\"true\"]`);\n\t\t\t\t\titem?.scrollIntoView({ block: 'center', inline: 'nearest', behavior: 'instant' });\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\n\t\t<!-- <hr class=\"border-gray-100 dark:border-gray-850 my-1\" /> -->\n\n\t\t<div class=\"flex flex-col overflow-y-auto h-80 scrollbar-hidden px-3 pb-1\">\n\t\t\t{#if chatList}\n\t\t\t\t{#if chatList.length === 0}\n\t\t\t\t\t<div class=\"text-xs text-gray-500 dark:text-gray-400 text-center px-5\">\n\t\t\t\t\t\t{$i18n.t('No results found')}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t{#each chatList as chat, idx (chat.id)}\n\t\t\t\t\t{#if idx === 0 || (idx > 0 && chat.time_range !== chatList[idx - 1].time_range)}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"w-full text-xs text-gray-500 dark:text-gray-500 font-medium {idx === 0\n\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t: 'pt-5'} pb-2 px-2\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{$i18n.t(chat.time_range)}\n\t\t\t\t\t\t\t<!-- localisation keys for time_range to be recognized from the i18next parser (so they don't get automatically removed):\n\t\t\t\t\t\t\t{$i18n.t('Today')}\n\t\t\t\t\t\t\t{$i18n.t('Yesterday')}\n\t\t\t\t\t\t\t{$i18n.t('Previous 7 days')}\n\t\t\t\t\t\t\t{$i18n.t('Previous 30 days')}\n\t\t\t\t\t\t\t{$i18n.t('January')}\n\t\t\t\t\t\t\t{$i18n.t('February')}\n\t\t\t\t\t\t\t{$i18n.t('March')}\n\t\t\t\t\t\t\t{$i18n.t('April')}\n\t\t\t\t\t\t\t{$i18n.t('May')}\n\t\t\t\t\t\t\t{$i18n.t('June')}\n\t\t\t\t\t\t\t{$i18n.t('July')}\n\t\t\t\t\t\t\t{$i18n.t('August')}\n\t\t\t\t\t\t\t{$i18n.t('September')}\n\t\t\t\t\t\t\t{$i18n.t('October')}\n\t\t\t\t\t\t\t{$i18n.t('November')}\n\t\t\t\t\t\t\t{$i18n.t('December')}\n\t\t\t\t\t\t\t-->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\" w-full flex justify-between items-center rounded-lg text-sm py-2 px-3 hover:bg-gray-50 dark:hover:bg-gray-850 {selectedIdx ===\n\t\t\t\t\t\tidx\n\t\t\t\t\t\t\t? 'bg-gray-50 dark:bg-gray-850'\n\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\thref=\"/c/{chat.id}\"\n\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\tdata-arrow-selected={selectedIdx === idx ? 'true' : undefined}\n\t\t\t\t\t\ton:mouseenter={() => {\n\t\t\t\t\t\t\tselectedIdx = idx;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tshow = false;\n\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\" flex-1\">\n\t\t\t\t\t\t\t<div class=\"text-ellipsis line-clamp-1 w-full\">\n\t\t\t\t\t\t\t\t{chat?.title}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\" pl-3 shrink-0 text-gray-500 dark:text-gray-400 text-xs\">\n\t\t\t\t\t\t\t{dayjs(chat?.updated_at * 1000).calendar()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t{/each}\n\n\t\t\t\t{#if !allChatsLoaded}\n\t\t\t\t\t<Loader\n\t\t\t\t\t\ton:visible={(e) => {\n\t\t\t\t\t\t\tif (!chatListLoading) {\n\t\t\t\t\t\t\t\tloadMoreChats();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2\">\n\t\t\t\t\t\t\t<Spinner className=\" size-4\" />\n\t\t\t\t\t\t\t<div class=\" \">Loading...</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Loader>\n\t\t\t\t{/if}\n\t\t\t{:else}\n\t\t\t\t<div class=\"w-full h-full flex justify-center items-center\">\n\t\t\t\t\t<Spinner />\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n</Modal>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { v4 as uuidv4 } from 'uuid';\n\n\timport { goto } from '$app/navigation';\n\timport {\n\t\tuser,\n\t\tchats,\n\t\tsettings,\n\t\tshowSettings,\n\t\tchatId,\n\t\ttags,\n\t\tshowSidebar,\n\t\tshowSearch,\n\t\tmobile,\n\t\tshowArchivedChats,\n\t\tpinnedChats,\n\t\tscrollPaginationEnabled,\n\t\tcurrentChatPage,\n\t\ttemporaryChatEnabled,\n\t\tchannels,\n\t\tsocket,\n\t\tconfig,\n\t\tisApp,\n\t\tmodels\n\t} from '$lib/stores';\n\timport { onMount, getContext, tick, onDestroy } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\timport {\n\t\tdeleteChatById,\n\t\tgetChatList,\n\t\tgetAllTags,\n\t\tgetChatListBySearchText,\n\t\tcreateNewChat,\n\t\tgetPinnedChatList,\n\t\ttoggleChatPinnedStatusById,\n\t\tgetChatPinnedStatusById,\n\t\tgetChatById,\n\t\tupdateChatFolderIdById,\n\t\timportChat\n\t} from '$lib/apis/chats';\n\timport { createNewFolder, getFolders, updateFolderParentIdById } from '$lib/apis/folders';\n\timport { WEBUI_BASE_URL } from '$lib/constants';\n\n\timport ArchivedChatsModal from './ArchivedChatsModal.svelte';\n\timport UserMenu from './Sidebar/UserMenu.svelte';\n\timport ChatItem from './Sidebar/ChatItem.svelte';\n\timport Spinner from '../common/Spinner.svelte';\n\timport Loader from '../common/Loader.svelte';\n\timport AddFilesPlaceholder from '../AddFilesPlaceholder.svelte';\n\timport Folder from '../common/Folder.svelte';\n\timport Plus from '../icons/Plus.svelte';\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport Folders from './Sidebar/Folders.svelte';\n\timport { getChannels, createNewChannel } from '$lib/apis/channels';\n\timport ChannelModal from './Sidebar/ChannelModal.svelte';\n\timport ChannelItem from './Sidebar/ChannelItem.svelte';\n\timport PencilSquare from '../icons/PencilSquare.svelte';\n\timport Home from '../icons/Home.svelte';\n\timport MagnifyingGlass from '../icons/MagnifyingGlass.svelte';\n\timport SearchModal from './SearchModal.svelte';\n\n\tconst BREAKPOINT = 768;\n\n\tlet navElement;\n\tlet shiftKey = false;\n\n\tlet selectedChatId = null;\n\tlet showDropdown = false;\n\tlet showPinnedChat = true;\n\n\tlet showCreateChannel = false;\n\n\t// Pagination variables\n\tlet chatListLoading = false;\n\tlet allChatsLoaded = false;\n\n\tlet folders = {};\n\tlet newFolderId = null;\n\n\tconst initFolders = async () => {\n\t\tconst folderList = await getFolders(localStorage.token).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn [];\n\t\t});\n\n\t\tfolders = {};\n\n\t\t// First pass: Initialize all folder entries\n\t\tfor (const folder of folderList) {\n\t\t\t// Ensure folder is added to folders with its data\n\t\t\tfolders[folder.id] = { ...(folders[folder.id] || {}), ...folder };\n\n\t\t\tif (newFolderId && folder.id === newFolderId) {\n\t\t\t\tfolders[folder.id].new = true;\n\t\t\t\tnewFolderId = null;\n\t\t\t}\n\t\t}\n\n\t\t// Second pass: Tie child folders to their parents\n\t\tfor (const folder of folderList) {\n\t\t\tif (folder.parent_id) {\n\t\t\t\t// Ensure the parent folder is initialized if it doesn't exist\n\t\t\t\tif (!folders[folder.parent_id]) {\n\t\t\t\t\tfolders[folder.parent_id] = {}; // Create a placeholder if not already present\n\t\t\t\t}\n\n\t\t\t\t// Initialize childrenIds array if it doesn't exist and add the current folder id\n\t\t\t\tfolders[folder.parent_id].childrenIds = folders[folder.parent_id].childrenIds\n\t\t\t\t\t? [...folders[folder.parent_id].childrenIds, folder.id]\n\t\t\t\t\t: [folder.id];\n\n\t\t\t\t// Sort the children by updated_at field\n\t\t\t\tfolders[folder.parent_id].childrenIds.sort((a, b) => {\n\t\t\t\t\treturn folders[b].updated_at - folders[a].updated_at;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n\tconst createFolder = async (name = 'Untitled') => {\n\t\tif (name === '') {\n\t\t\ttoast.error($i18n.t('Folder name cannot be empty.'));\n\t\t\treturn;\n\t\t}\n\n\t\tconst rootFolders = Object.values(folders).filter((folder) => folder.parent_id === null);\n\t\tif (rootFolders.find((folder) => folder.name.toLowerCase() === name.toLowerCase())) {\n\t\t\t// If a folder with the same name already exists, append a number to the name\n\t\t\tlet i = 1;\n\t\t\twhile (\n\t\t\t\trootFolders.find((folder) => folder.name.toLowerCase() === `${name} ${i}`.toLowerCase())\n\t\t\t) {\n\t\t\t\ti++;\n\t\t\t}\n\n\t\t\tname = `${name} ${i}`;\n\t\t}\n\n\t\t// Add a dummy folder to the list to show the user that the folder is being created\n\t\tconst tempId = uuidv4();\n\t\tfolders = {\n\t\t\t...folders,\n\t\t\ttempId: {\n\t\t\t\tid: tempId,\n\t\t\t\tname: name,\n\t\t\t\tcreated_at: Date.now(),\n\t\t\t\tupdated_at: Date.now()\n\t\t\t}\n\t\t};\n\n\t\tconst res = await createNewFolder(localStorage.token, name).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tnewFolderId = res.id;\n\t\t\tawait initFolders();\n\t\t}\n\t};\n\n\tconst initChannels = async () => {\n\t\tawait channels.set(await getChannels(localStorage.token));\n\t};\n\n\tconst initChatList = async () => {\n\t\t// Reset pagination variables\n\t\ttags.set(await getAllTags(localStorage.token));\n\t\tpinnedChats.set(await getPinnedChatList(localStorage.token));\n\t\tinitFolders();\n\n\t\tcurrentChatPage.set(1);\n\t\tallChatsLoaded = false;\n\n\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\n\t\t// Enable pagination\n\t\tscrollPaginationEnabled.set(true);\n\t};\n\n\tconst loadMoreChats = async () => {\n\t\tchatListLoading = true;\n\n\t\tcurrentChatPage.set($currentChatPage + 1);\n\n\t\tlet newChatList = [];\n\n\t\tnewChatList = await getChatList(localStorage.token, $currentChatPage);\n\n\t\t// once the bottom of the list has been reached (no results) there is no need to continue querying\n\t\tallChatsLoaded = newChatList.length === 0;\n\t\tawait chats.set([...($chats ? $chats : []), ...newChatList]);\n\n\t\tchatListLoading = false;\n\t};\n\n\tconst importChatHandler = async (items, pinned = false, folderId = null) => {\n\t\tconsole.log('importChatHandler', items, pinned, folderId);\n\t\tfor (const item of items) {\n\t\t\tconsole.log(item);\n\t\t\tif (item.chat) {\n\t\t\t\tawait importChat(localStorage.token, item.chat, item?.meta ?? {}, pinned, folderId);\n\t\t\t}\n\t\t}\n\n\t\tinitChatList();\n\t};\n\n\tconst inputFilesHandler = async (files) => {\n\t\tconsole.log(files);\n\n\t\tfor (const file of files) {\n\t\t\tconst reader = new FileReader();\n\t\t\treader.onload = async (e) => {\n\t\t\t\tconst content = e.target.result;\n\n\t\t\t\ttry {\n\t\t\t\t\tconst chatItems = JSON.parse(content);\n\t\t\t\t\timportChatHandler(chatItems);\n\t\t\t\t} catch {\n\t\t\t\t\ttoast.error($i18n.t(`Invalid file format.`));\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treader.readAsText(file);\n\t\t}\n\t};\n\n\tconst tagEventHandler = async (type, tagName, chatId) => {\n\t\tconsole.log(type, tagName, chatId);\n\t\tif (type === 'delete') {\n\t\t\tinitChatList();\n\t\t} else if (type === 'add') {\n\t\t\tinitChatList();\n\t\t}\n\t};\n\n\tlet draggedOver = false;\n\n\tconst onDragOver = (e) => {\n\t\te.preventDefault();\n\n\t\t// Check if a file is being draggedOver.\n\t\tif (e.dataTransfer?.types?.includes('Files')) {\n\t\t\tdraggedOver = true;\n\t\t} else {\n\t\t\tdraggedOver = false;\n\t\t}\n\t};\n\n\tconst onDragLeave = () => {\n\t\tdraggedOver = false;\n\t};\n\n\tconst onDrop = async (e) => {\n\t\te.preventDefault();\n\t\tconsole.log(e); // Log the drop event\n\n\t\t// Perform file drop check and handle it accordingly\n\t\tif (e.dataTransfer?.files) {\n\t\t\tconst inputFiles = Array.from(e.dataTransfer?.files);\n\n\t\t\tif (inputFiles && inputFiles.length > 0) {\n\t\t\t\tconsole.log(inputFiles); // Log the dropped files\n\t\t\t\tinputFilesHandler(inputFiles); // Handle the dropped files\n\t\t\t}\n\t\t}\n\n\t\tdraggedOver = false; // Reset draggedOver status after drop\n\t};\n\n\tlet touchstart;\n\tlet touchend;\n\n\tfunction checkDirection() {\n\t\tconst screenWidth = window.innerWidth;\n\t\tconst swipeDistance = Math.abs(touchend.screenX - touchstart.screenX);\n\t\tif (touchstart.clientX < 40 && swipeDistance >= screenWidth / 8) {\n\t\t\tif (touchend.screenX < touchstart.screenX) {\n\t\t\t\tshowSidebar.set(false);\n\t\t\t}\n\t\t\tif (touchend.screenX > touchstart.screenX) {\n\t\t\t\tshowSidebar.set(true);\n\t\t\t}\n\t\t}\n\t}\n\n\tconst onTouchStart = (e) => {\n\t\ttouchstart = e.changedTouches[0];\n\t\tconsole.log(touchstart.clientX);\n\t};\n\n\tconst onTouchEnd = (e) => {\n\t\ttouchend = e.changedTouches[0];\n\t\tcheckDirection();\n\t};\n\n\tconst onKeyDown = (e) => {\n\t\tif (e.key === 'Shift') {\n\t\t\tshiftKey = true;\n\t\t}\n\t};\n\n\tconst onKeyUp = (e) => {\n\t\tif (e.key === 'Shift') {\n\t\t\tshiftKey = false;\n\t\t}\n\t};\n\n\tconst onFocus = () => {};\n\n\tconst onBlur = () => {\n\t\tshiftKey = false;\n\t\tselectedChatId = null;\n\t};\n\n\tonMount(async () => {\n\t\tshowPinnedChat = localStorage?.showPinnedChat ? localStorage.showPinnedChat === 'true' : true;\n\n\t\tmobile.subscribe((value) => {\n\t\t\tif ($showSidebar && value) {\n\t\t\t\tshowSidebar.set(false);\n\t\t\t}\n\n\t\t\tif ($showSidebar && !value) {\n\t\t\t\tconst navElement = document.getElementsByTagName('nav')[0];\n\t\t\t\tif (navElement) {\n\t\t\t\t\tnavElement.style['-webkit-app-region'] = 'drag';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!$showSidebar && !value) {\n\t\t\t\tshowSidebar.set(true);\n\t\t\t}\n\t\t});\n\n\t\tshowSidebar.set(!$mobile ? localStorage.sidebar === 'true' : false);\n\t\tshowSidebar.subscribe((value) => {\n\t\t\tlocalStorage.sidebar = value;\n\n\t\t\t// nav element is not available on the first render\n\t\t\tconst navElement = document.getElementsByTagName('nav')[0];\n\n\t\t\tif (navElement) {\n\t\t\t\tif ($mobile) {\n\t\t\t\t\tif (!value) {\n\t\t\t\t\t\tnavElement.style['-webkit-app-region'] = 'drag';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnavElement.style['-webkit-app-region'] = 'no-drag';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnavElement.style['-webkit-app-region'] = 'drag';\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tawait initChannels();\n\t\tawait initChatList();\n\n\t\twindow.addEventListener('keydown', onKeyDown);\n\t\twindow.addEventListener('keyup', onKeyUp);\n\n\t\twindow.addEventListener('touchstart', onTouchStart);\n\t\twindow.addEventListener('touchend', onTouchEnd);\n\n\t\twindow.addEventListener('focus', onFocus);\n\t\twindow.addEventListener('blur', onBlur);\n\n\t\tconst dropZone = document.getElementById('sidebar');\n\n\t\tdropZone?.addEventListener('dragover', onDragOver);\n\t\tdropZone?.addEventListener('drop', onDrop);\n\t\tdropZone?.addEventListener('dragleave', onDragLeave);\n\t});\n\n\tonDestroy(() => {\n\t\twindow.removeEventListener('keydown', onKeyDown);\n\t\twindow.removeEventListener('keyup', onKeyUp);\n\n\t\twindow.removeEventListener('touchstart', onTouchStart);\n\t\twindow.removeEventListener('touchend', onTouchEnd);\n\n\t\twindow.removeEventListener('focus', onFocus);\n\t\twindow.removeEventListener('blur', onBlur);\n\n\t\tconst dropZone = document.getElementById('sidebar');\n\n\t\tdropZone?.removeEventListener('dragover', onDragOver);\n\t\tdropZone?.removeEventListener('drop', onDrop);\n\t\tdropZone?.removeEventListener('dragleave', onDragLeave);\n\t});\n</script>\n\n<ArchivedChatsModal\n\tbind:show={$showArchivedChats}\n\tonUpdate={async () => {\n\t\tawait initChatList();\n\t}}\n/>\n\n<ChannelModal\n\tbind:show={showCreateChannel}\n\tonSubmit={async ({ name, access_control }) => {\n\t\tconst res = await createNewChannel(localStorage.token, {\n\t\t\tname: name,\n\t\t\taccess_control: access_control\n\t\t}).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\t$socket.emit('join-channels', { auth: { token: $user?.token } });\n\t\t\tawait initChannels();\n\t\t\tshowCreateChannel = false;\n\t\t}\n\t}}\n/>\n\n<!-- svelte-ignore a11y-no-static-element-interactions -->\n\n{#if $showSidebar}\n\t<div\n\t\tclass=\" {$isApp\n\t\t\t? ' ml-[4.5rem] md:ml-0'\n\t\t\t: ''} fixed md:hidden z-40 top-0 right-0 left-0 bottom-0 bg-black/60 w-full min-h-screen h-screen flex justify-center overflow-hidden overscroll-contain\"\n\t\ton:mousedown={() => {\n\t\t\tshowSidebar.set(!$showSidebar);\n\t\t}}\n\t/>\n{/if}\n\n<SearchModal\n\tbind:show={$showSearch}\n\tonClose={() => {\n\t\tif ($mobile) {\n\t\t\tshowSidebar.set(false);\n\t\t}\n\t}}\n/>\n\n<div\n\tbind:this={navElement}\n\tid=\"sidebar\"\n\tclass=\"h-screen max-h-[100dvh] min-h-screen select-none {$showSidebar\n\t\t? 'md:relative w-[260px] max-w-[260px]'\n\t\t: '-translate-x-[260px] w-[0px]'} {$isApp\n\t\t? `ml-[4.5rem] md:ml-0 `\n\t\t: 'transition-width duration-200 ease-in-out'}  shrink-0 bg-gray-50 text-gray-900 dark:bg-gray-950 dark:text-gray-200 text-sm fixed z-50 top-0 left-0 overflow-x-hidden\n        \"\n\tdata-state={$showSidebar}\n>\n\t<div\n\t\tclass=\"py-2 my-auto flex flex-col justify-between h-screen max-h-[100dvh] w-[260px] overflow-x-hidden z-50 {$showSidebar\n\t\t\t? ''\n\t\t\t: 'invisible'}\"\n\t>\n\t\t<div class=\"px-1.5 flex justify-between space-x-1 text-gray-600 dark:text-gray-400\">\n\t\t\t<button\n\t\t\t\tclass=\" cursor-pointer p-[7px] flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshowSidebar.set(!$showSidebar);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div class=\" m-auto self-center\">\n\t\t\t\t\t<svg\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\td=\"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t</button>\n\n\t\t\t<a\n\t\t\t\tid=\"sidebar-new-chat-button\"\n\t\t\t\tclass=\"flex justify-between items-center flex-1 rounded-lg px-2 py-1 h-full text-right hover:bg-gray-100 dark:hover:bg-gray-900 transition no-drag-region\"\n\t\t\t\thref=\"/\"\n\t\t\t\tdraggable=\"false\"\n\t\t\t\ton:click={async () => {\n\t\t\t\t\tselectedChatId = null;\n\t\t\t\t\tawait goto('/');\n\t\t\t\t\tconst newChatButton = document.getElementById('new-chat-button');\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tnewChatButton?.click();\n\t\t\t\t\t\tif ($mobile) {\n\t\t\t\t\t\t\tshowSidebar.set(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 0);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div class=\"flex items-center\">\n\t\t\t\t\t<div class=\"self-center mx-1.5\">\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tcrossorigin=\"anonymous\"\n\t\t\t\t\t\t\tsrc=\"{WEBUI_BASE_URL}/static/favicon.png\"\n\t\t\t\t\t\t\tclass=\" size-5 -translate-x-1.5 rounded-full\"\n\t\t\t\t\t\t\talt=\"logo\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\" self-center font-medium text-sm text-gray-850 dark:text-white font-primary\">\n\t\t\t\t\t\t{$i18n.t('New Chat')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div>\n\t\t\t\t\t<PencilSquare className=\" size-5\" strokeWidth=\"2\" />\n\t\t\t\t</div>\n\t\t\t</a>\n\t\t</div>\n\n\t\t<!-- {#if $user?.role === 'admin'}\n\t\t\t<div class=\"px-1.5 flex justify-center text-gray-800 dark:text-gray-200\">\n\t\t\t\t<a\n\t\t\t\t\tclass=\"grow flex items-center space-x-3 rounded-lg px-2 py-[7px] hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\thref=\"/home\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tselectedChatId = null;\n\t\t\t\t\t\tchatId.set('');\n\n\t\t\t\t\t\tif ($mobile) {\n\t\t\t\t\t\t\tshowSidebar.set(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"self-center\">\n\t\t\t\t\t\t<Home strokeWidth=\"2\" className=\"size-[1.1rem]\" />\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex self-center translate-y-[0.5px]\">\n\t\t\t\t\t\t<div class=\" self-center font-medium text-sm font-primary\">{$i18n.t('Home')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t{/if} -->\n\n\t\t<div class=\"px-1.5 flex justify-center text-gray-800 dark:text-gray-200\">\n\t\t\t<button\n\t\t\t\tclass=\"grow flex items-center space-x-3 rounded-lg px-2 py-[7px] hover:bg-gray-100 dark:hover:bg-gray-900 transition outline-none\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshowSearch.set(true);\n\t\t\t\t}}\n\t\t\t\tdraggable=\"false\"\n\t\t\t>\n\t\t\t\t<div class=\"self-center\">\n\t\t\t\t\t<MagnifyingGlass strokeWidth=\"2\" className=\"size-[1.1rem]\" />\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"flex self-center translate-y-[0.5px]\">\n\t\t\t\t\t<div class=\" self-center font-medium text-sm font-primary\">{$i18n.t('Search')}</div>\n\t\t\t\t</div>\n\t\t\t</button>\n\t\t</div>\n\n\t\t{#if ($config?.features?.enable_notes ?? false) && ($user?.role === 'admin' || ($user?.permissions?.features?.notes ?? true))}\n\t\t\t<div class=\"px-1.5 flex justify-center text-gray-800 dark:text-gray-200\">\n\t\t\t\t<a\n\t\t\t\t\tclass=\"grow flex items-center space-x-3 rounded-lg px-2 py-[7px] hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\thref=\"/notes\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tselectedChatId = null;\n\t\t\t\t\t\tchatId.set('');\n\n\t\t\t\t\t\tif ($mobile) {\n\t\t\t\t\t\t\tshowSidebar.set(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"self-center\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\twidth=\"24\"\n\t\t\t\t\t\t\theight=\"24\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\td=\"M10 3v4a1 1 0 0 1-1 1H5m4 8h6m-6-4h6m4-8v16a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V7.914a1 1 0 0 1 .293-.707l3.914-3.914A1 1 0 0 1 9.914 3H18a1 1 0 0 1 1 1Z\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex self-center translate-y-[0.5px]\">\n\t\t\t\t\t\t<div class=\" self-center font-medium text-sm font-primary\">{$i18n.t('Notes')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t{#if $user?.role === 'admin' || $user?.permissions?.workspace?.models || $user?.permissions?.workspace?.knowledge || $user?.permissions?.workspace?.prompts || $user?.permissions?.workspace?.tools}\n\t\t\t<div class=\"px-1.5 flex justify-center text-gray-800 dark:text-gray-200\">\n\t\t\t\t<a\n\t\t\t\t\tclass=\"grow flex items-center space-x-3 rounded-lg px-2 py-[7px] hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\thref=\"/workspace\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tselectedChatId = null;\n\t\t\t\t\t\tchatId.set('');\n\n\t\t\t\t\t\tif ($mobile) {\n\t\t\t\t\t\t\tshowSidebar.set(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"self-center\">\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"size-[1.1rem]\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\td=\"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 0 0 2.25-2.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v2.25A2.25 2.25 0 0 0 6 10.5Zm0 9.75h2.25A2.25 2.25 0 0 0 10.5 18v-2.25a2.25 2.25 0 0 0-2.25-2.25H6a2.25 2.25 0 0 0-2.25 2.25V18A2.25 2.25 0 0 0 6 20.25Zm9.75-9.75H18a2.25 2.25 0 0 0 2.25-2.25V6A2.25 2.25 0 0 0 18 3.75h-2.25A2.25 2.25 0 0 0 13.5 6v2.25a2.25 2.25 0 0 0 2.25 2.25Z\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex self-center translate-y-[0.5px]\">\n\t\t\t\t\t\t<div class=\" self-center font-medium text-sm font-primary\">{$i18n.t('Workspace')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t{/if}\n\n\t\t<div\n\t\t\tclass=\"relative flex flex-col flex-1 overflow-y-auto overflow-x-hidden {$temporaryChatEnabled\n\t\t\t\t? 'opacity-20'\n\t\t\t\t: ''}\"\n\t\t>\n\t\t\t{#if ($models ?? []).length > 0 && ($settings?.pinnedModels ?? []).length > 0}\n\t\t\t\t<div class=\"mt-0.5\">\n\t\t\t\t\t{#each $settings.pinnedModels as modelId (modelId)}\n\t\t\t\t\t\t{@const model = $models.find((model) => model.id === modelId)}\n\t\t\t\t\t\t{#if model}\n\t\t\t\t\t\t\t<div class=\"px-1.5 flex justify-center text-gray-800 dark:text-gray-200\">\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\tclass=\"grow flex items-center space-x-2.5 rounded-lg px-2 py-[7px] hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\t\t\t\t\thref=\"/?model={modelId}\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tselectedChatId = null;\n\t\t\t\t\t\t\t\t\t\tchatId.set('');\n\n\t\t\t\t\t\t\t\t\t\tif ($mobile) {\n\t\t\t\t\t\t\t\t\t\t\tshowSidebar.set(false);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\"self-center shrink-0\">\n\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\tcrossorigin=\"anonymous\"\n\t\t\t\t\t\t\t\t\t\t\tsrc={model?.info?.meta?.profile_image_url ?? '/static/favicon.png'}\n\t\t\t\t\t\t\t\t\t\t\tclass=\" size-5 rounded-full -translate-x-[0.5px]\"\n\t\t\t\t\t\t\t\t\t\t\talt=\"logo\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div class=\"flex self-center translate-y-[0.5px]\">\n\t\t\t\t\t\t\t\t\t\t<div class=\" self-center font-medium text-sm font-primary line-clamp-1\">\n\t\t\t\t\t\t\t\t\t\t\t{model?.name ?? modelId}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t{#if $config?.features?.enable_channels && ($user?.role === 'admin' || $channels.length > 0)}\n\t\t\t\t<Folder\n\t\t\t\t\tclassName=\"px-2 mt-0.5\"\n\t\t\t\t\tname={$i18n.t('Channels')}\n\t\t\t\t\tdragAndDrop={false}\n\t\t\t\t\tonAdd={async () => {\n\t\t\t\t\t\tif ($user?.role === 'admin') {\n\t\t\t\t\t\t\tawait tick();\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tshowCreateChannel = true;\n\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tonAddLabel={$i18n.t('Create Channel')}\n\t\t\t\t>\n\t\t\t\t\t{#each $channels as channel}\n\t\t\t\t\t\t<ChannelItem\n\t\t\t\t\t\t\t{channel}\n\t\t\t\t\t\t\tonUpdate={async () => {\n\t\t\t\t\t\t\t\tawait initChannels();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t{/each}\n\t\t\t\t</Folder>\n\t\t\t{/if}\n\n\t\t\t<Folder\n\t\t\t\tclassName=\"px-2 mt-0.5\"\n\t\t\t\tname={$i18n.t('Chats')}\n\t\t\t\tonAdd={() => {\n\t\t\t\t\tcreateFolder();\n\t\t\t\t}}\n\t\t\t\tonAddLabel={$i18n.t('New Folder')}\n\t\t\t\ton:import={(e) => {\n\t\t\t\t\timportChatHandler(e.detail);\n\t\t\t\t}}\n\t\t\t\ton:drop={async (e) => {\n\t\t\t\t\tconst { type, id, item } = e.detail;\n\n\t\t\t\t\tif (type === 'chat') {\n\t\t\t\t\t\tlet chat = await getChatById(localStorage.token, id).catch((error) => {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (!chat && item) {\n\t\t\t\t\t\t\tchat = await importChat(localStorage.token, item.chat, item?.meta ?? {});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (chat) {\n\t\t\t\t\t\t\tconsole.log(chat);\n\t\t\t\t\t\t\tif (chat.folder_id) {\n\t\t\t\t\t\t\t\tconst res = await updateChatFolderIdById(localStorage.token, chat.id, null).catch(\n\t\t\t\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (chat.pinned) {\n\t\t\t\t\t\t\t\tconst res = await toggleChatPinnedStatusById(localStorage.token, chat.id);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (type === 'folder') {\n\t\t\t\t\t\tif (folders[id].parent_id === null) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst res = await updateFolderParentIdById(localStorage.token, id, null).catch(\n\t\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\tawait initFolders();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{#if $temporaryChatEnabled}\n\t\t\t\t\t<div class=\"absolute z-40 w-full h-full flex justify-center\"></div>\n\t\t\t\t{/if}\n\n\t\t\t\t{#if $pinnedChats.length > 0}\n\t\t\t\t\t<div class=\"flex flex-col space-y-1 rounded-xl\">\n\t\t\t\t\t\t<Folder\n\t\t\t\t\t\t\tclassName=\"\"\n\t\t\t\t\t\t\tbind:open={showPinnedChat}\n\t\t\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\t\t\tlocalStorage.setItem('showPinnedChat', e.detail);\n\t\t\t\t\t\t\t\tconsole.log(e.detail);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:import={(e) => {\n\t\t\t\t\t\t\t\timportChatHandler(e.detail, true);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:drop={async (e) => {\n\t\t\t\t\t\t\t\tconst { type, id, item } = e.detail;\n\n\t\t\t\t\t\t\t\tif (type === 'chat') {\n\t\t\t\t\t\t\t\t\tlet chat = await getChatById(localStorage.token, id).catch((error) => {\n\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (!chat && item) {\n\t\t\t\t\t\t\t\t\t\tchat = await importChat(localStorage.token, item.chat, item?.meta ?? {});\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (chat) {\n\t\t\t\t\t\t\t\t\t\tconsole.log(chat);\n\t\t\t\t\t\t\t\t\t\tif (chat.folder_id) {\n\t\t\t\t\t\t\t\t\t\t\tconst res = await updateChatFolderIdById(\n\t\t\t\t\t\t\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t\t\t\t\t\t\tchat.id,\n\t\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t\t\t).catch((error) => {\n\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif (!chat.pinned) {\n\t\t\t\t\t\t\t\t\t\t\tconst res = await toggleChatPinnedStatusById(localStorage.token, chat.id);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tname={$i18n.t('Pinned')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"ml-3 pl-1 mt-[1px] flex flex-col overflow-y-auto scrollbar-hidden border-s border-gray-100 dark:border-gray-900\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{#each $pinnedChats as chat, idx (`pinned-chat-${chat?.id ?? idx}`)}\n\t\t\t\t\t\t\t\t\t<ChatItem\n\t\t\t\t\t\t\t\t\t\tclassName=\"\"\n\t\t\t\t\t\t\t\t\t\tid={chat.id}\n\t\t\t\t\t\t\t\t\t\ttitle={chat.title}\n\t\t\t\t\t\t\t\t\t\t{shiftKey}\n\t\t\t\t\t\t\t\t\t\tselected={selectedChatId === chat.id}\n\t\t\t\t\t\t\t\t\t\ton:select={() => {\n\t\t\t\t\t\t\t\t\t\t\tselectedChatId = chat.id;\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ton:unselect={() => {\n\t\t\t\t\t\t\t\t\t\t\tselectedChatId = null;\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ton:change={async () => {\n\t\t\t\t\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ton:tag={(e) => {\n\t\t\t\t\t\t\t\t\t\t\tconst { type, name } = e.detail;\n\t\t\t\t\t\t\t\t\t\t\ttagEventHandler(type, name, chat.id);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Folder>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t{#if folders}\n\t\t\t\t\t<Folders\n\t\t\t\t\t\t{folders}\n\t\t\t\t\t\ton:import={(e) => {\n\t\t\t\t\t\t\tconst { folderId, items } = e.detail;\n\t\t\t\t\t\t\timportChatHandler(items, false, folderId);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ton:update={async (e) => {\n\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ton:change={async () => {\n\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{/if}\n\n\t\t\t\t<div class=\" flex-1 flex flex-col overflow-y-auto scrollbar-hidden\">\n\t\t\t\t\t<div class=\"pt-1.5\">\n\t\t\t\t\t\t{#if $chats}\n\t\t\t\t\t\t\t{#each $chats as chat, idx (`chat-${chat?.id ?? idx}`)}\n\t\t\t\t\t\t\t\t{#if idx === 0 || (idx > 0 && chat.time_range !== $chats[idx - 1].time_range)}\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"w-full pl-2.5 text-xs text-gray-500 dark:text-gray-500 font-medium {idx ===\n\t\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t\t\t: 'pt-5'} pb-1.5\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{$i18n.t(chat.time_range)}\n\t\t\t\t\t\t\t\t\t\t<!-- localisation keys for time_range to be recognized from the i18next parser (so they don't get automatically removed):\n\t\t\t\t\t\t\t{$i18n.t('Today')}\n\t\t\t\t\t\t\t{$i18n.t('Yesterday')}\n\t\t\t\t\t\t\t{$i18n.t('Previous 7 days')}\n\t\t\t\t\t\t\t{$i18n.t('Previous 30 days')}\n\t\t\t\t\t\t\t{$i18n.t('January')}\n\t\t\t\t\t\t\t{$i18n.t('February')}\n\t\t\t\t\t\t\t{$i18n.t('March')}\n\t\t\t\t\t\t\t{$i18n.t('April')}\n\t\t\t\t\t\t\t{$i18n.t('May')}\n\t\t\t\t\t\t\t{$i18n.t('June')}\n\t\t\t\t\t\t\t{$i18n.t('July')}\n\t\t\t\t\t\t\t{$i18n.t('August')}\n\t\t\t\t\t\t\t{$i18n.t('September')}\n\t\t\t\t\t\t\t{$i18n.t('October')}\n\t\t\t\t\t\t\t{$i18n.t('November')}\n\t\t\t\t\t\t\t{$i18n.t('December')}\n\t\t\t\t\t\t\t-->\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t<ChatItem\n\t\t\t\t\t\t\t\t\tclassName=\"\"\n\t\t\t\t\t\t\t\t\tid={chat.id}\n\t\t\t\t\t\t\t\t\ttitle={chat.title}\n\t\t\t\t\t\t\t\t\t{shiftKey}\n\t\t\t\t\t\t\t\t\tselected={selectedChatId === chat.id}\n\t\t\t\t\t\t\t\t\ton:select={() => {\n\t\t\t\t\t\t\t\t\t\tselectedChatId = chat.id;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ton:unselect={() => {\n\t\t\t\t\t\t\t\t\t\tselectedChatId = null;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ton:change={async () => {\n\t\t\t\t\t\t\t\t\t\tinitChatList();\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ton:tag={(e) => {\n\t\t\t\t\t\t\t\t\t\tconst { type, name } = e.detail;\n\t\t\t\t\t\t\t\t\t\ttagEventHandler(type, name, chat.id);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/each}\n\n\t\t\t\t\t\t\t{#if $scrollPaginationEnabled && !allChatsLoaded}\n\t\t\t\t\t\t\t\t<Loader\n\t\t\t\t\t\t\t\t\ton:visible={(e) => {\n\t\t\t\t\t\t\t\t\t\tif (!chatListLoading) {\n\t\t\t\t\t\t\t\t\t\t\tloadMoreChats();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Spinner className=\" size-4\" />\n\t\t\t\t\t\t\t\t\t\t<div class=\" \">Loading...</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</Loader>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<div class=\"w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2\">\n\t\t\t\t\t\t\t\t<Spinner className=\" size-4\" />\n\t\t\t\t\t\t\t\t<div class=\" \">Loading...</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Folder>\n\t\t</div>\n\n\t\t<div class=\"px-2\">\n\t\t\t<div class=\"flex flex-col font-primary\">\n\t\t\t\t{#if $user !== undefined && $user !== null}\n\t\t\t\t\t<UserMenu\n\t\t\t\t\t\trole={$user?.role}\n\t\t\t\t\t\ton:show={(e) => {\n\t\t\t\t\t\t\tif (e.detail === 'archived-chat') {\n\t\t\t\t\t\t\t\tshowArchivedChats.set(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" flex items-center rounded-xl py-2.5 px-2.5 w-full hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tshowDropdown = !showDropdown;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" self-center mr-3\">\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={$user?.profile_image_url}\n\t\t\t\t\t\t\t\t\tclass=\" max-w-[30px] object-cover rounded-full\"\n\t\t\t\t\t\t\t\t\talt=\"User profile\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\" self-center font-medium\">{$user?.name}</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</UserMenu>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n<style>\n\t.scrollbar-hidden:active::-webkit-scrollbar-thumb,\n\t.scrollbar-hidden:focus::-webkit-scrollbar-thumb,\n\t.scrollbar-hidden:hover::-webkit-scrollbar-thumb {\n\t\tvisibility: visible;\n\t}\n\t.scrollbar-hidden::-webkit-scrollbar-thumb {\n\t\tvisibility: hidden;\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { createEventDispatcher, onMount, getContext } from 'svelte';\n\timport { getLanguages, changeLanguage } from '$lib/i18n';\n\tconst dispatch = createEventDispatcher();\n\n\timport { models, settings, theme, user } from '$lib/stores';\n\n\tconst i18n = getContext('i18n');\n\n\timport AdvancedParams from './Advanced/AdvancedParams.svelte';\n\timport Textarea from '$lib/components/common/Textarea.svelte';\n\texport let saveSettings: Function;\n\texport let getModels: Function;\n\n\t// General\n\tlet themes = ['dark', 'light', 'oled-dark'];\n\tlet selectedTheme = 'system';\n\n\tlet languages: Awaited<ReturnType<typeof getLanguages>> = [];\n\tlet lang = $i18n.language;\n\tlet notificationEnabled = false;\n\tlet system = '';\n\n\tlet showAdvanced = false;\n\n\tconst toggleNotification = async () => {\n\t\tconst permission = await Notification.requestPermission();\n\n\t\tif (permission === 'granted') {\n\t\t\tnotificationEnabled = !notificationEnabled;\n\t\t\tsaveSettings({ notificationEnabled: notificationEnabled });\n\t\t} else {\n\t\t\ttoast.error(\n\t\t\t\t$i18n.t(\n\t\t\t\t\t'Response notifications cannot be activated as the website permissions have been denied. Please visit your browser settings to grant the necessary access.'\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n\n\tlet params = {\n\t\t// Advanced\n\t\tstream_response: null,\n\t\tfunction_calling: null,\n\t\tseed: null,\n\t\ttemperature: null,\n\t\treasoning_effort: null,\n\t\tlogit_bias: null,\n\t\tfrequency_penalty: null,\n\t\tpresence_penalty: null,\n\t\trepeat_penalty: null,\n\t\trepeat_last_n: null,\n\t\tmirostat: null,\n\t\tmirostat_eta: null,\n\t\tmirostat_tau: null,\n\t\ttop_k: null,\n\t\ttop_p: null,\n\t\tmin_p: null,\n\t\tstop: null,\n\t\ttfs_z: null,\n\t\tnum_ctx: null,\n\t\tnum_batch: null,\n\t\tnum_keep: null,\n\t\tmax_tokens: null,\n\t\tnum_gpu: null\n\t};\n\n\tconst saveHandler = async () => {\n\t\tsaveSettings({\n\t\t\tsystem: system !== '' ? system : undefined,\n\t\t\tparams: {\n\t\t\t\tstream_response: params.stream_response !== null ? params.stream_response : undefined,\n\t\t\t\tfunction_calling: params.function_calling !== null ? params.function_calling : undefined,\n\t\t\t\tseed: (params.seed !== null ? params.seed : undefined) ?? undefined,\n\t\t\t\tstop: params.stop ? params.stop.split(',').filter((e) => e) : undefined,\n\t\t\t\ttemperature: params.temperature !== null ? params.temperature : undefined,\n\t\t\t\treasoning_effort: params.reasoning_effort !== null ? params.reasoning_effort : undefined,\n\t\t\t\tlogit_bias: params.logit_bias !== null ? params.logit_bias : undefined,\n\t\t\t\tfrequency_penalty: params.frequency_penalty !== null ? params.frequency_penalty : undefined,\n\t\t\t\tpresence_penalty: params.frequency_penalty !== null ? params.frequency_penalty : undefined,\n\t\t\t\trepeat_penalty: params.frequency_penalty !== null ? params.frequency_penalty : undefined,\n\t\t\t\trepeat_last_n: params.repeat_last_n !== null ? params.repeat_last_n : undefined,\n\t\t\t\tmirostat: params.mirostat !== null ? params.mirostat : undefined,\n\t\t\t\tmirostat_eta: params.mirostat_eta !== null ? params.mirostat_eta : undefined,\n\t\t\t\tmirostat_tau: params.mirostat_tau !== null ? params.mirostat_tau : undefined,\n\t\t\t\ttop_k: params.top_k !== null ? params.top_k : undefined,\n\t\t\t\ttop_p: params.top_p !== null ? params.top_p : undefined,\n\t\t\t\tmin_p: params.min_p !== null ? params.min_p : undefined,\n\t\t\t\ttfs_z: params.tfs_z !== null ? params.tfs_z : undefined,\n\t\t\t\tnum_ctx: params.num_ctx !== null ? params.num_ctx : undefined,\n\t\t\t\tnum_batch: params.num_batch !== null ? params.num_batch : undefined,\n\t\t\t\tnum_keep: params.num_keep !== null ? params.num_keep : undefined,\n\t\t\t\tmax_tokens: params.max_tokens !== null ? params.max_tokens : undefined,\n\t\t\t\tuse_mmap: params.use_mmap !== null ? params.use_mmap : undefined,\n\t\t\t\tuse_mlock: params.use_mlock !== null ? params.use_mlock : undefined,\n\t\t\t\tnum_thread: params.num_thread !== null ? params.num_thread : undefined,\n\t\t\t\tnum_gpu: params.num_gpu !== null ? params.num_gpu : undefined,\n\t\t\t\tthink: params.think !== null ? params.think : undefined,\n\t\t\t\tkeep_alive: params.keep_alive !== null ? params.keep_alive : undefined,\n\t\t\t\tformat: params.format !== null ? params.format : undefined\n\t\t\t}\n\t\t});\n\t\tdispatch('save');\n\t};\n\n\tonMount(async () => {\n\t\tselectedTheme = localStorage.theme ?? 'system';\n\n\t\tlanguages = await getLanguages();\n\n\t\tnotificationEnabled = $settings.notificationEnabled ?? false;\n\t\tsystem = $settings.system ?? '';\n\n\t\tparams = { ...params, ...$settings.params };\n\t\tparams.stop = $settings?.params?.stop ? ($settings?.params?.stop ?? []).join(',') : null;\n\t});\n\n\tconst applyTheme = (_theme: string) => {\n\t\tlet themeToApply = _theme === 'oled-dark' ? 'dark' : _theme;\n\n\t\tif (_theme === 'system') {\n\t\t\tthemeToApply = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n\t\t}\n\n\t\tif (themeToApply === 'dark' && !_theme.includes('oled')) {\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-800', '#333');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-850', '#262626');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-900', '#171717');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-950', '#0d0d0d');\n\t\t}\n\n\t\tthemes\n\t\t\t.filter((e) => e !== themeToApply)\n\t\t\t.forEach((e) => {\n\t\t\t\te.split(' ').forEach((e) => {\n\t\t\t\t\tdocument.documentElement.classList.remove(e);\n\t\t\t\t});\n\t\t\t});\n\n\t\tthemeToApply.split(' ').forEach((e) => {\n\t\t\tdocument.documentElement.classList.add(e);\n\t\t});\n\n\t\tconst metaThemeColor = document.querySelector('meta[name=\"theme-color\"]');\n\t\tif (metaThemeColor) {\n\t\t\tif (_theme.includes('system')) {\n\t\t\t\tconst systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches\n\t\t\t\t\t? 'dark'\n\t\t\t\t\t: 'light';\n\t\t\t\tconsole.log('Setting system meta theme color: ' + systemTheme);\n\t\t\t\tmetaThemeColor.setAttribute('content', systemTheme === 'light' ? '#ffffff' : '#171717');\n\t\t\t} else {\n\t\t\t\tconsole.log('Setting meta theme color: ' + _theme);\n\t\t\t\tmetaThemeColor.setAttribute(\n\t\t\t\t\t'content',\n\t\t\t\t\t_theme === 'dark'\n\t\t\t\t\t\t? '#171717'\n\t\t\t\t\t\t: _theme === 'oled-dark'\n\t\t\t\t\t\t\t? '#000000'\n\t\t\t\t\t\t\t: _theme === 'her'\n\t\t\t\t\t\t\t\t? '#983724'\n\t\t\t\t\t\t\t\t: '#ffffff'\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof window !== 'undefined' && window.applyTheme) {\n\t\t\twindow.applyTheme();\n\t\t}\n\n\t\tif (_theme.includes('oled')) {\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-800', '#101010');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-850', '#050505');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-900', '#000000');\n\t\t\tdocument.documentElement.style.setProperty('--color-gray-950', '#000000');\n\t\t\tdocument.documentElement.classList.add('dark');\n\t\t}\n\n\t\tconsole.log(_theme);\n\t};\n\n\tconst themeChangeHandler = (_theme: string) => {\n\t\ttheme.set(_theme);\n\t\tlocalStorage.setItem('theme', _theme);\n\t\tapplyTheme(_theme);\n\t};\n</script>\n\n<div class=\"flex flex-col h-full justify-between text-sm\">\n\t<div class=\"  overflow-y-scroll max-h-[28rem] lg:max-h-full\">\n\t\t<div class=\"\">\n\t\t\t<div class=\" mb-1 text-sm font-medium\">{$i18n.t('WebUI Settings')}</div>\n\n\t\t\t<div class=\"flex w-full justify-between\">\n\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Theme')}</div>\n\t\t\t\t<div class=\"flex items-center relative\">\n\t\t\t\t\t<select\n\t\t\t\t\t\tclass=\" dark:bg-gray-900 w-fit pr-8 rounded-sm py-2 px-2 text-xs bg-transparent outline-hidden text-right\"\n\t\t\t\t\t\tbind:value={selectedTheme}\n\t\t\t\t\t\tplaceholder=\"Select a theme\"\n\t\t\t\t\t\ton:change={() => themeChangeHandler(selectedTheme)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<option value=\"system\">âš™ï¸ {$i18n.t('System')}</option>\n\t\t\t\t\t\t<option value=\"dark\">ðŸŒ‘ {$i18n.t('Dark')}</option>\n\t\t\t\t\t\t<option value=\"oled-dark\">ðŸŒƒ {$i18n.t('OLED Dark')}</option>\n\t\t\t\t\t\t<option value=\"light\">â˜€ï¸ {$i18n.t('Light')}</option>\n\t\t\t\t\t\t<option value=\"her\">ðŸŒ· Her</option>\n\t\t\t\t\t\t<!-- <option value=\"rose-pine dark\">ðŸª» {$i18n.t('RosÃ© Pine')}</option>\n\t\t\t\t\t\t<option value=\"rose-pine-dawn light\">ðŸŒ· {$i18n.t('RosÃ© Pine Dawn')}</option> -->\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\" flex w-full justify-between\">\n\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Language')}</div>\n\t\t\t\t<div class=\"flex items-center relative\">\n\t\t\t\t\t<select\n\t\t\t\t\t\tclass=\" dark:bg-gray-900 w-fit pr-8 rounded-sm py-2 px-2 text-xs bg-transparent outline-hidden text-right\"\n\t\t\t\t\t\tbind:value={lang}\n\t\t\t\t\t\tplaceholder=\"Select a language\"\n\t\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\t\tchangeLanguage(lang);\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#each languages as language}\n\t\t\t\t\t\t\t<option value={language['code']}>{language['title']}</option>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{#if $i18n.language === 'en-US'}\n\t\t\t\t<div class=\"mb-2 text-xs text-gray-400 dark:text-gray-500\">\n\t\t\t\t\tCouldn't find your language?\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\" text-gray-300 font-medium underline\"\n\t\t\t\t\t\thref=\"https://github.com/open-webui/open-webui/blob/main/docs/CONTRIBUTING.md#-translations-and-internationalization\"\n\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t>\n\t\t\t\t\t\tHelp us translate Open WebUI!\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<div>\n\t\t\t\t<div class=\" py-0.5 flex w-full justify-between\">\n\t\t\t\t\t<div class=\" self-center text-xs font-medium\">{$i18n.t('Notifications')}</div>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"p-1 px-3 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\ttoggleNotification();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if notificationEnabled === true}\n\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('On')}</span>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Off')}</span>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t{#if $user?.role === 'admin' || $user?.permissions.chat?.controls}\n\t\t\t<hr class=\"border-gray-50 dark:border-gray-850 my-3\" />\n\n\t\t\t<div>\n\t\t\t\t<div class=\" my-2.5 text-sm font-medium\">{$i18n.t('System Prompt')}</div>\n\t\t\t\t<Textarea\n\t\t\t\t\tbind:value={system}\n\t\t\t\t\tclassName=\"w-full text-sm bg-white dark:text-gray-300 dark:bg-gray-900 outline-hidden resize-none\"\n\t\t\t\t\trows=\"4\"\n\t\t\t\t\tplaceholder={$i18n.t('Enter system prompt here')}\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div class=\"mt-2 space-y-3 pr-1.5\">\n\t\t\t\t<div class=\"flex justify-between items-center text-sm\">\n\t\t\t\t\t<div class=\"  font-medium\">{$i18n.t('Advanced Parameters')}</div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" text-xs font-medium text-gray-500\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tshowAdvanced = !showAdvanced;\n\t\t\t\t\t\t}}>{showAdvanced ? $i18n.t('Hide') : $i18n.t('Show')}</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\n\t\t\t\t{#if showAdvanced}\n\t\t\t\t\t<AdvancedParams admin={$user?.role === 'admin'} bind:params />\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n\n\t<div class=\"flex justify-end pt-3 text-sm font-medium\">\n\t\t<button\n\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\ton:click={() => {\n\t\t\t\tsaveHandler();\n\t\t\t}}\n\t\t>\n\t\t\t{$i18n.t('Save')}\n\t\t</button>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n</script>\n\n<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" class={className}>\n\t<path\n\t\tfill-rule=\"evenodd\"\n\t\td=\"M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z\"\n\t\tclip-rule=\"evenodd\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\timport { getContext, tick } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\timport { config, models, settings, user } from '$lib/stores';\n\timport { updateUserSettings } from '$lib/apis/users';\n\timport { getModels as _getModels } from '$lib/apis';\n\timport { goto } from '$app/navigation';\n\n\timport Modal from '../common/Modal.svelte';\n\timport Account from './Settings/Account.svelte';\n\timport About from './Settings/About.svelte';\n\timport General from './Settings/General.svelte';\n\timport Interface from './Settings/Interface.svelte';\n\timport Audio from './Settings/Audio.svelte';\n\timport Chats from './Settings/Chats.svelte';\n\timport User from '../icons/User.svelte';\n\timport Personalization from './Settings/Personalization.svelte';\n\timport Search from '../icons/Search.svelte';\n\timport XMark from '../icons/XMark.svelte';\n\timport Connections from './Settings/Connections.svelte';\n\timport Tools from './Settings/Tools.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n\n\tinterface SettingsTab {\n\t\tid: string;\n\t\ttitle: string;\n\t\tkeywords: string[];\n\t}\n\n\tconst searchData: SettingsTab[] = [\n\t\t{\n\t\t\tid: 'general',\n\t\t\ttitle: 'General',\n\t\t\tkeywords: [\n\t\t\t\t'advancedparams',\n\t\t\t\t'advancedparameters',\n\t\t\t\t'advanced params',\n\t\t\t\t'advanced parameters',\n\t\t\t\t'configuration',\n\t\t\t\t'defaultparameters',\n\t\t\t\t'default parameters',\n\t\t\t\t'defaultsettings',\n\t\t\t\t'default settings',\n\t\t\t\t'general',\n\t\t\t\t'keepalive',\n\t\t\t\t'keep alive',\n\t\t\t\t'languages',\n\t\t\t\t'notifications',\n\t\t\t\t'requestmode',\n\t\t\t\t'request mode',\n\t\t\t\t'systemparameters',\n\t\t\t\t'system parameters',\n\t\t\t\t'systemprompt',\n\t\t\t\t'system prompt',\n\t\t\t\t'systemsettings',\n\t\t\t\t'system settings',\n\t\t\t\t'theme',\n\t\t\t\t'translate',\n\t\t\t\t'webuisettings',\n\t\t\t\t'webui settings'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'interface',\n\t\t\ttitle: 'Interface',\n\t\t\tkeywords: [\n\t\t\t\t'allow user location',\n\t\t\t\t'allow voice interruption in call',\n\t\t\t\t'allowuserlocation',\n\t\t\t\t'allowvoiceinterruptionincall',\n\t\t\t\t'always collapse codeblocks',\n\t\t\t\t'always collapse code blocks',\n\t\t\t\t'always expand details',\n\t\t\t\t'always on web search',\n\t\t\t\t'always play notification sound',\n\t\t\t\t'alwayscollapsecodeblocks',\n\t\t\t\t'alwaysexpanddetails',\n\t\t\t\t'alwaysonwebsearch',\n\t\t\t\t'alwaysplaynotificationsound',\n\t\t\t\t'android',\n\t\t\t\t'auto chat tags',\n\t\t\t\t'auto copy response to clipboard',\n\t\t\t\t'auto title',\n\t\t\t\t'autochattags',\n\t\t\t\t'autocopyresponsetoclipboard',\n\t\t\t\t'autotitle',\n\t\t\t\t'beta',\n\t\t\t\t'call',\n\t\t\t\t'chat background image',\n\t\t\t\t'chat bubble ui',\n\t\t\t\t'chat direction',\n\t\t\t\t'chat tags autogen',\n\t\t\t\t'chat tags autogeneration',\n\t\t\t\t'chat ui',\n\t\t\t\t'chatbackgroundimage',\n\t\t\t\t'chatbubbleui',\n\t\t\t\t'chatdirection',\n\t\t\t\t'chat tags autogeneration',\n\t\t\t\t'chattagsautogeneration',\n\t\t\t\t'chatui',\n\t\t\t\t'copy formatted text',\n\t\t\t\t'copyformattedtext',\n\t\t\t\t'default model',\n\t\t\t\t'defaultmodel',\n\t\t\t\t'design',\n\t\t\t\t'detect artifacts automatically',\n\t\t\t\t'detectartifactsautomatically',\n\t\t\t\t'display emoji in call',\n\t\t\t\t'display username',\n\t\t\t\t'displayemojiincall',\n\t\t\t\t'displayusername',\n\t\t\t\t'enter key behavior',\n\t\t\t\t'enterkeybehavior',\n\t\t\t\t'expand mode',\n\t\t\t\t'expandmode',\n\t\t\t\t'file',\n\t\t\t\t'followup autogeneration',\n\t\t\t\t'followupautogeneration',\n\t\t\t\t'fullscreen',\n\t\t\t\t'fullwidthmode',\n\t\t\t\t'full width mode',\n\t\t\t\t'haptic feedback',\n\t\t\t\t'hapticfeedback',\n\t\t\t\t'high contrast mode',\n\t\t\t\t'highcontrastmode',\n\t\t\t\t'iframe sandbox allow forms',\n\t\t\t\t'iframe sandbox allow same origin',\n\t\t\t\t'iframesandboxallowforms',\n\t\t\t\t'iframesandboxallowsameorigin',\n\t\t\t\t'imagecompression',\n\t\t\t\t'image compression',\n\t\t\t\t'imagemaxcompressionsize',\n\t\t\t\t'image max compression size',\n\t\t\t\t'interface customization',\n\t\t\t\t'interface options',\n\t\t\t\t'interfacecustomization',\n\t\t\t\t'interfaceoptions',\n\t\t\t\t'landing page mode',\n\t\t\t\t'landingpagemode',\n\t\t\t\t'layout',\n\t\t\t\t'left to right',\n\t\t\t\t'left-to-right',\n\t\t\t\t'lefttoright',\n\t\t\t\t'ltr',\n\t\t\t\t'paste large text as file',\n\t\t\t\t'pastelargetextasfile',\n\t\t\t\t'reset background',\n\t\t\t\t'resetbackground',\n\t\t\t\t'response auto copy',\n\t\t\t\t'responseautocopy',\n\t\t\t\t'rich text input for chat',\n\t\t\t\t'richtextinputforchat',\n\t\t\t\t'right to left',\n\t\t\t\t'right-to-left',\n\t\t\t\t'righttoleft',\n\t\t\t\t'rtl',\n\t\t\t\t'scroll behavior',\n\t\t\t\t'scroll on branch change',\n\t\t\t\t'scrollbehavior',\n\t\t\t\t'scrollonbranchchange',\n\t\t\t\t'select model',\n\t\t\t\t'selectmodel',\n\t\t\t\t'settings',\n\t\t\t\t'show username',\n\t\t\t\t'showusername',\n\t\t\t\t'stream large chunks',\n\t\t\t\t'streamlargechunks',\n\t\t\t\t'stylized pdf export',\n\t\t\t\t'stylizedpdfexport',\n\t\t\t\t'title autogeneration',\n\t\t\t\t'titleautogeneration',\n\t\t\t\t'toast notifications for new updates',\n\t\t\t\t'toastnotificationsfornewupdates',\n\t\t\t\t'upload background',\n\t\t\t\t'uploadbackground',\n\t\t\t\t'user interface',\n\t\t\t\t'user location access',\n\t\t\t\t'userinterface',\n\t\t\t\t'userlocationaccess',\n\t\t\t\t'vibration',\n\t\t\t\t'voice control',\n\t\t\t\t'voicecontrol',\n\t\t\t\t'widescreen mode',\n\t\t\t\t'widescreenmode',\n\t\t\t\t'whatsnew',\n\t\t\t\t'whats new',\n\t\t\t\t'websearchinchat',\n\t\t\t\t'web search in chat'\n\t\t\t]\n\t\t},\n\t\t...($user?.role === 'admin' ||\n\t\t($user?.role === 'user' && $config?.features?.enable_direct_connections)\n\t\t\t? [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'connections',\n\t\t\t\t\t\ttitle: 'Connections',\n\t\t\t\t\t\tkeywords: [\n\t\t\t\t\t\t\t'addconnection',\n\t\t\t\t\t\t\t'add connection',\n\t\t\t\t\t\t\t'manageconnections',\n\t\t\t\t\t\t\t'manage connections',\n\t\t\t\t\t\t\t'manage direct connections',\n\t\t\t\t\t\t\t'managedirectconnections',\n\t\t\t\t\t\t\t'settings'\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t: []),\n\n\t\t...($user?.role === 'admin' ||\n\t\t($user?.role === 'user' && $user?.permissions?.features?.direct_tool_servers)\n\t\t\t? [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'tools',\n\t\t\t\t\t\ttitle: 'Tools',\n\t\t\t\t\t\tkeywords: [\n\t\t\t\t\t\t\t'addconnection',\n\t\t\t\t\t\t\t'add connection',\n\t\t\t\t\t\t\t'managetools',\n\t\t\t\t\t\t\t'manage tools',\n\t\t\t\t\t\t\t'manage tool servers',\n\t\t\t\t\t\t\t'managetoolservers',\n\t\t\t\t\t\t\t'settings'\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t: []),\n\n\t\t{\n\t\t\tid: 'personalization',\n\t\t\ttitle: 'Personalization',\n\t\t\tkeywords: [\n\t\t\t\t'account preferences',\n\t\t\t\t'account settings',\n\t\t\t\t'accountpreferences',\n\t\t\t\t'accountsettings',\n\t\t\t\t'custom settings',\n\t\t\t\t'customsettings',\n\t\t\t\t'experimental',\n\t\t\t\t'memories',\n\t\t\t\t'memory',\n\t\t\t\t'personalization',\n\t\t\t\t'personalize',\n\t\t\t\t'personal settings',\n\t\t\t\t'personalsettings',\n\t\t\t\t'profile',\n\t\t\t\t'user preferences',\n\t\t\t\t'userpreferences'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'audio',\n\t\t\ttitle: 'Audio',\n\t\t\tkeywords: [\n\t\t\t\t'audio config',\n\t\t\t\t'audio control',\n\t\t\t\t'audio features',\n\t\t\t\t'audio input',\n\t\t\t\t'audio output',\n\t\t\t\t'audio playback',\n\t\t\t\t'audio voice',\n\t\t\t\t'audioconfig',\n\t\t\t\t'audiocontrol',\n\t\t\t\t'audiofeatures',\n\t\t\t\t'audioinput',\n\t\t\t\t'audiooutput',\n\t\t\t\t'audioplayback',\n\t\t\t\t'audiovoice',\n\t\t\t\t'auto playback response',\n\t\t\t\t'autoplaybackresponse',\n\t\t\t\t'auto transcribe',\n\t\t\t\t'autotranscribe',\n\t\t\t\t'instant auto send after voice transcription',\n\t\t\t\t'instantautosendaftervoicetranscription',\n\t\t\t\t'language',\n\t\t\t\t'non local voices',\n\t\t\t\t'nonlocalvoices',\n\t\t\t\t'save settings',\n\t\t\t\t'savesettings',\n\t\t\t\t'set voice',\n\t\t\t\t'setvoice',\n\t\t\t\t'sound settings',\n\t\t\t\t'soundsettings',\n\t\t\t\t'speech config',\n\t\t\t\t'speech mode',\n\t\t\t\t'speech playback speed',\n\t\t\t\t'speech rate',\n\t\t\t\t'speech recognition',\n\t\t\t\t'speech settings',\n\t\t\t\t'speech speed',\n\t\t\t\t'speech synthesis',\n\t\t\t\t'speech to text engine',\n\t\t\t\t'speechconfig',\n\t\t\t\t'speechmode',\n\t\t\t\t'speechplaybackspeed',\n\t\t\t\t'speechrate',\n\t\t\t\t'speechrecognition',\n\t\t\t\t'speechsettings',\n\t\t\t\t'speechspeed',\n\t\t\t\t'speechsynthesis',\n\t\t\t\t'speechtotextengine',\n\t\t\t\t'speedch playback rate',\n\t\t\t\t'speedchplaybackrate',\n\t\t\t\t'stt settings',\n\t\t\t\t'sttsettings',\n\t\t\t\t'text to speech engine',\n\t\t\t\t'text to speech',\n\t\t\t\t'textospeechengine',\n\t\t\t\t'texttospeech',\n\t\t\t\t'texttospeechvoice',\n\t\t\t\t'text to speech voice',\n\t\t\t\t'voice control',\n\t\t\t\t'voice modes',\n\t\t\t\t'voice options',\n\t\t\t\t'voice playback',\n\t\t\t\t'voice recognition',\n\t\t\t\t'voice speed',\n\t\t\t\t'voicecontrol',\n\t\t\t\t'voicemodes',\n\t\t\t\t'voiceoptions',\n\t\t\t\t'voiceplayback',\n\t\t\t\t'voicerecognition',\n\t\t\t\t'voicespeed',\n\t\t\t\t'volume'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'chats',\n\t\t\ttitle: 'Chats',\n\t\t\tkeywords: [\n\t\t\t\t'archive all chats',\n\t\t\t\t'archive chats',\n\t\t\t\t'archiveallchats',\n\t\t\t\t'archivechats',\n\t\t\t\t'archived chats',\n\t\t\t\t'archivedchats',\n\t\t\t\t'chat activity',\n\t\t\t\t'chat history',\n\t\t\t\t'chat settings',\n\t\t\t\t'chatactivity',\n\t\t\t\t'chathistory',\n\t\t\t\t'chatsettings',\n\t\t\t\t'conversation activity',\n\t\t\t\t'conversation history',\n\t\t\t\t'conversationactivity',\n\t\t\t\t'conversationhistory',\n\t\t\t\t'conversations',\n\t\t\t\t'convos',\n\t\t\t\t'delete all chats',\n\t\t\t\t'delete chats',\n\t\t\t\t'deleteallchats',\n\t\t\t\t'deletechats',\n\t\t\t\t'export chats',\n\t\t\t\t'exportchats',\n\t\t\t\t'import chats',\n\t\t\t\t'importchats',\n\t\t\t\t'message activity',\n\t\t\t\t'message archive',\n\t\t\t\t'message history',\n\t\t\t\t'messagearchive',\n\t\t\t\t'messagehistory'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'account',\n\t\t\ttitle: 'Account',\n\t\t\tkeywords: [\n\t\t\t\t'account preferences',\n\t\t\t\t'account settings',\n\t\t\t\t'accountpreferences',\n\t\t\t\t'accountsettings',\n\t\t\t\t'api keys',\n\t\t\t\t'apikeys',\n\t\t\t\t'change password',\n\t\t\t\t'changepassword',\n\t\t\t\t'jwt token',\n\t\t\t\t'jwttoken',\n\t\t\t\t'login',\n\t\t\t\t'new password',\n\t\t\t\t'newpassword',\n\t\t\t\t'notification webhook url',\n\t\t\t\t'notificationwebhookurl',\n\t\t\t\t'personal settings',\n\t\t\t\t'personalsettings',\n\t\t\t\t'privacy settings',\n\t\t\t\t'privacysettings',\n\t\t\t\t'profileavatar',\n\t\t\t\t'profile avatar',\n\t\t\t\t'profile details',\n\t\t\t\t'profile image',\n\t\t\t\t'profile picture',\n\t\t\t\t'profiledetails',\n\t\t\t\t'profileimage',\n\t\t\t\t'profilepicture',\n\t\t\t\t'security settings',\n\t\t\t\t'securitysettings',\n\t\t\t\t'update account',\n\t\t\t\t'update password',\n\t\t\t\t'updateaccount',\n\t\t\t\t'updatepassword',\n\t\t\t\t'user account',\n\t\t\t\t'user data',\n\t\t\t\t'user preferences',\n\t\t\t\t'user profile',\n\t\t\t\t'useraccount',\n\t\t\t\t'userdata',\n\t\t\t\t'username',\n\t\t\t\t'userpreferences',\n\t\t\t\t'userprofile',\n\t\t\t\t'webhook url',\n\t\t\t\t'webhookurl'\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\tid: 'about',\n\t\t\ttitle: 'About',\n\t\t\tkeywords: [\n\t\t\t\t'about app',\n\t\t\t\t'about me',\n\t\t\t\t'about open webui',\n\t\t\t\t'about page',\n\t\t\t\t'about us',\n\t\t\t\t'aboutapp',\n\t\t\t\t'aboutme',\n\t\t\t\t'aboutopenwebui',\n\t\t\t\t'aboutpage',\n\t\t\t\t'aboutus',\n\t\t\t\t'check for updates',\n\t\t\t\t'checkforupdates',\n\t\t\t\t'contact',\n\t\t\t\t'copyright',\n\t\t\t\t'details',\n\t\t\t\t'discord',\n\t\t\t\t'documentation',\n\t\t\t\t'github',\n\t\t\t\t'help',\n\t\t\t\t'information',\n\t\t\t\t'license',\n\t\t\t\t'redistributions',\n\t\t\t\t'release',\n\t\t\t\t'see whats new',\n\t\t\t\t'seewhatsnew',\n\t\t\t\t'settings',\n\t\t\t\t'software info',\n\t\t\t\t'softwareinfo',\n\t\t\t\t'support',\n\t\t\t\t'terms and conditions',\n\t\t\t\t'terms of use',\n\t\t\t\t'termsandconditions',\n\t\t\t\t'termsofuse',\n\t\t\t\t'timothy jae ryang baek',\n\t\t\t\t'timothy j baek',\n\t\t\t\t'timothyjaeryangbaek',\n\t\t\t\t'timothyjbaek',\n\t\t\t\t'twitter',\n\t\t\t\t'update info',\n\t\t\t\t'updateinfo',\n\t\t\t\t'version info',\n\t\t\t\t'versioninfo'\n\t\t\t]\n\t\t}\n\t];\n\n\tlet search = '';\n\tlet visibleTabs = searchData.map((tab) => tab.id);\n\tlet searchDebounceTimeout;\n\n\tconst searchSettings = (query: string): string[] => {\n\t\tconst lowerCaseQuery = query.toLowerCase().trim();\n\t\treturn searchData\n\t\t\t.filter(\n\t\t\t\t(tab) =>\n\t\t\t\t\ttab.title.toLowerCase().includes(lowerCaseQuery) ||\n\t\t\t\t\ttab.keywords.some((keyword) => keyword.includes(lowerCaseQuery))\n\t\t\t)\n\t\t\t.map((tab) => tab.id);\n\t};\n\n\tconst searchDebounceHandler = () => {\n\t\tclearTimeout(searchDebounceTimeout);\n\t\tsearchDebounceTimeout = setTimeout(() => {\n\t\t\tvisibleTabs = searchSettings(search);\n\t\t\tif (visibleTabs.length > 0 && !visibleTabs.includes(selectedTab)) {\n\t\t\t\tselectedTab = visibleTabs[0];\n\t\t\t}\n\t\t}, 100);\n\t};\n\n\tconst saveSettings = async (updated) => {\n\t\tconsole.log(updated);\n\t\tawait settings.set({ ...$settings, ...updated });\n\t\tawait models.set(await getModels());\n\t\tawait updateUserSettings(localStorage.token, { ui: $settings });\n\t};\n\n\tconst getModels = async () => {\n\t\treturn await _getModels(\n\t\t\tlocalStorage.token,\n\t\t\t$config?.features?.enable_direct_connections && ($settings?.directConnections ?? null)\n\t\t);\n\t};\n\n\tlet selectedTab = 'general';\n\n\t// Function to handle sideways scrolling\n\tconst scrollHandler = (event) => {\n\t\tconst settingsTabsContainer = document.getElementById('settings-tabs-container');\n\t\tif (settingsTabsContainer) {\n\t\t\tevent.preventDefault(); // Prevent default vertical scrolling\n\t\t\tsettingsTabsContainer.scrollLeft += event.deltaY; // Scroll sideways\n\t\t}\n\t};\n\n\tconst addScrollListener = async () => {\n\t\tawait tick();\n\t\tconst settingsTabsContainer = document.getElementById('settings-tabs-container');\n\t\tif (settingsTabsContainer) {\n\t\t\tsettingsTabsContainer.addEventListener('wheel', scrollHandler);\n\t\t}\n\t};\n\n\tconst removeScrollListener = async () => {\n\t\tawait tick();\n\t\tconst settingsTabsContainer = document.getElementById('settings-tabs-container');\n\t\tif (settingsTabsContainer) {\n\t\t\tsettingsTabsContainer.removeEventListener('wheel', scrollHandler);\n\t\t}\n\t};\n\n\t$: if (show) {\n\t\taddScrollListener();\n\t} else {\n\t\tremoveScrollListener();\n\t}\n</script>\n\n<Modal size=\"xl\" bind:show>\n\t<div class=\"text-gray-700 dark:text-gray-100\">\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5 pt-4 pb-1\">\n\t\t\t<div class=\" text-lg font-medium self-center\">{$i18n.t('Settings')}</div>\n\t\t\t<button\n\t\t\t\taria-label={$i18n.t('Close settings modal')}\n\t\t\t\tclass=\"self-center\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<XMark className=\"w-5 h-5\"></XMark>\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col md:flex-row w-full px-4 pt-1 pb-4 md:space-x-4\">\n\t\t\t<div\n\t\t\t\tid=\"settings-tabs-container\"\n\t\t\t\tclass=\"tabs flex flex-row overflow-x-auto gap-2.5 md:gap-1 md:flex-col flex-1 md:flex-none md:w-40 md:min-h-[32rem] md:max-h-[32rem] dark:text-gray-200 text-sm font-medium text-left mb-1 md:mb-0 -translate-y-1\"\n\t\t\t>\n\t\t\t\t<div class=\"hidden md:flex w-full rounded-xl -mb-1 px-0.5 gap-2\" id=\"settings-search\">\n\t\t\t\t\t<div class=\"self-center rounded-l-xl bg-transparent\">\n\t\t\t\t\t\t<Search\n\t\t\t\t\t\t\tclassName=\"size-3.5\"\n\t\t\t\t\t\t\tstrokeWidth={($settings?.highContrastMode ?? false) ? '3' : '1.5'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<label class=\"sr-only\" for=\"search-input-settings-modal\">{$i18n.t('Search')}</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclass={`w-full py-1.5 text-sm bg-transparent dark:text-gray-300 outline-hidden\n\t\t\t\t\t\t\t\t${($settings?.highContrastMode ?? false) ? 'placeholder-gray-800' : ''}`}\n\t\t\t\t\t\tbind:value={search}\n\t\t\t\t\t\tid=\"search-input-settings-modal\"\n\t\t\t\t\t\ton:input={searchDebounceHandler}\n\t\t\t\t\t\tplaceholder={$i18n.t('Search')}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t{#if visibleTabs.length > 0}\n\t\t\t\t\t{#each visibleTabs as tabId (tabId)}\n\t\t\t\t\t\t{#if tabId === 'general'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass={`px-0.5 py-1 min-w-fit rounded-lg flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'general'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'general';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\td=\"M8.34 1.804A1 1 0 019.32 1h1.36a1 1 0 01.98.804l.295 1.473c.497.144.971.342 1.416.587l1.25-.834a1 1 0 011.262.125l.962.962a1 1 0 01.125 1.262l-.834 1.25c.245.445.443.919.587 1.416l1.473.294a1 1 0 01.804.98v1.361a1 1 0 01-.804.98l-1.473.295a6.95 6.95 0 01-.587 1.416l.834 1.25a1 1 0 01-.125 1.262l-.962.962a1 1 0 01-1.262.125l-1.25-.834a6.953 6.953 0 01-1.416.587l-.294 1.473a1 1 0 01-.98.804H9.32a1 1 0 01-.98-.804l-.295-1.473a6.957 6.957 0 01-1.416-.587l-1.25.834a1 1 0 01-1.262-.125l-.962-.962a1 1 0 01-.125-1.262l.834-1.25a6.957 6.957 0 01-.587-1.416l-1.473-.294A1 1 0 011 10.68V9.32a1 1 0 01.804-.98l1.473-.295c.144-.497.342-.971.587-1.416l-.834-1.25a1 1 0 01.125-1.262l.962-.962A1 1 0 015.38 3.03l1.25.834a6.957 6.957 0 011.416-.587l.294-1.473zM13 10a3 3 0 11-6 0 3 3 0 016 0z\"\n\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('General')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'interface'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass={`px-0.5 py-1 min-w-fit rounded-lg flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'interface'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'interface';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\td=\"M2 4.25A2.25 2.25 0 0 1 4.25 2h7.5A2.25 2.25 0 0 1 14 4.25v5.5A2.25 2.25 0 0 1 11.75 12h-1.312c.1.128.21.248.328.36a.75.75 0 0 1 .234.545v.345a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-.345a.75.75 0 0 1 .234-.545c.118-.111.228-.232.328-.36H4.25A2.25 2.25 0 0 1 2 9.75v-5.5Zm2.25-.75a.75.75 0 0 0-.75.75v4.5c0 .414.336.75.75.75h7.5a.75.75 0 0 0 .75-.75v-4.5a.75.75 0 0 0-.75-.75h-7.5Z\"\n\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Interface')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'connections'}\n\t\t\t\t\t\t\t{#if $user?.role === 'admin' || ($user?.role === 'user' && $config?.features?.enable_direct_connections)}\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass={`px-0.5 py-1 min-w-fit rounded-lg flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'connections'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tselectedTab = 'connections';\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M1 9.5A3.5 3.5 0 0 0 4.5 13H12a3 3 0 0 0 .917-5.857 2.503 2.503 0 0 0-3.198-3.019 3.5 3.5 0 0 0-6.628 2.171A3.5 3.5 0 0 0 1 9.5Z\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Connections')}</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{:else if tabId === 'tools'}\n\t\t\t\t\t\t\t{#if $user?.role === 'admin' || ($user?.role === 'user' && $user?.permissions?.features?.direct_tool_servers)}\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass={`px-0.5 py-1 min-w-fit rounded-lg flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'tools'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tselectedTab = 'tools';\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M12 6.75a5.25 5.25 0 0 1 6.775-5.025.75.75 0 0 1 .313 1.248l-3.32 3.319c.063.475.276.934.641 1.299.365.365.824.578 1.3.64l3.318-3.319a.75.75 0 0 1 1.248.313 5.25 5.25 0 0 1-5.472 6.756c-1.018-.086-1.87.1-2.309.634L7.344 21.3A3.298 3.298 0 1 1 2.7 16.657l8.684-7.151c.533-.44.72-1.291.634-2.309A5.342 5.342 0 0 1 12 6.75ZM4.117 19.125a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75h-.008a.75.75 0 0 1-.75-.75v-.008Z\"\n\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Tools')}</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{:else if tabId === 'personalization'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass={`px-0.5 py-1 min-w-fit rounded-lg flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'personalization'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'personalization';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<User />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Personalization')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'audio'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass={`px-0.5 py-1 min-w-fit rounded-lg flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'audio'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'audio';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\td=\"M7.557 2.066A.75.75 0 0 1 8 2.75v10.5a.75.75 0 0 1-1.248.56L3.59 11H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h1.59l3.162-2.81a.75.75 0 0 1 .805-.124ZM12.95 3.05a.75.75 0 1 0-1.06 1.06 5.5 5.5 0 0 1 0 7.78.75.75 0 1 0 1.06 1.06 7 7 0 0 0 0-9.9Z\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\td=\"M10.828 5.172a.75.75 0 1 0-1.06 1.06 2.5 2.5 0 0 1 0 3.536.75.75 0 1 0 1.06 1.06 4 4 0 0 0 0-5.656Z\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Audio')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'chats'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass={`px-0.5 py-1 min-w-fit rounded-lg flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'chats'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'chats';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\td=\"M8 2C4.262 2 1 4.57 1 8c0 1.86.98 3.486 2.455 4.566a3.472 3.472 0 0 1-.469 1.26.75.75 0 0 0 .713 1.14 6.961 6.961 0 0 0 3.06-1.06c.403.062.818.094 1.241.094 3.738 0 7-2.57 7-6s-3.262-6-7-6ZM5 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm7-1a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM8 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z\"\n\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Chats')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'account'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass={`px-0.5 py-1 min-w-fit rounded-lg flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'account'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'account';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\td=\"M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0Zm-5-2a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM8 9c-1.825 0-3.422.977-4.295 2.437A5.49 5.49 0 0 0 8 13.5a5.49 5.49 0 0 0 4.294-2.063A4.997 4.997 0 0 0 8 9Z\"\n\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Account')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{:else if tabId === 'about'}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass={`px-0.5 py-1 min-w-fit rounded-lg flex-1 md:flex-none flex text-left transition\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tselectedTab === 'about'\n\t\t\t\t\t\t\t\t\t\t? ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'dark:bg-gray-800 bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t: ($settings?.highContrastMode ?? false)\n\t\t\t\t\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tselectedTab = 'about';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\td=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z\"\n\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('About')}</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t{/each}\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"text-center text-gray-500 mt-4\">\n\t\t\t\t\t\t{$i18n.t('No results found')}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t{#if $user?.role === 'admin'}\n\t\t\t\t\t<a\n\t\t\t\t\t\thref=\"/admin/settings\"\n\t\t\t\t\t\tclass=\"px-0.5 py-1 min-w-fit rounded-lg flex-1 md:flex-none md:mt-auto flex text-left transition {$settings?.highContrastMode\n\t\t\t\t\t\t\t? 'hover:bg-gray-200 dark:hover:bg-gray-800'\n\t\t\t\t\t\t\t: 'text-gray-300 dark:text-gray-600 hover:text-gray-700 dark:hover:text-white'}\"\n\t\t\t\t\t\ton:click={async (e) => {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tawait goto('/admin/settings');\n\t\t\t\t\t\t\tshow = false;\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\" self-center mr-2\">\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\td=\"M4.5 3.75a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V6.75a3 3 0 0 0-3-3h-15Zm4.125 3a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Zm-3.873 8.703a4.126 4.126 0 0 1 7.746 0 .75.75 0 0 1-.351.92 7.47 7.47 0 0 1-3.522.877 7.47 7.47 0 0 1-3.522-.877.75.75 0 0 1-.351-.92ZM15 8.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15ZM14.25 12a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H15a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15Z\"\n\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\" self-center\">{$i18n.t('Admin Settings')}</div>\n\t\t\t\t\t</a>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t<div class=\"flex-1 md:min-h-[32rem] max-h-[32rem]\">\n\t\t\t\t{#if selectedTab === 'general'}\n\t\t\t\t\t<General\n\t\t\t\t\t\t{getModels}\n\t\t\t\t\t\t{saveSettings}\n\t\t\t\t\t\ton:save={() => {\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'interface'}\n\t\t\t\t\t<Interface\n\t\t\t\t\t\t{saveSettings}\n\t\t\t\t\t\ton:save={() => {\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'connections'}\n\t\t\t\t\t<Connections\n\t\t\t\t\t\tsaveSettings={async (updated) => {\n\t\t\t\t\t\t\tawait saveSettings(updated);\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'tools'}\n\t\t\t\t\t<Tools\n\t\t\t\t\t\tsaveSettings={async (updated) => {\n\t\t\t\t\t\t\tawait saveSettings(updated);\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'personalization'}\n\t\t\t\t\t<Personalization\n\t\t\t\t\t\t{saveSettings}\n\t\t\t\t\t\ton:save={() => {\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'audio'}\n\t\t\t\t\t<Audio\n\t\t\t\t\t\t{saveSettings}\n\t\t\t\t\t\ton:save={() => {\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'chats'}\n\t\t\t\t\t<Chats {saveSettings} />\n\t\t\t\t{:else if selectedTab === 'account'}\n\t\t\t\t\t<Account\n\t\t\t\t\t\t{saveSettings}\n\t\t\t\t\t\tsaveHandler={() => {\n\t\t\t\t\t\t\ttoast.success($i18n.t('Settings saved successfully!'));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t{:else if selectedTab === 'about'}\n\t\t\t\t\t<About />\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n\n<style>\n\tinput::-webkit-outer-spin-button,\n\tinput::-webkit-inner-spin-button {\n\t\t/* display: none; <- Crashes Chrome on hover */\n\t\t-webkit-appearance: none;\n\t\tmargin: 0; /* <-- Apparently some margin are still there even though it's hidden */\n\t}\n\n\t.tabs::-webkit-scrollbar {\n\t\tdisplay: none; /* for Chrome, Safari and Opera */\n\t}\n\n\t.tabs {\n\t\t-ms-overflow-style: none; /* IE and Edge */\n\t\tscrollbar-width: none; /* Firefox */\n\t}\n\n\tinput[type='number'] {\n\t\tappearance: textfield;\n\t\t-moz-appearance: textfield; /* Firefox */\n\t}\n</style>\n","<script>\r\n  import { onMount } from \"svelte\"\r\n\r\n  export let size = 10\r\n  export let x = [-0.5, 0.5]\r\n  export let y = [0.25, 1]\r\n  export let duration = 2000\r\n  export let infinite = false\r\n  export let delay = [0, 50]\r\n  export let colorRange = [0, 360]\r\n  export let colorArray = []\r\n  export let amount = 50\r\n  export let iterationCount = 1\r\n  export let fallDistance = \"100px\"\r\n  export let rounded = false\r\n  export let cone = false\r\n  export let noGravity = false\r\n  export let xSpread = 0.15\r\n  export let destroyOnComplete = true\r\n\r\n  let complete = false\r\n\r\n  onMount(() => {\r\n    if (!destroyOnComplete || infinite || iterationCount == \"infinite\") return\r\n\r\n    setTimeout(() => complete = true, (duration + delay[1]) * iterationCount)\r\n  })\r\n\r\n  function randomBetween(min, max) {\r\n    return Math.random() * (max - min) + min\r\n  }\r\n\r\n  function getColor() {\r\n    if (colorArray.length) return colorArray[Math.round(Math.random() * (colorArray.length - 1))]\r\n    else return `hsl(${Math.round(randomBetween(colorRange[0], colorRange[1]))}, 75%, 50%)`\r\n  }\r\n</script>\r\n\r\n{#if !complete}\r\n  <div class=\"confetti-holder\" class:rounded class:cone class:no-gravity={noGravity}>\r\n    {#each { length: amount } as _}\r\n      <div\r\n        class=\"confetti\"\r\n        style=\"\r\n        --fall-distance: {fallDistance};\r\n        --size: {size}px;\r\n        --color: {getColor()};\r\n        --skew: {randomBetween(-45, 45)}deg,{randomBetween(-45, 45)}deg;\r\n        --rotation-xyz: {randomBetween(-10, 10)}, {randomBetween(-10, 10)}, {randomBetween(-10, 10)};\r\n        --rotation-deg: {randomBetween(0, 360)}deg;\r\n        --translate-y-multiplier: {randomBetween(y[0], y[1])};\r\n        --translate-x-multiplier: {randomBetween(x[0], x[1])};\r\n        --scale: {0.1 * randomBetween(2, 10)};\r\n        --transition-duration: {infinite ? `calc(${duration}ms * var(--scale))` : `${duration}ms`};\r\n        --transition-delay: {randomBetween(delay[0], delay[1])}ms;\r\n        --transition-iteration-count: {infinite ? 'infinite' : iterationCount};\r\n        --x-spread: {(1 - xSpread)}\" />\r\n    {/each}\r\n  </div>\r\n{/if}\r\n\r\n<style>\r\n  .confetti-holder {\r\n    position: relative;\r\n  }\r\n\r\n  @keyframes rotate {\r\n    0% {\r\n      transform: skew(var(--skew)) rotate3d(var(--full-rotation));\r\n    }\r\n\r\n    100% {\r\n      transform: skew(var(--skew)) rotate3d(var(--rotation-xyz), calc(var(--rotation-deg) + 360deg));\r\n    }\r\n  }\r\n\r\n  @keyframes translate {\r\n    0% {\r\n      opacity: 1;\r\n    }\r\n\r\n    8% {\r\n      transform: translateY(calc(var(--translate-y) * 0.95)) translateX(calc(var(--translate-x) * (var(--x-spread) * 0.9)));\r\n      opacity: 1;\r\n    }\r\n\r\n    12% {\r\n      transform: translateY(var(--translate-y)) translateX(calc(var(--translate-x) * (var(--x-spread) * 0.95)));\r\n      opacity: 1;\r\n    }\r\n\r\n    16% {\r\n      transform: translateY(var(--translate-y)) translateX(calc(var(--translate-x) * var(--x-spread)));\r\n      opacity: 1;\r\n    }\r\n\r\n    100% {\r\n      transform: translateY(calc(var(--translate-y) + var(--fall-distance))) translateX(var(--translate-x));\r\n      opacity: 0;\r\n    }\r\n  }\r\n\r\n  @keyframes no-gravity-translate {\r\n    0% {\r\n      opacity: 1;\r\n    }\r\n\r\n    100% {\r\n      transform: translateY(var(--translate-y)) translateX(var(--translate-x));\r\n      opacity: 0;\r\n    }\r\n  }\r\n\r\n  .confetti {\r\n    --translate-y: calc(-200px * var(--translate-y-multiplier));\r\n    --translate-x: calc(200px * var(--translate-x-multiplier));\r\n    position: absolute;\r\n    height: calc(var(--size) * var(--scale));\r\n    width: calc(var(--size) * var(--scale));\r\n    animation: translate var(--transition-duration) var(--transition-delay) var(--transition-iteration-count) linear;\r\n    opacity: 0;\r\n    pointer-events: none;\r\n  }\r\n\r\n  .confetti::before {\r\n    --full-rotation: var(--rotation-xyz), var(--rotation-deg);\r\n    content: '';\r\n    display: block;\r\n    width: 100%;\r\n    height: 100%;\r\n    background: var(--color);\r\n    background-size: contain;\r\n    transform: skew(var(--skew)) rotate3d(var(--full-rotation));\r\n    animation: rotate var(--transition-duration) var(--transition-delay) var(--transition-iteration-count) linear;\r\n  }\r\n\r\n  .rounded .confetti::before {\r\n    border-radius: 50%;\r\n  }\r\n\r\n  .cone .confetti {\r\n    --translate-x: calc(200px * var(--translate-y-multiplier) * var(--translate-x-multiplier));\r\n  }\r\n\r\n  .no-gravity .confetti {\r\n    animation-name: no-gravity-translate;\r\n    animation-timing-function: ease-out;\r\n  }\r\n\r\n  @media (prefers-reduced-motion) {\r\n    .confetti,\r\n    .confetti::before {\r\n      animation: none;\r\n    }\r\n  }\r\n</style>\r\n","<script lang=\"ts\">\n\timport { onMount, getContext } from 'svelte';\n\timport { Confetti } from 'svelte-confetti';\n\n\timport { WEBUI_NAME, config, settings } from '$lib/stores';\n\n\timport { WEBUI_VERSION } from '$lib/constants';\n\timport { getChangelog } from '$lib/apis';\n\n\timport Modal from './common/Modal.svelte';\n\timport { updateUserSettings } from '$lib/apis/users';\n\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n\n\tlet changelog = null;\n\n\tonMount(async () => {\n\t\tconst res = await getChangelog();\n\t\tchangelog = res;\n\t});\n</script>\n\n<Modal bind:show size=\"lg\">\n\t<div class=\"px-5 pt-4 dark:text-gray-300 text-gray-700\">\n\t\t<div class=\"flex justify-between items-start\">\n\t\t\t<div class=\"text-xl font-semibold\">\n\t\t\t\t{$i18n.t('Whatâ€™s New in')}\n\t\t\t\t{$WEBUI_NAME}\n\t\t\t\t<Confetti x={[-1, -0.25]} y={[0, 0.5]} />\n\t\t\t</div>\n\t\t\t<button\n\t\t\t\tclass=\"self-center\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tlocalStorage.version = $config.version;\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t>\n\t\t\t\t\t<p class=\"sr-only\">{$i18n.t('Close')}</p>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class=\"flex items-center mt-1\">\n\t\t\t<div class=\"text-sm dark:text-gray-200\">{$i18n.t('Release Notes')}</div>\n\t\t\t<div class=\"flex self-center w-[1px] h-6 mx-2.5 bg-gray-200 dark:bg-gray-700\" />\n\t\t\t<div class=\"text-sm dark:text-gray-200\">\n\t\t\t\tv{WEBUI_VERSION}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class=\" w-full p-4 px-5 text-gray-700 dark:text-gray-100\">\n\t\t<div class=\" overflow-y-scroll max-h-96 scrollbar-hidden\">\n\t\t\t<div class=\"mb-3\">\n\t\t\t\t{#if changelog}\n\t\t\t\t\t{#each Object.keys(changelog) as version}\n\t\t\t\t\t\t<div class=\" mb-3 pr-2\">\n\t\t\t\t\t\t\t<div class=\"font-semibold text-xl mb-1 dark:text-white\">\n\t\t\t\t\t\t\t\tv{version} - {changelog[version].date}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<hr class=\"border-gray-100 dark:border-gray-850 my-2\" />\n\n\t\t\t\t\t\t\t{#each Object.keys(changelog[version]).filter((section) => section !== 'date') as section}\n\t\t\t\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"font-semibold uppercase text-xs {section === 'added'\n\t\t\t\t\t\t\t\t\t\t\t? 'text-white bg-blue-600'\n\t\t\t\t\t\t\t\t\t\t\t: section === 'fixed'\n\t\t\t\t\t\t\t\t\t\t\t\t? 'text-white bg-green-600'\n\t\t\t\t\t\t\t\t\t\t\t\t: section === 'changed'\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'text-white bg-yellow-600'\n\t\t\t\t\t\t\t\t\t\t\t\t\t: section === 'removed'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'text-white bg-red-600'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}  w-fit px-3 rounded-full my-2.5\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{section}\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div class=\"my-2.5 px-1.5\">\n\t\t\t\t\t\t\t\t\t\t{#each Object.keys(changelog[version][section]) as item}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-sm mb-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"font-semibold uppercase\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{changelog[version][section][item].title}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"mb-2 mt-1\">{changelog[version][section][item].content}</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/each}\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"flex justify-end pt-3 text-sm font-medium\">\n\t\t\t<button\n\t\t\t\ton:click={async () => {\n\t\t\t\t\tlocalStorage.version = $config.version;\n\t\t\t\t\tawait settings.set({ ...$settings, ...{ version: $config.version } });\n\t\t\t\t\tawait updateUserSettings(localStorage.token, { ui: $settings });\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\n\t\t\t>\n\t\t\t\t<span class=\"relative\">{$i18n.t(\"Okay, Let's Go!\")}</span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</Modal>\n","<script lang=\"ts\">\n\timport { getAdminDetails } from '$lib/apis/auths';\n\timport { onMount, tick, getContext } from 'svelte';\n\timport { config } from '$lib/stores';\n\n\tconst i18n = getContext('i18n');\n\n\tlet adminDetails = null;\n\n\tonMount(async () => {\n\t\tadminDetails = await getAdminDetails(localStorage.token).catch((err) => {\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\t});\n</script>\n\n<div class=\"fixed w-full h-full flex z-999\">\n\t<div\n\t\tclass=\"absolute w-full h-full backdrop-blur-lg bg-white/10 dark:bg-gray-900/50 flex justify-center\"\n\t>\n\t\t<div class=\"m-auto pb-10 flex flex-col justify-center\">\n\t\t\t<div class=\"max-w-md\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"text-center dark:text-white text-2xl font-medium z-50\"\n\t\t\t\t\tstyle=\"white-space: pre-wrap;\"\n\t\t\t\t>\n\t\t\t\t\t{#if ($config?.ui?.pending_user_overlay_title ?? '').trim() !== ''}\n\t\t\t\t\t\t{$config.ui.pending_user_overlay_title}\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t{$i18n.t('Account Activation Pending')}<br />\n\t\t\t\t\t\t{$i18n.t('Contact Admin for WebUI Access')}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tclass=\" mt-4 text-center text-sm dark:text-gray-200 w-full\"\n\t\t\t\t\tstyle=\"white-space: pre-wrap;\"\n\t\t\t\t>\n\t\t\t\t\t{#if ($config?.ui?.pending_user_overlay_content ?? '').trim() !== ''}\n\t\t\t\t\t\t{$config.ui.pending_user_overlay_content}\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t{$i18n.t('Your account status is currently pending activation.')}{'\\n'}{$i18n.t(\n\t\t\t\t\t\t\t'To access the WebUI, please reach out to the administrator. Admins can manage user statuses from the Admin Panel.'\n\t\t\t\t\t\t)}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t{#if adminDetails}\n\t\t\t\t\t<div class=\"mt-4 text-sm font-medium text-center\">\n\t\t\t\t\t\t<div>{$i18n.t('Admin')}: {adminDetails.name} ({adminDetails.email})</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t<div class=\" mt-6 mx-auto relative group w-fit\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"relative z-20 flex px-5 py-2 rounded-full bg-white border border-gray-100 dark:border-none hover:bg-gray-100 text-gray-700 transition font-medium text-sm\"\n\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\tlocation.href = '/';\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{$i18n.t('Check Again')}\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"text-xs text-center w-full mt-2 text-gray-400 underline\"\n\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\tlocalStorage.removeItem('token');\n\t\t\t\t\t\t\tlocation.href = '/auth';\n\t\t\t\t\t\t}}>{$i18n.t('Sign Out')}</button\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { onMount, tick, getContext } from 'svelte';\n\timport { openDB, deleteDB } from 'idb';\n\timport fileSaver from 'file-saver';\n\tconst { saveAs } = fileSaver;\n\timport mermaid from 'mermaid';\n\n\timport { goto } from '$app/navigation';\n\timport { page } from '$app/stores';\n\timport { fade } from 'svelte/transition';\n\n\timport { getKnowledgeBases } from '$lib/apis/knowledge';\n\timport { getFunctions } from '$lib/apis/functions';\n\timport { getModels, getToolServersData, getVersionUpdates } from '$lib/apis';\n\timport { getAllTags } from '$lib/apis/chats';\n\timport { getPrompts } from '$lib/apis/prompts';\n\timport { getTools } from '$lib/apis/tools';\n\timport { getBanners } from '$lib/apis/configs';\n\timport { getUserSettings } from '$lib/apis/users';\n\n\timport { WEBUI_VERSION } from '$lib/constants';\n\timport { compareVersion } from '$lib/utils';\n\n\timport {\n\t\tconfig,\n\t\tuser,\n\t\tsettings,\n\t\tmodels,\n\t\tprompts,\n\t\tknowledge,\n\t\ttools,\n\t\tfunctions,\n\t\ttags,\n\t\tbanners,\n\t\tshowSettings,\n\t\tshowChangelog,\n\t\ttemporaryChatEnabled,\n\t\ttoolServers,\n\t\tshowSearch\n\t} from '$lib/stores';\n\n\timport Sidebar from '$lib/components/layout/Sidebar.svelte';\n\timport SettingsModal from '$lib/components/chat/SettingsModal.svelte';\n\timport ChangelogModal from '$lib/components/ChangelogModal.svelte';\n\timport AccountPending from '$lib/components/layout/Overlay/AccountPending.svelte';\n\timport UpdateInfoToast from '$lib/components/layout/UpdateInfoToast.svelte';\n\timport { get } from 'svelte/store';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\tlet loaded = false;\n\tlet DB = null;\n\tlet localDBChats = [];\n\n\tlet version;\n\n\tonMount(async () => {\n\t\tif ($user === undefined || $user === null) {\n\t\t\tawait goto('/auth');\n\t\t} else if (['user', 'admin'].includes($user?.role)) {\n\t\t\ttry {\n\t\t\t\t// Check if IndexedDB exists\n\t\t\t\tDB = await openDB('Chats', 1);\n\n\t\t\t\tif (DB) {\n\t\t\t\t\tconst chats = await DB.getAllFromIndex('chats', 'timestamp');\n\t\t\t\t\tlocalDBChats = chats.map((item, idx) => chats[chats.length - 1 - idx]);\n\n\t\t\t\t\tif (localDBChats.length === 0) {\n\t\t\t\t\t\tawait deleteDB('Chats');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconsole.log(DB);\n\t\t\t} catch (error) {\n\t\t\t\t// IndexedDB Not Found\n\t\t\t}\n\n\t\t\tconst chatInputKeys = Object.keys(localStorage).filter((key) =>\n\t\t\t\tkey.startsWith('chat-input-')\n\t\t\t);\n\t\t\tif (chatInputKeys.length > 0) {\n\t\t\t\tchatInputKeys.forEach((key) => {\n\t\t\t\t\tlocalStorage.removeItem(key);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst userSettings = await getUserSettings(localStorage.token).catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t\treturn null;\n\t\t\t});\n\n\t\t\tif (userSettings) {\n\t\t\t\tsettings.set(userSettings.ui);\n\t\t\t} else {\n\t\t\t\tlet localStorageSettings = {} as Parameters<(typeof settings)['set']>[0];\n\n\t\t\t\ttry {\n\t\t\t\t\tlocalStorageSettings = JSON.parse(localStorage.getItem('settings') ?? '{}');\n\t\t\t\t} catch (e: unknown) {\n\t\t\t\t\tconsole.error('Failed to parse settings from localStorage', e);\n\t\t\t\t}\n\n\t\t\t\tsettings.set(localStorageSettings);\n\t\t\t}\n\n\t\t\tmodels.set(\n\t\t\t\tawait getModels(\n\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t$config?.features?.enable_direct_connections && ($settings?.directConnections ?? null)\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tbanners.set(await getBanners(localStorage.token));\n\t\t\ttools.set(await getTools(localStorage.token));\n\t\t\ttoolServers.set(await getToolServersData($i18n, $settings?.toolServers ?? []));\n\n\t\t\tdocument.addEventListener('keydown', async function (event) {\n\t\t\t\tconst isCtrlPressed = event.ctrlKey || event.metaKey; // metaKey is for Cmd key on Mac\n\t\t\t\t// Check if the Shift key is pressed\n\t\t\t\tconst isShiftPressed = event.shiftKey;\n\n\t\t\t\t// Check if Ctrl  + K is pressed\n\t\t\t\tif (isCtrlPressed && event.key.toLowerCase() === 'k') {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tconsole.log('search');\n\t\t\t\t\tshowSearch.set(!$showSearch);\n\t\t\t\t}\n\n\t\t\t\t// Check if Ctrl + Shift + O is pressed\n\t\t\t\tif (isCtrlPressed && isShiftPressed && event.key.toLowerCase() === 'o') {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tconsole.log('newChat');\n\t\t\t\t\tdocument.getElementById('sidebar-new-chat-button')?.click();\n\t\t\t\t}\n\n\t\t\t\t// Check if Shift + Esc is pressed\n\t\t\t\tif (isShiftPressed && event.key === 'Escape') {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tconsole.log('focusInput');\n\t\t\t\t\tdocument.getElementById('chat-input')?.focus();\n\t\t\t\t}\n\n\t\t\t\t// Check if Ctrl + Shift + ; is pressed\n\t\t\t\tif (isCtrlPressed && isShiftPressed && event.key === ';') {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tconsole.log('copyLastCodeBlock');\n\t\t\t\t\tconst button = [...document.getElementsByClassName('copy-code-button')]?.at(-1);\n\t\t\t\t\tbutton?.click();\n\t\t\t\t}\n\n\t\t\t\t// Check if Ctrl + Shift + C is pressed\n\t\t\t\tif (isCtrlPressed && isShiftPressed && event.key.toLowerCase() === 'c') {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tconsole.log('copyLastResponse');\n\t\t\t\t\tconst button = [...document.getElementsByClassName('copy-response-button')]?.at(-1);\n\t\t\t\t\tconsole.log(button);\n\t\t\t\t\tbutton?.click();\n\t\t\t\t}\n\n\t\t\t\t// Check if Ctrl + Shift + S is pressed\n\t\t\t\tif (isCtrlPressed && isShiftPressed && event.key.toLowerCase() === 's') {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tconsole.log('toggleSidebar');\n\t\t\t\t\tdocument.getElementById('sidebar-toggle-button')?.click();\n\t\t\t\t}\n\n\t\t\t\t// Check if Ctrl + Shift + Backspace is pressed\n\t\t\t\tif (\n\t\t\t\t\tisCtrlPressed &&\n\t\t\t\t\tisShiftPressed &&\n\t\t\t\t\t(event.key === 'Backspace' || event.key === 'Delete')\n\t\t\t\t) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tconsole.log('deleteChat');\n\t\t\t\t\tdocument.getElementById('delete-chat-button')?.click();\n\t\t\t\t}\n\n\t\t\t\t// Check if Ctrl + . is pressed\n\t\t\t\tif (isCtrlPressed && event.key === '.') {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tconsole.log('openSettings');\n\t\t\t\t\tshowSettings.set(!$showSettings);\n\t\t\t\t}\n\n\t\t\t\t// Check if Ctrl + / is pressed\n\t\t\t\tif (isCtrlPressed && event.key === '/') {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tconsole.log('showShortcuts');\n\t\t\t\t\tdocument.getElementById('show-shortcuts-button')?.click();\n\t\t\t\t}\n\n\t\t\t\t// Check if Ctrl + Shift + ' is pressed\n\t\t\t\tif (\n\t\t\t\t\tisCtrlPressed &&\n\t\t\t\t\tisShiftPressed &&\n\t\t\t\t\t(event.key.toLowerCase() === `'` || event.key.toLowerCase() === `\"`)\n\t\t\t\t) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tconsole.log('temporaryChat');\n\t\t\t\t\ttemporaryChatEnabled.set(!$temporaryChatEnabled);\n\t\t\t\t\tawait goto('/');\n\t\t\t\t\tconst newChatButton = document.getElementById('new-chat-button');\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tnewChatButton?.click();\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif ($user?.role === 'admin' && ($settings?.showChangelog ?? true)) {\n\t\t\t\tshowChangelog.set($settings?.version !== $config.version);\n\t\t\t}\n\n\t\t\tif ($user?.role === 'admin' || ($user?.permissions?.chat?.temporary ?? true)) {\n\t\t\t\tif ($page.url.searchParams.get('temporary-chat') === 'true') {\n\t\t\t\t\ttemporaryChatEnabled.set(true);\n\t\t\t\t}\n\n\t\t\t\tif ($user?.permissions?.chat?.temporary_enforced) {\n\t\t\t\t\ttemporaryChatEnabled.set(true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Check for version updates\n\t\t\tif ($user?.role === 'admin') {\n\t\t\t\t// Check if the user has dismissed the update toast in the last 24 hours\n\t\t\t\tif (localStorage.dismissedUpdateToast) {\n\t\t\t\t\tconst dismissedUpdateToast = new Date(Number(localStorage.dismissedUpdateToast));\n\t\t\t\t\tconst now = new Date();\n\n\t\t\t\t\tif (now - dismissedUpdateToast > 24 * 60 * 60 * 1000) {\n\t\t\t\t\t\tcheckForVersionUpdates();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcheckForVersionUpdates();\n\t\t\t\t}\n\t\t\t}\n\t\t\tawait tick();\n\t\t}\n\n\t\tloaded = true;\n\t});\n\n\tconst checkForVersionUpdates = async () => {\n\t\tversion = await getVersionUpdates(localStorage.token).catch((error) => {\n\t\t\treturn {\n\t\t\t\tcurrent: WEBUI_VERSION,\n\t\t\t\tlatest: WEBUI_VERSION\n\t\t\t};\n\t\t});\n\t};\n</script>\n\n<SettingsModal bind:show={$showSettings} />\n<ChangelogModal bind:show={$showChangelog} />\n\n{#if version && compareVersion(version.latest, version.current) && ($settings?.showUpdateToast ?? true)}\n\t<div class=\" absolute bottom-8 right-8 z-50\" in:fade={{ duration: 100 }}>\n\t\t<UpdateInfoToast\n\t\t\t{version}\n\t\t\ton:close={() => {\n\t\t\t\tlocalStorage.setItem('dismissedUpdateToast', Date.now().toString());\n\t\t\t\tversion = null;\n\t\t\t}}\n\t\t/>\n\t</div>\n{/if}\n\n{#if $user}\n\t<div class=\"app relative\">\n\t\t<div\n\t\t\tclass=\" text-gray-700 dark:text-gray-100 bg-white dark:bg-gray-900 h-screen max-h-[100dvh] overflow-auto flex flex-row justify-end\"\n\t\t>\n\t\t\t{#if !['user', 'admin'].includes($user?.role)}\n\t\t\t\t<AccountPending />\n\t\t\t{:else if localDBChats.length > 0}\n\t\t\t\t<div class=\"fixed w-full h-full flex z-50\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"absolute w-full h-full backdrop-blur-md bg-white/20 dark:bg-gray-900/50 flex justify-center\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"m-auto pb-44 flex flex-col justify-center\">\n\t\t\t\t\t\t\t<div class=\"max-w-md\">\n\t\t\t\t\t\t\t\t<div class=\"text-center dark:text-white text-2xl font-medium z-50\">\n\t\t\t\t\t\t\t\t\tImportant Update<br /> Action Required for Chat Log Storage\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\" mt-4 text-center text-sm dark:text-gray-200 w-full\">\n\t\t\t\t\t\t\t\t\t{$i18n.t(\n\t\t\t\t\t\t\t\t\t\t\"Saving chat logs directly to your browser's storage is no longer supported. Please take a moment to download and delete your chat logs by clicking the button below. Don't worry, you can easily re-import your chat logs to the backend through\"\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t<span class=\"font-semibold dark:text-white\"\n\t\t\t\t\t\t\t\t\t\t>{$i18n.t('Settings')} > {$i18n.t('Chats')} > {$i18n.t('Import Chats')}</span\n\t\t\t\t\t\t\t\t\t>. {$i18n.t(\n\t\t\t\t\t\t\t\t\t\t'This ensures that your valuable conversations are securely saved to your backend database. Thank you!'\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\" mt-6 mx-auto relative group w-fit\">\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclass=\"relative z-20 flex px-5 py-2 rounded-full bg-white border border-gray-100 dark:border-none hover:bg-gray-100 transition font-medium text-sm\"\n\t\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\t\tlet blob = new Blob([JSON.stringify(localDBChats)], {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'application/json'\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tsaveAs(blob, `chat-export-${Date.now()}.json`);\n\n\t\t\t\t\t\t\t\t\t\t\tconst tx = DB.transaction('chats', 'readwrite');\n\t\t\t\t\t\t\t\t\t\t\tawait Promise.all([tx.store.clear(), tx.done]);\n\t\t\t\t\t\t\t\t\t\t\tawait deleteDB('Chats');\n\n\t\t\t\t\t\t\t\t\t\t\tlocalDBChats = [];\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\tDownload & Delete\n\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclass=\"text-xs text-center w-full mt-2 text-gray-400 underline\"\n\t\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\t\tlocalDBChats = [];\n\t\t\t\t\t\t\t\t\t\t}}>{$i18n.t('Close')}</button\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t<Sidebar />\n\n\t\t\t{#if loaded}\n\t\t\t\t<slot />\n\t\t\t{:else}\n\t\t\t\t<div class=\"w-full flex-1 h-full flex items-center justify-center\">\n\t\t\t\t\t<Spinner />\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n{/if}\n\n<style>\n\t.loading {\n\t\tdisplay: inline-block;\n\t\tclip-path: inset(0 1ch 0 0);\n\t\tanimation: l 1s steps(3) infinite;\n\t\tletter-spacing: -0.5px;\n\t}\n\n\t@keyframes l {\n\t\tto {\n\t\t\tclip-path: inset(0 -1ch 0 0);\n\t\t}\n\t}\n\n\tpre[class*='language-'] {\n\t\tposition: relative;\n\t\toverflow: auto;\n\n\t\t/* make space  */\n\t\tmargin: 5px 0;\n\t\tpadding: 1.75rem 0 1.75rem 1rem;\n\t\tborder-radius: 10px;\n\t}\n\n\tpre[class*='language-'] button {\n\t\tposition: absolute;\n\t\ttop: 5px;\n\t\tright: 5px;\n\n\t\tfont-size: 0.9rem;\n\t\tpadding: 0.15rem;\n\t\tbackground-color: #828282;\n\n\t\tborder: ridge 1px #7b7b7c;\n\t\tborder-radius: 5px;\n\t\ttext-shadow: #c4c4c4 0 0 2px;\n\t}\n\n\tpre[class*='language-'] button:hover {\n\t\tcursor: pointer;\n\t\tbackground-color: #bcbabb;\n\t}\n</style>\n"],"names":["res","page","chatId","chatTitle","id","open","item","uuidv4","model","getModels","_getModels"],"mappings":"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","x_google_ignoreList":[19]}